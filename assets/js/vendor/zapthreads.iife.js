var __defProp=Object.defineProperty,__defNormalProp=(e,t,n)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__publicField=(e,t,n)=>(__defNormalProp(e,"symbol"!=typeof t?t+"":t,n),n),__accessCheck=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},__privateGet=(e,t,n)=>(__accessCheck(e,t,"read from private field"),n?n.call(e):t.get(e)),__privateAdd=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},__privateSet=(e,t,n,r)=>(__accessCheck(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),ZapThreads=function(){var e,t,n,r;const o=Symbol("solid-proxy"),i=Symbol("solid-track"),s={equals:(e,t)=>e===t};let a=R;const l=1,u=2,c={owned:null,cleanups:null,context:null,owner:null},h={};var f=null;let d,p=null,g=null,m=null,y=null,b=0;function v(e,t){const n=g,r=f,o=0===e.length,i=void 0===t?r:t,s=o?c:{owned:null,cleanups:null,context:i?i.context:null,owner:i},a=o?e:()=>e((()=>B((()=>N(s)))));f=s,g=null;try{return P(a,!0)}finally{g=n,f=r}}function w(e,t){const n={value:e,observers:null,observerSlots:null,comparator:(t=t?Object.assign({},s,t):s).equals||void 0};return[D.bind(n),e=>("function"==typeof e&&(e=e(n.value)),I(n,e))]}function k(e,t,n){M(O(e,t,!0,l))}function x(e,t,n){M(O(e,t,!1,l))}function A(e,t,n){a=L;const r=O(e,t,!1,l),o=d&&function(e){let t;return f&&f.context&&void 0!==(t=f.context[e.id])?t:e.defaultValue}(d);o&&(r.suspense=o),n&&n.render||(r.user=!0),y?y.push(r):M(r)}function E(e,t,n){n=n?Object.assign({},s,n):s;const r=O(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,M(r),D.bind(r)}function C(e,t,n){let r,o,i;2===arguments.length&&"object"==typeof t||1===arguments.length?(r=!0,o=e,i=t||{}):(r=e,o=t,i=n||{});let s=null,a=h,l=!1,u="initialValue"in i,c="function"==typeof r&&E(r);const f=new Set,[p,m]=(i.storage||w)(i.initialValue),[y,b]=w(void 0),[v,x]=w(void 0,{equals:!1}),[A,C]=w(u?"ready":"unresolved");function _(e,t,n,r){return s===e&&(s=null,void 0!==r&&(u=!0),e!==a&&t!==a||!i.onHydrated||queueMicrotask((()=>i.onHydrated(r,{value:t}))),a=h,function(e,t){P((()=>{void 0===t&&m((()=>e)),C(void 0!==t?"errored":u?"ready":"unresolved"),b(t);for(const e of f.keys())e.decrement();f.clear()}),!1)}(t,n)),t}function S(){const e=d,t=p(),n=y();if(void 0!==n&&!s)throw n;return g&&!g.user&&e&&k((()=>{v(),s&&(e.resolved||f.has(e)||(e.increment(),f.add(e)))})),t}function F(e=!0){if(!1!==e&&l)return;l=!1;const t=c?c():r;if(null==t||!1===t)return void _(s,B(p));const n=a!==h?a:B((()=>o(t,{value:p(),refetching:e})));return(i=n)&&"object"==typeof i&&"then"in i?(s=n,"value"in n?("success"===n.status?_(s,n.value,void 0,t):_(s,void 0,q(n.value),t),n):(l=!0,queueMicrotask((()=>l=!1)),P((()=>{C(u?"refreshing":"pending"),x()}),!1),n.then((e=>_(n,e,void 0,t)),(e=>_(n,void 0,q(e),t))))):(_(s,n,void 0,t),n);var i}return Object.defineProperties(S,{state:{get:()=>A()},error:{get:()=>y()},loading:{get(){const e=A();return"pending"===e||"refreshing"===e}},latest:{get(){if(!u)return S();const e=y();if(e&&!s)throw e;return p()}}}),c?k((()=>F(!1))):F(!1),[S,{refetch:F,mutate:m}]}function _(e){return P(e,!1)}function B(e){if(null===g)return e();const t=g;g=null;try{return e()}finally{g=t}}function S(e,t,n){const r=Array.isArray(e);let o,i=n&&n.defer;return n=>{let s;if(r){s=Array(e.length);for(let t=0;t<e.length;t++)s[t]=e[t]()}else s=e();if(i)return i=!1,n;const a=B((()=>t(s,o,n)));return o=s,a}}function F(e){return null===f||(null===f.cleanups?f.cleanups=[e]:f.cleanups.push(e)),e}function z(){return g}function D(){if(this.sources&&this.state)if(this.state===l)M(this);else{const e=m;m=null,P((()=>$(this)),!1),m=e}if(g){const e=this.observers?this.observers.length:0;g.sources?(g.sources.push(this),g.sourceSlots.push(e)):(g.sources=[this],g.sourceSlots=[e]),this.observers?(this.observers.push(g),this.observerSlots.push(g.sources.length-1)):(this.observers=[g],this.observerSlots=[g.sources.length-1])}return this.value}function I(e,t,n){let r=e.value;return e.comparator&&e.comparator(r,t)||(e.value=t,e.observers&&e.observers.length&&P((()=>{for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t],r=p&&p.running;r&&p.disposed.has(n),(r?n.tState:n.state)||(n.pure?m.push(n):y.push(n),n.observers&&j(n)),r||(n.state=l)}if(m.length>1e6)throw m=[],new Error}),!1)),t}function M(e){if(!e.fn)return;N(e);const t=b;!function(e,t,n){let r;const o=f,i=g;g=f=e;try{r=e.fn(t)}catch(s){return e.pure&&(e.state=l,e.owned&&e.owned.forEach(N),e.owned=null),e.updatedAt=n+1,U(s)}finally{g=i,f=o}(!e.updatedAt||e.updatedAt<=n)&&(null!=e.updatedAt&&"observers"in e?I(e,r):e.value=r,e.updatedAt=n)}(e,e.value,t)}function O(e,t,n,r=l,o){const i={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:f,context:f?f.context:null,pure:n};return null===f||f!==c&&(f.owned?f.owned.push(i):f.owned=[i]),i}function T(e){if(0===e.state)return;if(e.state===u)return $(e);if(e.suspense&&B(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<b);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if((e=t[n]).state===l)M(e);else if(e.state===u){const n=m;m=null,P((()=>$(e,t[0])),!1),m=n}}function P(e,t){if(m)return e();let n=!1;t||(m=[]),y?n=!0:y=[],b++;try{const t=e();return function(e){m&&(R(m),m=null);if(e)return;const t=y;y=null,t.length&&P((()=>a(t)),!1)}(n),t}catch(r){n||(y=null),m=null,U(r)}}function R(e){for(let t=0;t<e.length;t++)T(e[t])}function L(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:T(r)}for(t=0;t<n;t++)T(e[t])}function $(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const e=r.state;e===l?r!==t&&(!r.updatedAt||r.updatedAt<b)&&T(r):e===u&&$(r,t)}}}function j(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=u,n.pure?m.push(n):y.push(n),n.observers&&j(n))}}function N(e){let t;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),n=e.sourceSlots.pop(),r=t.observers;if(r&&r.length){const e=r.pop(),o=t.observerSlots.pop();n<r.length&&(e.sourceSlots[o]=n,r[n]=e,t.observerSlots[n]=o)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)N(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function q(e){return e instanceof Error?e:new Error("string"==typeof e?e:"Unknown error",{cause:e})}function U(e,t=f){throw q(e)}const H=Symbol("fallback");function V(e){for(let t=0;t<e.length;t++)e[t]()}function W(e,t){return B((()=>e(t||{})))}function K(e){const t="fallback"in e&&{fallback:()=>e.fallback};return E(function(e,t,n={}){let r,o=[],s=[],a=[],l=[],u=0;return F((()=>V(a))),()=>{const c=e()||[],h=c.length;return c[i],B((()=>{if(0===h)return 0!==u&&(V(a),a=[],o=[],s=[],u=0,l=[]),n.fallback&&(o=[H],s[0]=v((e=>(a[0]=e,n.fallback()))),u=1),s;for(o[0]===H&&(a[0](),a=[],o=[],s=[],u=0),r=0;r<h;r++)r<o.length&&o[r]!==c[r]?l[r]((()=>c[r])):r>=o.length&&(s[r]=v(f));for(;r<o.length;r++)a[r]();return u=l.length=a.length=h,o=c.slice(0),s=s.slice(0,u)}));function f(e){a[r]=e;const[n,o]=w(c[r]);return l[r]=o,t(n,r)}}}((()=>e.each),e.children,t||void 0))}function Z(e){const t=e.keyed,n=E((()=>e.when),void 0,{equals:(e,n)=>t?e===n:!e==!n});return E((()=>{const r=n();if(r){const o=e.children;return"function"==typeof o&&o.length>0?B((()=>o(t?r:()=>{if(!B(n))throw`Stale read from <${"Show"}>.`;return e.when}))):o}return e.fallback}),void 0,void 0)}const G="_$DX_DELEGATE";function J(e,t,n){let r;const o=()=>{const t=document.createElement("template");return t.innerHTML=e,n?t.content.firstChild.firstChild:t.content.firstChild},i=t?()=>B((()=>document.importNode(r||(r=o()),!0))):()=>(r||(r=o())).cloneNode(!0);return i.cloneNode=i,i}function Y(e,t=window.document){const n=t[G]||(t[G]=new Set);for(let r=0,o=e.length;r<o;r++){const o=e[r];n.has(o)||(n.add(o),t.addEventListener(o,te))}}function Q(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function X(e,t,n){return B((()=>e(t,n)))}function ee(e,t,n,r){if(void 0===n||r||(r=[]),"function"!=typeof t)return ne(e,t,r,n);x((r=>ne(e,t(),r,n)),r)}function te(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get:()=>n||document});n;){const r=n[t];if(r&&!n.disabled){const o=n[`${t}Data`];if(void 0!==o?r.call(n,o,e):r.call(n,e),e.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function ne(e,t,n,r,o){for(;"function"==typeof n;)n=n();if(t===n)return n;const i=typeof t,s=void 0!==r;if(e=s&&n[0]&&n[0].parentNode||e,"string"===i||"number"===i){if("number"===i&&(t=t.toString())===n)return n;if(s){let o=n[0];o&&3===o.nodeType?o.data!==t&&(o.data=t):o=document.createTextNode(t),n=ie(e,n,r,o)}else n=""!==n&&"string"==typeof n?e.firstChild.data=t:e.textContent=t}else if(null==t||"boolean"===i)n=ie(e,n,r);else{if("function"===i)return x((()=>{let o=t();for(;"function"==typeof o;)o=o();n=ne(e,o,n,r)})),()=>n;if(Array.isArray(t)){const i=[],a=n&&Array.isArray(n);if(re(i,t,n,o))return x((()=>n=ne(e,i,n,r,!0))),()=>n;if(0===i.length){if(n=ie(e,n,r),s)return n}else a?0===n.length?oe(e,i,r):function(e,t,n){let r=n.length,o=t.length,i=r,s=0,a=0,l=t[o-1].nextSibling,u=null;for(;s<o||a<i;)if(t[s]!==n[a]){for(;t[o-1]===n[i-1];)o--,i--;if(o===s){const t=i<r?a?n[a-1].nextSibling:n[i-a]:l;for(;a<i;)e.insertBefore(n[a++],t)}else if(i===a)for(;s<o;)u&&u.has(t[s])||t[s].remove(),s++;else if(t[s]===n[i-1]&&n[a]===t[o-1]){const r=t[--o].nextSibling;e.insertBefore(n[a++],t[s++].nextSibling),e.insertBefore(n[--i],r),t[o]=n[i]}else{if(!u){u=new Map;let e=a;for(;e<i;)u.set(n[e],e++)}const r=u.get(t[s]);if(null!=r)if(a<r&&r<i){let l,c=s,h=1;for(;++c<o&&c<i&&null!=(l=u.get(t[c]))&&l===r+h;)h++;if(h>r-a){const o=t[s];for(;a<r;)e.insertBefore(n[a++],o)}else e.replaceChild(n[a++],t[s++])}else s++;else t[s++].remove()}}else s++,a++}(e,n,i):(n&&ie(e),oe(e,i));n=i}else if(t.nodeType){if(Array.isArray(n)){if(s)return n=ie(e,n,r,t);ie(e,n,null,t)}else null!=n&&""!==n&&e.firstChild?e.replaceChild(t,e.firstChild):e.appendChild(t);n=t}}return n}function re(e,t,n,r){let o=!1;for(let i=0,s=t.length;i<s;i++){let s,a=t[i],l=n&&n[e.length];if(null==a||!0===a||!1===a);else if("object"==(s=typeof a)&&a.nodeType)e.push(a);else if(Array.isArray(a))o=re(e,a,l)||o;else if("function"===s)if(r){for(;"function"==typeof a;)a=a();o=re(e,Array.isArray(a)?a:[a],Array.isArray(l)?l:[l])||o}else e.push(a),o=!0;else{const t=String(a);l&&3===l.nodeType&&l.data===t?e.push(l):e.push(document.createTextNode(t))}}return o}function oe(e,t,n=null){for(let r=0,o=t.length;r<o;r++)e.insertBefore(t[r],n)}function ie(e,t,n,r){if(void 0===n)return e.textContent="";const o=r||document.createTextNode("");if(t.length){let r=!1;for(let i=t.length-1;i>=0;i--){const s=t[i];if(o!==s){const t=s.parentNode===e;r||i?t&&s.remove():t?e.replaceChild(o,s):e.insertBefore(o,n)}else r=!0}}else e.insertBefore(o,n);return[o]}function se(e){return Object.keys(e).reduce(((t,n)=>{const r=e[n];var o;return t[n]=Object.assign({},r),ue(r.value)&&(o=r.value,"[object Function]"!==Object.prototype.toString.call(o))&&!Array.isArray(r.value)&&(t[n].value=Object.assign({},r.value)),Array.isArray(r.value)&&(t[n].value=r.value.slice(0)),t}),{})}function ae(e){if(e)try{return JSON.parse(e)}catch(t){return e}}function le(e,t,n,r){if(null==n||!1===n)return e.removeAttribute(t);let o=r?JSON.stringify(n):n;e.__updating[t]=!0,"true"===o&&(o=""),e.setAttribute(t,o),Promise.resolve().then((()=>delete e.__updating[t]))}function ue(e){return null!=e&&("object"==typeof e||"function"==typeof e)}let ce;function he(e,t){const n=Object.keys(t);return class extends e{static get observedAttributes(){return n.map((e=>t[e].attribute))}constructor(){super(),this.__initialized=!1,this.__released=!1,this.__releaseCallbacks=[],this.__propertyChangedCallbacks=[],this.__updating={},this.props={}}connectedCallback(){if(this.__initialized)return;this.__releaseCallbacks=[],this.__propertyChangedCallbacks=[],this.__updating={},this.props=function(e,t){const n=se(t);return Object.keys(t).forEach((t=>{const r=n[t],o=e.getAttribute(r.attribute),i=e[t];o&&(r.value=r.parse?ae(o):o),null!=i&&(r.value=Array.isArray(i)?i.slice(0):i),r.reflect&&le(e,r.attribute,r.value,!!r.parse),Object.defineProperty(e,t,{get:()=>r.value,set(e){const n=r.value;r.value=e,r.reflect&&le(this,r.attribute,r.value,!!r.parse);for(let r=0,o=this.__propertyChangedCallbacks.length;r<o;r++)this.__propertyChangedCallbacks[r](t,e,n)},enumerable:!0,configurable:!0})})),n}(this,t);const e=function(e){return Object.keys(e).reduce(((t,n)=>(t[n]=e[n].value,t)),{})}(this.props),n=this.Component,r=ce;try{ce=this,this.__initialized=!0,"function"==typeof(o=n)&&0===o.toString().indexOf("class")?new n(e,{element:this}):n(e,{element:this})}finally{ce=r}var o}async disconnectedCallback(){if(await Promise.resolve(),this.isConnected)return;this.__propertyChangedCallbacks.length=0;let e=null;for(;e=this.__releaseCallbacks.pop();)e(this);delete this.__initialized,this.__released=!0}attributeChangedCallback(e,n,r){if(this.__initialized&&!this.__updating[e]&&(e=this.lookupProp(e))in t){if(null==r&&!this[e])return;this[e]=t[e].parse?ae(r):r}}lookupProp(e){if(t)return n.find((n=>e===n||e===t[n].attribute))}get renderRoot(){return this.shadowRoot||this.attachShadow({mode:"open"})}addReleaseCallback(e){this.__releaseCallbacks.push(e)}addPropertyChangedCallback(e){this.__propertyChangedCallbacks.push(e)}}}function fe(e,t={},n={}){const{BaseElement:r=HTMLElement,extension:o}=n;return n=>{if(!e)throw new Error("tag is required to register a Component");let i=customElements.get(e);return i?(i.prototype.Component=n,i):(i=he(r,function(e){return e?Object.keys(e).reduce(((t,n)=>{const r=e[n];return t[n]=ue(r)&&"value"in r?r:{value:r},t[n].attribute||(t[n].attribute=n.replace(/\.?([A-Z]+)/g,((e,t)=>"-"+t.toLowerCase())).replace("_","-").replace(/^-/,"")),t[n].parse="parse"in t[n]?t[n].parse:"string"!=typeof t[n].value,t}),{}):{}}(t)),i.prototype.Component=n,i.prototype.registeredTag=e,customElements.define(e,i,o),i)}}function de(e){return(t,n)=>{const{element:r}=n;return v((o=>{const i=function(e){const t=Object.keys(e),n={};for(let r=0;r<t.length;r++){const[o,i]=w(e[t[r]]);Object.defineProperty(n,t[r],{get:o,set(e){i((()=>e))}})}return n}(t);r.addPropertyChangedCallback(((e,t)=>i[e]=t)),r.addReleaseCallback((()=>{r.renderRoot.textContent="",o()}));const s=e(i,n);return ee(r.renderRoot,s)}),function(e){if(e.assignedSlot&&e.assignedSlot._$owner)return e.assignedSlot._$owner;let t=e.parentNode;for(;t&&!t._$owner&&(!t.assignedSlot||!t.assignedSlot._$owner);)t=t.parentNode;return t&&t.assignedSlot?t.assignedSlot._$owner:e._$owner}(r))}}const pe=e=>e instanceof Uint8Array,ge=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),me=(e,t)=>e<<32-t|e>>>t;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");const ye=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function be(e){if(!pe(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=ye[e[n]];return t}function ve(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){const t=2*r,o=e.slice(t,t+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n}function we(e){if("string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),!pe(e))throw new Error("expected Uint8Array, got "+typeof e);return e}let ke=class{clone(){return this._cloneInto()}};function xe(e){const t=t=>e().update(we(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}var Ae={};!function(e){function t(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function n(...e){const t=(e,t)=>n=>e(t(n));return{encode:Array.from(e).reverse().reduce(((e,n)=>e?t(e,n.encode):n.encode),void 0),decode:e.reduce(((e,n)=>e?t(e,n.decode):n.decode),void 0)}}function r(e){return{encode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("alphabet.encode input should be an array of numbers");return n.map((n=>{if(t(n),n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]}))},decode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("alphabet.decode input should be array of strings");return t.map((t=>{if("string"!=typeof t)throw new Error(`alphabet.decode: not string element=${t}`);const n=e.indexOf(t);if(-1===n)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return n}))}}}function o(e=""){if("string"!=typeof e)throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("join.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`join.encode: non-string input=${e}`);return t.join(e)},decode:t=>{if("string"!=typeof t)throw new Error("join.decode input should be string");return t.split(e)}}}function i(e,n="="){if(t(e),"string"!=typeof n)throw new Error("padding chr should be string");return{encode(t){if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("padding.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`padding.encode: non-string input=${e}`);for(;t.length*e%8;)t.push(n);return t},decode(t){if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("padding.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`padding.decode: non-string input=${e}`);let r=t.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&t[r-1]===n;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return t.slice(0,r)}}}function s(e){if("function"!=typeof e)throw new Error("normalize fn should be function");return{encode:e=>e,decode:t=>e(t)}}function a(e,n,r){if(n<2)throw new Error(`convertRadix: wrong from=${n}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let o=0;const i=[],s=Array.from(e);for(s.forEach((e=>{if(t(e),e<0||e>=n)throw new Error(`Wrong integer: ${e}`)}));;){let e=0,t=!0;for(let i=o;i<s.length;i++){const a=s[i],l=n*e+a;if(!Number.isSafeInteger(l)||n*e/n!==e||l-a!=n*e)throw new Error("convertRadix: carry overflow");if(e=l%r,s[i]=Math.floor(l/r),!Number.isSafeInteger(s[i])||s[i]*r+e!==l)throw new Error("convertRadix: carry overflow");t&&(s[i]?t=!1:o=i)}if(i.push(e),t)break}for(let t=0;t<e.length-1&&0===e[t];t++)i.push(0);return i.reverse()}
/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */
Object.defineProperty(e,"__esModule",{value:!0}),e.bytes=e.stringToBytes=e.str=e.bytesToString=e.hex=e.utf8=e.bech32m=e.bech32=e.base58check=e.base58xmr=e.base58xrp=e.base58flickr=e.base58=e.base64url=e.base64=e.base32crockford=e.base32hex=e.base32=e.base16=e.utils=e.assertNumber=void 0,e.assertNumber=t;const l=(e,t)=>t?l(t,e%t):e,u=(e,t)=>e+(t-l(e,t));function c(e,n,r,o){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(n<=0||n>32)throw new Error(`convertRadix2: wrong from=${n}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(u(n,r)>32)throw new Error(`convertRadix2: carry overflow from=${n} to=${r} carryBits=${u(n,r)}`);let i=0,s=0;const a=2**r-1,l=[];for(const u of e){if(t(u),u>=2**n)throw new Error(`convertRadix2: invalid data word=${u} from=${n}`);if(i=i<<n|u,s+n>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${n}`);for(s+=n;s>=r;s-=r)l.push((i>>s-r&a)>>>0);i&=2**s-1}if(i=i<<r-s&a,!o&&s>=n)throw new Error("Excess padding");if(!o&&i)throw new Error(`Non-zero padding: ${i}`);return o&&s>0&&l.push(i>>>0),l}function h(e){return t(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return a(Array.from(t),256,e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(a(t,e,256))}}}function f(e,n=!1){if(t(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(u(8,e)>32||u(e,8)>32)throw new Error("radix2: carry overflow");return{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return c(Array.from(t),8,e,!n)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(c(t,e,8,n))}}}function d(e){if("function"!=typeof e)throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch(n){}}}function p(e,n){if(t(e),"function"!=typeof n)throw new Error("checksum fn should be function");return{encode(t){if(!(t instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const r=n(t).slice(0,e),o=new Uint8Array(t.length+e);return o.set(t),o.set(r,t.length),o},decode(t){if(!(t instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const r=t.slice(0,-e),o=n(r).slice(0,e),i=t.slice(-e);for(let n=0;n<e;n++)if(o[n]!==i[n])throw new Error("Invalid checksum");return r}}}e.utils={alphabet:r,chain:n,checksum:p,radix:h,radix2:f,join:o,padding:i},e.base16=n(f(4),r("0123456789ABCDEF"),o("")),e.base32=n(f(5),r("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),i(5),o("")),e.base32hex=n(f(5),r("0123456789ABCDEFGHIJKLMNOPQRSTUV"),i(5),o("")),e.base32crockford=n(f(5),r("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),o(""),s((e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")))),e.base64=n(f(6),r("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),i(6),o("")),e.base64url=n(f(6),r("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),i(6),o(""));const g=e=>n(h(58),r(e),o(""));e.base58=g("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),e.base58flickr=g("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),e.base58xrp=g("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const m=[0,2,3,5,6,7,9,10,11];e.base58xmr={encode(t){let n="";for(let r=0;r<t.length;r+=8){const o=t.subarray(r,r+8);n+=e.base58.encode(o).padStart(m[o.length],"1")}return n},decode(t){let n=[];for(let r=0;r<t.length;r+=11){const o=t.slice(r,r+11),i=m.indexOf(o.length),s=e.base58.decode(o);for(let e=0;e<s.length-i;e++)if(0!==s[e])throw new Error("base58xmr: wrong padding");n=n.concat(Array.from(s.slice(s.length-i)))}return Uint8Array.from(n)}};e.base58check=t=>n(p(4,(e=>t(t(e)))),e.base58);const y=n(r("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),o("")),b=[996825010,642813549,513874426,1027748829,705979059];function v(e){const t=e>>25;let n=(33554431&e)<<5;for(let r=0;r<b.length;r++)1==(t>>r&1)&&(n^=b[r]);return n}function w(e,t,n=1){const r=e.length;let o=1;for(let i=0;i<r;i++){const t=e.charCodeAt(i);if(t<33||t>126)throw new Error(`Invalid prefix (${e})`);o=v(o)^t>>5}o=v(o);for(let i=0;i<r;i++)o=v(o)^31&e.charCodeAt(i);for(let i of t)o=v(o)^i;for(let i=0;i<6;i++)o=v(o);return o^=n,y.encode(c([o%2**30],30,5,!1))}function k(e){const t="bech32"===e?1:734539939,n=f(5),r=n.decode,o=n.encode,i=d(r);function s(e,n=90){if("string"!=typeof e)throw new Error("bech32.decode input should be string, not "+typeof e);if(e.length<8||!1!==n&&e.length>n)throw new TypeError(`Wrong string length: ${e.length} (${e}). Expected (8..${n})`);const r=e.toLowerCase();if(e!==r&&e!==e.toUpperCase())throw new Error("String must be lowercase or uppercase");const o=(e=r).lastIndexOf("1");if(0===o||-1===o)throw new Error('Letter "1" must be present between prefix and data only');const i=e.slice(0,o),s=e.slice(o+1);if(s.length<6)throw new Error("Data must be at least 6 characters long");const a=y.decode(s).slice(0,-6),l=w(i,a,t);if(!s.endsWith(l))throw new Error(`Invalid checksum in ${e}: expected "${l}"`);return{prefix:i,words:a}}return{encode:function(e,n,r=90){if("string"!=typeof e)throw new Error("bech32.encode prefix should be string, not "+typeof e);if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof n);const o=e.length+7+n.length;if(!1!==r&&o>r)throw new TypeError(`Length ${o} exceeds limit ${r}`);return`${e=e.toLowerCase()}1${y.encode(n)}${w(e,n,t)}`},decode:s,decodeToBytes:function(e){const{prefix:t,words:n}=s(e,!1);return{prefix:t,words:n,bytes:r(n)}},decodeUnsafe:d(s),fromWords:r,fromWordsUnsafe:i,toWords:o}}e.bech32=k("bech32"),e.bech32m=k("bech32m"),e.utf8={encode:e=>(new TextDecoder).decode(e),decode:e=>(new TextEncoder).encode(e)},e.hex=n(f(4),r("0123456789abcdef"),o(""),s((e=>{if("string"!=typeof e||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})));const x={utf8:e.utf8,hex:e.hex,base16:e.base16,base32:e.base32,base64:e.base64,base64url:e.base64url,base58:e.base58,base58xmr:e.base58xmr},A=`Invalid encoding type. Available types: ${Object.keys(x).join(", ")}`;e.bytesToString=(e,t)=>{if("string"!=typeof e||!x.hasOwnProperty(e))throw new TypeError(A);if(!(t instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return x[e].encode(t)},e.str=e.bytesToString;e.stringToBytes=(e,t)=>{if(!x.hasOwnProperty(e))throw new TypeError(A);if("string"!=typeof t)throw new TypeError("stringToBytes() expects string");return x[e].decode(t)},e.bytes=e.stringToBytes}(Ae);var Ee=new TextDecoder("utf-8");new TextEncoder;var Ce=5e3;function _e(e){var t,n,r,o,i,s,a,l;let{prefix:u,words:c}=Ae.bech32.decode(e,Ce),h=new Uint8Array(Ae.bech32.fromWords(c));switch(u){case"nprofile":{let e=Be(h);if(!(null==(t=e[0])?void 0:t[0]))throw new Error("missing TLV 0 for nprofile");if(32!==e[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:be(e[0][0]),relays:e[1]?e[1].map((e=>Ee.decode(e))):[]}}}case"nevent":{let e=Be(h);if(!(null==(n=e[0])?void 0:n[0]))throw new Error("missing TLV 0 for nevent");if(32!==e[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(e[2]&&32!==e[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(e[3]&&4!==e[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:be(e[0][0]),relays:e[1]?e[1].map((e=>Ee.decode(e))):[],author:(null==(r=e[2])?void 0:r[0])?be(e[2][0]):void 0,kind:(null==(o=e[3])?void 0:o[0])?parseInt(be(e[3][0]),16):void 0}}}case"naddr":{let e=Be(h);if(!(null==(i=e[0])?void 0:i[0]))throw new Error("missing TLV 0 for naddr");if(!(null==(s=e[2])?void 0:s[0]))throw new Error("missing TLV 2 for naddr");if(32!==e[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!(null==(a=e[3])?void 0:a[0]))throw new Error("missing TLV 3 for naddr");if(4!==e[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:Ee.decode(e[0][0]),pubkey:be(e[2][0]),kind:parseInt(be(e[3][0]),16),relays:e[1]?e[1].map((e=>Ee.decode(e))):[]}}}case"nrelay":{let e=Be(h);if(!(null==(l=e[0])?void 0:l[0]))throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:Ee.decode(e[0][0])}}case"nsec":return{type:u,data:h};case"npub":case"note":return{type:u,data:be(h)};default:throw new Error(`unknown prefix ${u}`)}}function Be(e){let t={},n=e;for(;n.length>0;){let e=n[0],r=n[1],o=n.slice(2,2+r);if(n=n.slice(2+r),o.length<r)throw new Error(`not enough data to read on TLV ${e}`);t[e]=t[e]||[],t[e].push(o)}return t}function Se(e){return ze("npub",ve(e))}function Fe(e){return ze("note",ve(e))}function ze(e,t){return function(e,t){let n=Ae.bech32.toWords(t);return Ae.bech32.encode(e,n,Ce)}(e,t)}var De=1984,Ie=9735,Me=9802,Oe=1e4,Te=new TextDecoder("utf-8");new TextEncoder;var Pe=5e3;function Re(e){var t,n,r,o,i,s,a,l;let{prefix:u,words:c}=Ae.bech32.decode(e,Pe),h=new Uint8Array(Ae.bech32.fromWords(c));switch(u){case"nprofile":{let e=Le(h);if(!(null==(t=e[0])?void 0:t[0]))throw new Error("missing TLV 0 for nprofile");if(32!==e[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:be(e[0][0]),relays:e[1]?e[1].map((e=>Te.decode(e))):[]}}}case"nevent":{let e=Le(h);if(!(null==(n=e[0])?void 0:n[0]))throw new Error("missing TLV 0 for nevent");if(32!==e[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(e[2]&&32!==e[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(e[3]&&4!==e[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:be(e[0][0]),relays:e[1]?e[1].map((e=>Te.decode(e))):[],author:(null==(r=e[2])?void 0:r[0])?be(e[2][0]):void 0,kind:(null==(o=e[3])?void 0:o[0])?parseInt(be(e[3][0]),16):void 0}}}case"naddr":{let e=Le(h);if(!(null==(i=e[0])?void 0:i[0]))throw new Error("missing TLV 0 for naddr");if(!(null==(s=e[2])?void 0:s[0]))throw new Error("missing TLV 2 for naddr");if(32!==e[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!(null==(a=e[3])?void 0:a[0]))throw new Error("missing TLV 3 for naddr");if(4!==e[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:Te.decode(e[0][0]),pubkey:be(e[2][0]),kind:parseInt(be(e[3][0]),16),relays:e[1]?e[1].map((e=>Te.decode(e))):[]}}}case"nrelay":{let e=Le(h);if(!(null==(l=e[0])?void 0:l[0]))throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:Te.decode(e[0][0])}}case"nsec":return{type:u,data:h};case"npub":case"note":return{type:u,data:be(h)};default:throw new Error(`unknown prefix ${u}`)}}function Le(e){let t={},n=e;for(;n.length>0;){let e=n[0],r=n[1],o=n.slice(2,2+r);if(n=n.slice(2+r),o.length<r)throw new Error(`not enough data to read on TLV ${e}`);t[e]=t[e]||[],t[e].push(o)}return t}var $e,je=new RegExp(`nostr:(${/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/.source})`),Ne=()=>new RegExp(`\\b${je.source}\\b`,"g");function qe(e){return($e=$e||document.createElement("textarea")).innerHTML="&"+e+";",$e.value}var Ue=Object.prototype.hasOwnProperty;function He(e){return[].slice.call(arguments,1).forEach((function(t){if(t){if("object"!=typeof t)throw new TypeError(t+"must be object");Object.keys(t).forEach((function(n){e[n]=t[n]}))}})),e}var Ve=/\\([\\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function We(e){return e.indexOf("\\")<0?e:e.replace(Ve,"$1")}function Ke(e){return!(e>=55296&&e<=57343)&&(!(e>=64976&&e<=65007)&&(!!(65535&~e&&65534!=(65535&e))&&(!(e>=0&&e<=8)&&(11!==e&&(!(e>=14&&e<=31)&&(!(e>=127&&e<=159)&&!(e>1114111)))))))}function Ze(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}var Ge=/&([a-z#][a-z0-9]{1,31});/gi,Je=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;function Ye(e,t){var n=0,r=qe(t);return t!==r?r:35===t.charCodeAt(0)&&Je.test(t)&&Ke(n="x"===t[1].toLowerCase()?parseInt(t.slice(2),16):parseInt(t.slice(1),10))?Ze(n):e}function Qe(e){return e.indexOf("&")<0?e:e.replace(Ge,Ye)}var Xe=/[&<>"]/,et=/[&<>"]/g,tt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function nt(e){return tt[e]}function rt(e){return Xe.test(e)?e.replace(et,nt):e}var ot={};function it(e,t){return++t>=e.length-2?t:"paragraph_open"===e[t].type&&e[t].tight&&"inline"===e[t+1].type&&0===e[t+1].content.length&&"paragraph_close"===e[t+2].type&&e[t+2].tight?it(e,t+2):t}ot.blockquote_open=function(){return"<blockquote>\n"},ot.blockquote_close=function(e,t){return"</blockquote>"+st(e,t)},ot.code=function(e,t){return e[t].block?"<pre><code>"+rt(e[t].content)+"</code></pre>"+st(e,t):"<code>"+rt(e[t].content)+"</code>"},ot.fence=function(e,t,n,r,o){var i,s,a,l,u=e[t],c="",h=n.langPrefix;if(u.params){if(s=(i=u.params.split(/\s+/g)).join(" "),a=o.rules.fence_custom,l=i[0],a&&Ue.call(a,l))return o.rules.fence_custom[i[0]](e,t,n,r,o);c=' class="'+h+rt(Qe(We(s)))+'"'}return"<pre><code"+c+">"+(n.highlight&&n.highlight.apply(n.highlight,[u.content].concat(i))||rt(u.content))+"</code></pre>"+st(e,t)},ot.fence_custom={},ot.heading_open=function(e,t){return"<h"+e[t].hLevel+">"},ot.heading_close=function(e,t){return"</h"+e[t].hLevel+">\n"},ot.hr=function(e,t,n){return(n.xhtmlOut?"<hr />":"<hr>")+st(e,t)},ot.bullet_list_open=function(){return"<ul>\n"},ot.bullet_list_close=function(e,t){return"</ul>"+st(e,t)},ot.list_item_open=function(){return"<li>"},ot.list_item_close=function(){return"</li>\n"},ot.ordered_list_open=function(e,t){var n=e[t];return"<ol"+(n.order>1?' start="'+n.order+'"':"")+">\n"},ot.ordered_list_close=function(e,t){return"</ol>"+st(e,t)},ot.paragraph_open=function(e,t){return e[t].tight?"":"<p>"},ot.paragraph_close=function(e,t){var n=!(e[t].tight&&t&&"inline"===e[t-1].type&&!e[t-1].content);return(e[t].tight?"":"</p>")+(n?st(e,t):"")},ot.link_open=function(e,t,n){var r=e[t].title?' title="'+rt(Qe(e[t].title))+'"':"",o=n.linkTarget?' target="'+n.linkTarget+'"':"";return'<a href="'+rt(e[t].href)+'"'+r+o+">"},ot.link_close=function(){return"</a>"},ot.image=function(e,t,n){var r=' src="'+rt(e[t].src)+'"',o=e[t].title?' title="'+rt(Qe(e[t].title))+'"':"";return"<img"+r+(' alt="'+(e[t].alt?rt(Qe(We(e[t].alt))):"")+'"')+o+(n.xhtmlOut?" /":"")+">"},ot.table_open=function(){return"<table>\n"},ot.table_close=function(){return"</table>\n"},ot.thead_open=function(){return"<thead>\n"},ot.thead_close=function(){return"</thead>\n"},ot.tbody_open=function(){return"<tbody>\n"},ot.tbody_close=function(){return"</tbody>\n"},ot.tr_open=function(){return"<tr>"},ot.tr_close=function(){return"</tr>\n"},ot.th_open=function(e,t){var n=e[t];return"<th"+(n.align?' style="text-align:'+n.align+'"':"")+">"},ot.th_close=function(){return"</th>"},ot.td_open=function(e,t){var n=e[t];return"<td"+(n.align?' style="text-align:'+n.align+'"':"")+">"},ot.td_close=function(){return"</td>"},ot.strong_open=function(){return"<strong>"},ot.strong_close=function(){return"</strong>"},ot.em_open=function(){return"<em>"},ot.em_close=function(){return"</em>"},ot.del_open=function(){return"<del>"},ot.del_close=function(){return"</del>"},ot.ins_open=function(){return"<ins>"},ot.ins_close=function(){return"</ins>"},ot.mark_open=function(){return"<mark>"},ot.mark_close=function(){return"</mark>"},ot.sub=function(e,t){return"<sub>"+rt(e[t].content)+"</sub>"},ot.sup=function(e,t){return"<sup>"+rt(e[t].content)+"</sup>"},ot.hardbreak=function(e,t,n){return n.xhtmlOut?"<br />\n":"<br>\n"},ot.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?"<br />\n":"<br>\n":"\n"},ot.text=function(e,t){return rt(e[t].content)},ot.htmlblock=function(e,t){return e[t].content},ot.htmltag=function(e,t){return e[t].content},ot.abbr_open=function(e,t){return'<abbr title="'+rt(Qe(e[t].title))+'">'},ot.abbr_close=function(){return"</abbr>"},ot.footnote_ref=function(e,t){var n=Number(e[t].id+1).toString(),r="fnref"+n;return e[t].subId>0&&(r+=":"+e[t].subId),'<sup class="footnote-ref"><a href="#fn'+n+'" id="'+r+'">['+n+"]</a></sup>"},ot.footnote_block_open=function(e,t,n){return(n.xhtmlOut?'<hr class="footnotes-sep" />\n':'<hr class="footnotes-sep">\n')+'<section class="footnotes">\n<ol class="footnotes-list">\n'},ot.footnote_block_close=function(){return"</ol>\n</section>\n"},ot.footnote_open=function(e,t){return'<li id="fn'+Number(e[t].id+1).toString()+'"  class="footnote-item">'},ot.footnote_close=function(){return"</li>\n"},ot.footnote_anchor=function(e,t){var n="fnref"+Number(e[t].id+1).toString();return e[t].subId>0&&(n+=":"+e[t].subId),' <a href="#'+n+'" class="footnote-backref">↩</a>'},ot.dl_open=function(){return"<dl>\n"},ot.dt_open=function(){return"<dt>"},ot.dd_open=function(){return"<dd>"},ot.dl_close=function(){return"</dl>\n"},ot.dt_close=function(){return"</dt>\n"},ot.dd_close=function(){return"</dd>\n"};var st=ot.getBreak=function(e,t){return(t=it(e,t))<e.length&&"list_item_close"===e[t].type?"":"\n"};function at(){this.rules=He({},ot),this.getBreak=ot.getBreak}function lt(){this.__rules__=[],this.__cache__=null}function ut(e,t,n,r,o){this.src=e,this.env=r,this.options=n,this.parser=t,this.tokens=o,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache=[],this.isInLabel=!1,this.linkLevel=0,this.linkContent="",this.labelUnmatchedScopes=0}function ct(e,t){var n,r,o,i=-1,s=e.posMax,a=e.pos,l=e.isInLabel;if(e.isInLabel)return-1;if(e.labelUnmatchedScopes)return e.labelUnmatchedScopes--,-1;for(e.pos=t+1,e.isInLabel=!0,n=1;e.pos<s;){if(91===(o=e.src.charCodeAt(e.pos)))n++;else if(93===o&&0===--n){r=!0;break}e.parser.skipToken(e)}return r?(i=e.pos,e.labelUnmatchedScopes=0):e.labelUnmatchedScopes=n-1,e.pos=a,e.isInLabel=l,i}function ht(e,t,n,r){var o,i,s,a,l,u;if(42!==e.charCodeAt(0))return-1;if(91!==e.charCodeAt(1))return-1;if(-1===e.indexOf("]:"))return-1;if((i=ct(o=new ut(e,t,n,r,[]),1))<0||58!==e.charCodeAt(i+1))return-1;for(a=o.posMax,s=i+2;s<a&&10!==o.src.charCodeAt(s);s++);return l=e.slice(2,i),0===(u=e.slice(i+2,s).trim()).length?-1:(r.abbreviations||(r.abbreviations={}),void 0===r.abbreviations[":"+l]&&(r.abbreviations[":"+l]=u),s)}function ft(e){var t=Qe(e);try{t=decodeURI(t)}catch(n){}return encodeURI(t)}function dt(e,t){var n,r,o,i=t,s=e.posMax;if(60===e.src.charCodeAt(t)){for(t++;t<s;){if(10===(n=e.src.charCodeAt(t)))return!1;if(62===n)return o=ft(We(e.src.slice(i+1,t))),!!e.parser.validateLink(o)&&(e.pos=t+1,e.linkContent=o,!0);92===n&&t+1<s?t+=2:t++}return!1}for(r=0;t<s&&32!==(n=e.src.charCodeAt(t))&&!(n<32||127===n);)if(92===n&&t+1<s)t+=2;else{if(40===n&&++r>1)break;if(41===n&&--r<0)break;t++}return i!==t&&(o=We(e.src.slice(i,t)),!!e.parser.validateLink(o)&&(e.linkContent=o,e.pos=t,!0))}function pt(e,t){var n,r=t,o=e.posMax,i=e.src.charCodeAt(t);if(34!==i&&39!==i&&40!==i)return!1;for(t++,40===i&&(i=41);t<o;){if((n=e.src.charCodeAt(t))===i)return e.pos=t+1,e.linkContent=We(e.src.slice(r+1,t)),!0;92===n&&t+1<o?t+=2:t++}return!1}function gt(e){return e.trim().replace(/\s+/g," ").toUpperCase()}function mt(e,t,n,r){var o,i,s,a,l,u,c,h,f;if(91!==e.charCodeAt(0))return-1;if(-1===e.indexOf("]:"))return-1;if((i=ct(o=new ut(e,t,n,r,[]),0))<0||58!==e.charCodeAt(i+1))return-1;for(a=o.posMax,s=i+2;s<a&&(32===(l=o.src.charCodeAt(s))||10===l);s++);if(!dt(o,s))return-1;for(c=o.linkContent,u=s=o.pos,s+=1;s<a&&(32===(l=o.src.charCodeAt(s))||10===l);s++);for(s<a&&u!==s&&pt(o,s)?(h=o.linkContent,s=o.pos):(h="",s=u);s<a&&32===o.src.charCodeAt(s);)s++;return s<a&&10!==o.src.charCodeAt(s)?-1:(f=gt(e.slice(1,i)),void 0===r.references[f]&&(r.references[f]={title:h,href:c}),s)}at.prototype.renderInline=function(e,t,n){for(var r=this.rules,o=e.length,i=0,s="";o--;)s+=r[e[i].type](e,i++,t,n,this);return s},at.prototype.render=function(e,t,n){for(var r=this.rules,o=e.length,i=-1,s="";++i<o;)"inline"===e[i].type?s+=this.renderInline(e[i].children,t,n):s+=r[e[i].type](e,i,t,n,this);return s},lt.prototype.__find__=function(e){for(var t=this.__rules__.length,n=-1;t--;)if(this.__rules__[++n].name===e)return n;return-1},lt.prototype.__compile__=function(){var e=this,t=[""];e.__rules__.forEach((function(e){e.enabled&&e.alt.forEach((function(e){t.indexOf(e)<0&&t.push(e)}))})),e.__cache__={},t.forEach((function(t){e.__cache__[t]=[],e.__rules__.forEach((function(n){n.enabled&&(t&&n.alt.indexOf(t)<0||e.__cache__[t].push(n.fn))}))}))},lt.prototype.at=function(e,t,n){var r=this.__find__(e),o=n||{};if(-1===r)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=o.alt||[],this.__cache__=null},lt.prototype.before=function(e,t,n,r){var o=this.__find__(e),i=r||{};if(-1===o)throw new Error("Parser rule not found: "+e);this.__rules__.splice(o,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null},lt.prototype.after=function(e,t,n,r){var o=this.__find__(e),i=r||{};if(-1===o)throw new Error("Parser rule not found: "+e);this.__rules__.splice(o+1,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null},lt.prototype.push=function(e,t,n){var r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null},lt.prototype.enable=function(e,t){e=Array.isArray(e)?e:[e],t&&this.__rules__.forEach((function(e){e.enabled=!1})),e.forEach((function(e){var t=this.__find__(e);if(t<0)throw new Error("Rules manager: invalid rule name "+e);this.__rules__[t].enabled=!0}),this),this.__cache__=null},lt.prototype.disable=function(e){(e=Array.isArray(e)?e:[e]).forEach((function(e){var t=this.__find__(e);if(t<0)throw new Error("Rules manager: invalid rule name "+e);this.__rules__[t].enabled=!1}),this),this.__cache__=null},lt.prototype.getRules=function(e){return null===this.__cache__&&this.__compile__(),this.__cache__[e]||[]},ut.prototype.pushPending=function(){this.tokens.push({type:"text",content:this.pending,level:this.pendingLevel}),this.pending=""},ut.prototype.push=function(e){this.pending&&this.pushPending(),this.tokens.push(e),this.pendingLevel=this.level},ut.prototype.cacheSet=function(e,t){for(var n=this.cache.length;n<=e;n++)this.cache.push(0);this.cache[e]=t},ut.prototype.cacheGet=function(e){return e<this.cache.length?this.cache[e]:0};var yt=" \n()[]'\".,!?-";function bt(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}var vt=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,wt=/\((c|tm|r|p)\)/gi,kt={c:"©",r:"®",p:"§",tm:"™"};var xt=/['"]/,At=/['"]/g,Et=/[-\s()\[\]]/;function Ct(e,t){return!(t<0||t>=e.length)&&!Et.test(e[t])}function _t(e,t,n){return e.substr(0,t)+n+e.substr(t+1)}var Bt=[["block",function(e){e.inlineMode?e.tokens.push({type:"inline",content:e.src.replace(/\n/g," ").trim(),level:0,lines:[0,1],children:[]}):e.block.parse(e.src,e.options,e.env,e.tokens)}],["abbr",function(e){var t,n,r,o,i=e.tokens;if(!e.inlineMode)for(t=1,n=i.length-1;t<n;t++)if("paragraph_open"===i[t-1].type&&"inline"===i[t].type&&"paragraph_close"===i[t+1].type){for(r=i[t].content;r.length&&!((o=ht(r,e.inline,e.options,e.env))<0);)r=r.slice(o).trim();i[t].content=r,r.length||(i[t-1].tight=!0,i[t+1].tight=!0)}}],["references",function(e){var t,n,r,o,i=e.tokens;if(e.env.references=e.env.references||{},!e.inlineMode)for(t=1,n=i.length-1;t<n;t++)if("inline"===i[t].type&&"paragraph_open"===i[t-1].type&&"paragraph_close"===i[t+1].type){for(r=i[t].content;r.length&&!((o=mt(r,e.inline,e.options,e.env))<0);)r=r.slice(o).trim();i[t].content=r,r.length||(i[t-1].tight=!0,i[t+1].tight=!0)}}],["inline",function(e){var t,n,r,o=e.tokens;for(n=0,r=o.length;n<r;n++)"inline"===(t=o[n]).type&&e.inline.parse(t.content,e.options,e.env,t.children)}],["footnote_tail",function(e){var t,n,r,o,i,s,a,l,u,c=0,h=!1,f={};if(e.env.footnotes&&(e.tokens=e.tokens.filter((function(e){return"footnote_reference_open"===e.type?(h=!0,l=[],u=e.label,!1):"footnote_reference_close"===e.type?(h=!1,f[":"+u]=l,!1):(h&&l.push(e),!h)})),e.env.footnotes.list)){for(s=e.env.footnotes.list,e.tokens.push({type:"footnote_block_open",level:c++}),t=0,n=s.length;t<n;t++){for(e.tokens.push({type:"footnote_open",id:t,level:c++}),s[t].tokens?((a=[]).push({type:"paragraph_open",tight:!1,level:c++}),a.push({type:"inline",content:"",level:c,children:s[t].tokens}),a.push({type:"paragraph_close",tight:!1,level:--c})):s[t].label&&(a=f[":"+s[t].label]),e.tokens=e.tokens.concat(a),i="paragraph_close"===e.tokens[e.tokens.length-1].type?e.tokens.pop():null,o=s[t].count>0?s[t].count:1,r=0;r<o;r++)e.tokens.push({type:"footnote_anchor",id:t,subId:r,level:c});i&&e.tokens.push(i),e.tokens.push({type:"footnote_close",level:--c})}e.tokens.push({type:"footnote_block_close",level:--c})}}],["abbr2",function(e){var t,n,r,o,i,s,a,l,u,c,h,f,d=e.tokens;if(e.env.abbreviations)for(e.env.abbrRegExp||(f="(^|["+yt.split("").map(bt).join("")+"])("+Object.keys(e.env.abbreviations).map((function(e){return e.substr(1)})).sort((function(e,t){return t.length-e.length})).map(bt).join("|")+")($|["+yt.split("").map(bt).join("")+"])",e.env.abbrRegExp=new RegExp(f,"g")),c=e.env.abbrRegExp,n=0,r=d.length;n<r;n++)if("inline"===d[n].type)for(t=(o=d[n].children).length-1;t>=0;t--)if("text"===(i=o[t]).type){for(l=0,s=i.content,c.lastIndex=0,u=i.level,a=[];h=c.exec(s);)c.lastIndex>l&&a.push({type:"text",content:s.slice(l,h.index+h[1].length),level:u}),a.push({type:"abbr_open",title:e.env.abbreviations[":"+h[2]],level:u++}),a.push({type:"text",content:h[2],level:u}),a.push({type:"abbr_close",level:--u}),l=c.lastIndex-h[3].length;a.length&&(l<s.length&&a.push({type:"text",content:s.slice(l),level:u}),d[n].children=o=[].concat(o.slice(0,t),a,o.slice(t+1)))}}],["replacements",function(e){var t,n,r,o,i,s;if(e.options.typographer)for(i=e.tokens.length-1;i>=0;i--)if("inline"===e.tokens[i].type)for(t=(o=e.tokens[i].children).length-1;t>=0;t--)"text"===(n=o[t]).type&&(r=n.content,r=(s=r).indexOf("(")<0?s:s.replace(wt,(function(e,t){return kt[t.toLowerCase()]})),vt.test(r)&&(r=r.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/gm,"$1—$2").replace(/(^|\s)--(\s|$)/gm,"$1–$2").replace(/(^|[^-\s])--([^-\s]|$)/gm,"$1–$2")),n.content=r)}],["smartquotes",function(e){var t,n,r,o,i,s,a,l,u,c,h,f,d,p,g,m,y;if(e.options.typographer)for(y=[],g=e.tokens.length-1;g>=0;g--)if("inline"===e.tokens[g].type)for(m=e.tokens[g].children,y.length=0,t=0;t<m.length;t++)if("text"===(n=m[t]).type&&!xt.test(n.text)){for(a=m[t].level,d=y.length-1;d>=0&&!(y[d].level<=a);d--);y.length=d+1,i=0,s=(r=n.content).length;e:for(;i<s&&(At.lastIndex=i,o=At.exec(r));)if(l=!Ct(r,o.index-1),i=o.index+1,p="'"===o[0],(u=!Ct(r,i))||l){if(h=!u,f=!l)for(d=y.length-1;d>=0&&(c=y[d],!(y[d].level<a));d--)if(c.single===p&&y[d].level===a){c=y[d],p?(m[c.token].content=_t(m[c.token].content,c.pos,e.options.quotes[2]),n.content=_t(n.content,o.index,e.options.quotes[3])):(m[c.token].content=_t(m[c.token].content,c.pos,e.options.quotes[0]),n.content=_t(n.content,o.index,e.options.quotes[1])),y.length=d;continue e}h?y.push({token:t,pos:o.index,single:p,level:a}):f&&p&&(n.content=_t(n.content,o.index,"’"))}else p&&(n.content=_t(n.content,o.index,"’"))}}]];function St(){this.options={},this.ruler=new lt;for(var e=0;e<Bt.length;e++)this.ruler.push(Bt[e][0],Bt[e][1])}function Ft(e,t,n,r,o){var i,s,a,l,u,c,h;for(this.src=e,this.parser=t,this.options=n,this.env=r,this.tokens=o,this.bMarks=[],this.eMarks=[],this.tShift=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.parentType="root",this.ddIndent=-1,this.level=0,this.result="",c=0,h=!1,a=l=c=0,u=(s=this.src).length;l<u;l++){if(i=s.charCodeAt(l),!h){if(32===i){c++;continue}h=!0}10!==i&&l!==u-1||(10!==i&&l++,this.bMarks.push(a),this.eMarks.push(l),this.tShift.push(c),h=!1,c=0,a=l+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.lineMax=this.bMarks.length-1}function zt(e,t){var n,r,o;return(r=e.bMarks[t]+e.tShift[t])>=(o=e.eMarks[t])||42!==(n=e.src.charCodeAt(r++))&&45!==n&&43!==n||r<o&&32!==e.src.charCodeAt(r)?-1:r}function Dt(e,t){var n,r=e.bMarks[t]+e.tShift[t],o=e.eMarks[t];if(r+1>=o)return-1;if((n=e.src.charCodeAt(r++))<48||n>57)return-1;for(;;){if(r>=o)return-1;if(!((n=e.src.charCodeAt(r++))>=48&&n<=57)){if(41===n||46===n)break;return-1}}return r<o&&32!==e.src.charCodeAt(r)?-1:r}St.prototype.process=function(e){var t,n,r;for(t=0,n=(r=this.ruler.getRules("")).length;t<n;t++)r[t](e)},Ft.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]},Ft.prototype.skipEmptyLines=function(e){for(var t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e},Ft.prototype.skipSpaces=function(e){for(var t=this.src.length;e<t&&32===this.src.charCodeAt(e);e++);return e},Ft.prototype.skipChars=function(e,t){for(var n=this.src.length;e<n&&this.src.charCodeAt(e)===t;e++);return e},Ft.prototype.skipCharsBack=function(e,t,n){if(e<=n)return e;for(;e>n;)if(t!==this.src.charCodeAt(--e))return e+1;return e},Ft.prototype.getLines=function(e,t,n,r){var o,i,s,a,l,u=e;if(e>=t)return"";if(u+1===t)return i=this.bMarks[u]+Math.min(this.tShift[u],n),s=r?this.eMarks[u]+1:this.eMarks[u],this.src.slice(i,s);for(a=new Array(t-e),o=0;u<t;u++,o++)(l=this.tShift[u])>n&&(l=n),l<0&&(l=0),i=this.bMarks[u]+l,s=u+1<t||r?this.eMarks[u]+1:this.eMarks[u],a[o]=this.src.slice(i,s);return a.join("")};var It={};["article","aside","button","blockquote","body","canvas","caption","col","colgroup","dd","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","li","map","object","ol","output","p","pre","progress","script","section","style","table","tbody","td","textarea","tfoot","th","tr","thead","ul","video"].forEach((function(e){It[e]=!0}));var Mt=/^<([a-zA-Z]{1,15})[\s\/>]/,Ot=/^<\/([a-zA-Z]{1,15})[\s>]/;function Tt(e,t){var n=e.bMarks[t]+e.blkIndent,r=e.eMarks[t];return e.src.substr(n,r-n)}function Pt(e,t){var n,r,o=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];return o>=i||126!==(r=e.src.charCodeAt(o++))&&58!==r||o===(n=e.skipSpaces(o))||n>=i?-1:n}var Rt=[["code",function(e,t,n){var r,o;if(e.tShift[t]-e.blkIndent<4)return!1;for(o=r=t+1;r<n;)if(e.isEmpty(r))r++;else{if(!(e.tShift[r]-e.blkIndent>=4))break;o=++r}return e.line=r,e.tokens.push({type:"code",content:e.getLines(t,o,4+e.blkIndent,!0),block:!0,lines:[t,e.line],level:e.level}),!0}],["fences",function(e,t,n,r){var o,i,s,a,l,u=!1,c=e.bMarks[t]+e.tShift[t],h=e.eMarks[t];if(c+3>h)return!1;if(126!==(o=e.src.charCodeAt(c))&&96!==o)return!1;if(l=c,(i=(c=e.skipChars(c,o))-l)<3)return!1;if((s=e.src.slice(c,h).trim()).indexOf("`")>=0)return!1;if(r)return!0;for(a=t;!(++a>=n)&&!((c=l=e.bMarks[a]+e.tShift[a])<(h=e.eMarks[a])&&e.tShift[a]<e.blkIndent);)if(e.src.charCodeAt(c)===o&&!(e.tShift[a]-e.blkIndent>=4||(c=e.skipChars(c,o))-l<i||(c=e.skipSpaces(c))<h)){u=!0;break}return i=e.tShift[t],e.line=a+(u?1:0),e.tokens.push({type:"fence",params:s,content:e.getLines(t+1,a,i,!0),lines:[t,e.line],level:e.level}),!0},["paragraph","blockquote","list"]],["blockquote",function(e,t,n,r){var o,i,s,a,l,u,c,h,f,d,p,g=e.bMarks[t]+e.tShift[t],m=e.eMarks[t];if(g>m)return!1;if(62!==e.src.charCodeAt(g++))return!1;if(e.level>=e.options.maxNesting)return!1;if(r)return!0;for(32===e.src.charCodeAt(g)&&g++,l=e.blkIndent,e.blkIndent=0,a=[e.bMarks[t]],e.bMarks[t]=g,i=(g=g<m?e.skipSpaces(g):g)>=m,s=[e.tShift[t]],e.tShift[t]=g-e.bMarks[t],h=e.parser.ruler.getRules("blockquote"),o=t+1;o<n&&!((g=e.bMarks[o]+e.tShift[o])>=(m=e.eMarks[o]));o++)if(62!==e.src.charCodeAt(g++)){if(i)break;for(p=!1,f=0,d=h.length;f<d;f++)if(h[f](e,o,n,!0)){p=!0;break}if(p)break;a.push(e.bMarks[o]),s.push(e.tShift[o]),e.tShift[o]=-1337}else 32===e.src.charCodeAt(g)&&g++,a.push(e.bMarks[o]),e.bMarks[o]=g,i=(g=g<m?e.skipSpaces(g):g)>=m,s.push(e.tShift[o]),e.tShift[o]=g-e.bMarks[o];for(u=e.parentType,e.parentType="blockquote",e.tokens.push({type:"blockquote_open",lines:c=[t,0],level:e.level++}),e.parser.tokenize(e,t,o),e.tokens.push({type:"blockquote_close",level:--e.level}),e.parentType=u,c[1]=e.line,f=0;f<s.length;f++)e.bMarks[f+t]=a[f],e.tShift[f+t]=s[f];return e.blkIndent=l,!0},["paragraph","blockquote","list"]],["hr",function(e,t,n,r){var o,i,s,a=e.bMarks[t],l=e.eMarks[t];if((a+=e.tShift[t])>l)return!1;if(42!==(o=e.src.charCodeAt(a++))&&45!==o&&95!==o)return!1;for(i=1;a<l;){if((s=e.src.charCodeAt(a++))!==o&&32!==s)return!1;s===o&&i++}return!(i<3)&&(r||(e.line=t+1,e.tokens.push({type:"hr",lines:[t,e.line],level:e.level})),!0)},["paragraph","blockquote","list"]],["list",function(e,t,n,r){var o,i,s,a,l,u,c,h,f,d,p,g,m,y,b,v,w,k,x,A,E,C=!0;if((h=Dt(e,t))>=0)g=!0;else{if(!((h=zt(e,t))>=0))return!1;g=!1}if(e.level>=e.options.maxNesting)return!1;if(p=e.src.charCodeAt(h-1),r)return!0;for(y=e.tokens.length,g?(c=e.bMarks[t]+e.tShift[t],d=Number(e.src.substr(c,h-c-1)),e.tokens.push({type:"ordered_list_open",order:d,lines:v=[t,0],level:e.level++})):e.tokens.push({type:"bullet_list_open",lines:v=[t,0],level:e.level++}),o=t,b=!1,k=e.parser.ruler.getRules("list");!(!(o<n)||((f=(m=e.skipSpaces(h))>=e.eMarks[o]?1:m-h)>4&&(f=1),f<1&&(f=1),i=h-e.bMarks[o]+f,e.tokens.push({type:"list_item_open",lines:w=[t,0],level:e.level++}),a=e.blkIndent,l=e.tight,s=e.tShift[t],u=e.parentType,e.tShift[t]=m-e.bMarks[t],e.blkIndent=i,e.tight=!0,e.parentType="list",e.parser.tokenize(e,t,n,!0),e.tight&&!b||(C=!1),b=e.line-t>1&&e.isEmpty(e.line-1),e.blkIndent=a,e.tShift[t]=s,e.tight=l,e.parentType=u,e.tokens.push({type:"list_item_close",level:--e.level}),o=t=e.line,w[1]=o,m=e.bMarks[t],o>=n)||e.isEmpty(o)||e.tShift[o]<e.blkIndent);){for(E=!1,x=0,A=k.length;x<A;x++)if(k[x](e,o,n,!0)){E=!0;break}if(E)break;if(g){if((h=Dt(e,o))<0)break}else if((h=zt(e,o))<0)break;if(p!==e.src.charCodeAt(h-1))break}return e.tokens.push({type:g?"ordered_list_close":"bullet_list_close",level:--e.level}),v[1]=o,e.line=o,C&&function(e,t){var n,r,o=e.level+2;for(n=t+2,r=e.tokens.length-2;n<r;n++)e.tokens[n].level===o&&"paragraph_open"===e.tokens[n].type&&(e.tokens[n+2].tight=!0,e.tokens[n].tight=!0,n+=2)}(e,y),!0},["paragraph","blockquote"]],["footnote",function(e,t,n,r){var o,i,s,a,l,u=e.bMarks[t]+e.tShift[t],c=e.eMarks[t];if(u+4>c)return!1;if(91!==e.src.charCodeAt(u))return!1;if(94!==e.src.charCodeAt(u+1))return!1;if(e.level>=e.options.maxNesting)return!1;for(a=u+2;a<c;a++){if(32===e.src.charCodeAt(a))return!1;if(93===e.src.charCodeAt(a))break}return a!==u+2&&(!(a+1>=c||58!==e.src.charCodeAt(++a))&&(r||(a++,e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.refs||(e.env.footnotes.refs={}),l=e.src.slice(u+2,a-2),e.env.footnotes.refs[":"+l]=-1,e.tokens.push({type:"footnote_reference_open",label:l,level:e.level++}),o=e.bMarks[t],i=e.tShift[t],s=e.parentType,e.tShift[t]=e.skipSpaces(a)-a,e.bMarks[t]=a,e.blkIndent+=4,e.parentType="footnote",e.tShift[t]<e.blkIndent&&(e.tShift[t]+=e.blkIndent,e.bMarks[t]-=e.blkIndent),e.parser.tokenize(e,t,n,!0),e.parentType=s,e.blkIndent-=4,e.tShift[t]=i,e.bMarks[t]=o,e.tokens.push({type:"footnote_reference_close",level:--e.level})),!0))},["paragraph"]],["heading",function(e,t,n,r){var o,i,s,a=e.bMarks[t]+e.tShift[t],l=e.eMarks[t];if(a>=l)return!1;if(35!==(o=e.src.charCodeAt(a))||a>=l)return!1;for(i=1,o=e.src.charCodeAt(++a);35===o&&a<l&&i<=6;)i++,o=e.src.charCodeAt(++a);return!(i>6||a<l&&32!==o)&&(r||(l=e.skipCharsBack(l,32,a),(s=e.skipCharsBack(l,35,a))>a&&32===e.src.charCodeAt(s-1)&&(l=s),e.line=t+1,e.tokens.push({type:"heading_open",hLevel:i,lines:[t,e.line],level:e.level}),a<l&&e.tokens.push({type:"inline",content:e.src.slice(a,l).trim(),level:e.level+1,lines:[t,e.line],children:[]}),e.tokens.push({type:"heading_close",hLevel:i,level:e.level})),!0)},["paragraph","blockquote"]],["lheading",function(e,t,n){var r,o,i,s=t+1;return!(s>=n)&&(!(e.tShift[s]<e.blkIndent)&&(!(e.tShift[s]-e.blkIndent>3)&&(!((o=e.bMarks[s]+e.tShift[s])>=(i=e.eMarks[s]))&&((45===(r=e.src.charCodeAt(o))||61===r)&&(o=e.skipChars(o,r),!((o=e.skipSpaces(o))<i)&&(o=e.bMarks[t]+e.tShift[t],e.line=s+1,e.tokens.push({type:"heading_open",hLevel:61===r?1:2,lines:[t,e.line],level:e.level}),e.tokens.push({type:"inline",content:e.src.slice(o,e.eMarks[t]).trim(),level:e.level+1,lines:[t,e.line-1],children:[]}),e.tokens.push({type:"heading_close",hLevel:61===r?1:2,level:e.level}),!0))))))}],["htmlblock",function(e,t,n,r){var o,i,s,a=e.bMarks[t],l=e.eMarks[t],u=e.tShift[t];if(a+=u,!e.options.html)return!1;if(u>3||a+2>=l)return!1;if(60!==e.src.charCodeAt(a))return!1;if(33===(o=e.src.charCodeAt(a+1))||63===o){if(r)return!0}else{if(47!==o&&!function(e){var t=32|e;return t>=97&&t<=122}(o))return!1;if(47===o){if(!(i=e.src.slice(a,l).match(Ot)))return!1}else if(!(i=e.src.slice(a,l).match(Mt)))return!1;if(!0!==It[i[1].toLowerCase()])return!1;if(r)return!0}for(s=t+1;s<e.lineMax&&!e.isEmpty(s);)s++;return e.line=s,e.tokens.push({type:"htmlblock",level:e.level,lines:[t,e.line],content:e.getLines(t,s,0,!0)}),!0},["paragraph","blockquote"]],["table",function(e,t,n,r){var o,i,s,a,l,u,c,h,f,d,p;if(t+2>n)return!1;if(l=t+1,e.tShift[l]<e.blkIndent)return!1;if((s=e.bMarks[l]+e.tShift[l])>=e.eMarks[l])return!1;if(124!==(o=e.src.charCodeAt(s))&&45!==o&&58!==o)return!1;if(i=Tt(e,t+1),!/^[-:| ]+$/.test(i))return!1;if((u=i.split("|"))<=2)return!1;for(h=[],a=0;a<u.length;a++){if(!(f=u[a].trim())){if(0===a||a===u.length-1)continue;return!1}if(!/^:?-+:?$/.test(f))return!1;58===f.charCodeAt(f.length-1)?h.push(58===f.charCodeAt(0)?"center":"right"):58===f.charCodeAt(0)?h.push("left"):h.push("")}if(-1===(i=Tt(e,t).trim()).indexOf("|"))return!1;if(u=i.replace(/^\||\|$/g,"").split("|"),h.length!==u.length)return!1;if(r)return!0;for(e.tokens.push({type:"table_open",lines:d=[t,0],level:e.level++}),e.tokens.push({type:"thead_open",lines:[t,t+1],level:e.level++}),e.tokens.push({type:"tr_open",lines:[t,t+1],level:e.level++}),a=0;a<u.length;a++)e.tokens.push({type:"th_open",align:h[a],lines:[t,t+1],level:e.level++}),e.tokens.push({type:"inline",content:u[a].trim(),lines:[t,t+1],level:e.level,children:[]}),e.tokens.push({type:"th_close",level:--e.level});for(e.tokens.push({type:"tr_close",level:--e.level}),e.tokens.push({type:"thead_close",level:--e.level}),e.tokens.push({type:"tbody_open",lines:p=[t+2,0],level:e.level++}),l=t+2;l<n&&!(e.tShift[l]<e.blkIndent)&&-1!==(i=Tt(e,l).trim()).indexOf("|");l++){for(u=i.replace(/^\||\|$/g,"").split("|"),e.tokens.push({type:"tr_open",level:e.level++}),a=0;a<u.length;a++)e.tokens.push({type:"td_open",align:h[a],level:e.level++}),c=u[a].substring(124===u[a].charCodeAt(0)?1:0,124===u[a].charCodeAt(u[a].length-1)?u[a].length-1:u[a].length).trim(),e.tokens.push({type:"inline",content:c,level:e.level,children:[]}),e.tokens.push({type:"td_close",level:--e.level});e.tokens.push({type:"tr_close",level:--e.level})}return e.tokens.push({type:"tbody_close",level:--e.level}),e.tokens.push({type:"table_close",level:--e.level}),d[1]=p[1]=l,e.line=l,!0},["paragraph"]],["deflist",function(e,t,n,r){var o,i,s,a,l,u,c,h,f,d,p,g,m,y;if(r)return!(e.ddIndent<0)&&Pt(e,t)>=0;if(c=t+1,e.isEmpty(c)&&++c>n)return!1;if(e.tShift[c]<e.blkIndent)return!1;if((o=Pt(e,c))<0)return!1;if(e.level>=e.options.maxNesting)return!1;u=e.tokens.length,e.tokens.push({type:"dl_open",lines:l=[t,0],level:e.level++}),s=t,i=c;e:for(;;){for(y=!0,m=!1,e.tokens.push({type:"dt_open",lines:[s,s],level:e.level++}),e.tokens.push({type:"inline",content:e.getLines(s,s+1,e.blkIndent,!1).trim(),level:e.level+1,lines:[s,s],children:[]}),e.tokens.push({type:"dt_close",level:--e.level});;){if(e.tokens.push({type:"dd_open",lines:a=[c,0],level:e.level++}),g=e.tight,f=e.ddIndent,h=e.blkIndent,p=e.tShift[i],d=e.parentType,e.blkIndent=e.ddIndent=e.tShift[i]+2,e.tShift[i]=o-e.bMarks[i],e.tight=!0,e.parentType="deflist",e.parser.tokenize(e,i,n,!0),e.tight&&!m||(y=!1),m=e.line-i>1&&e.isEmpty(e.line-1),e.tShift[i]=p,e.tight=g,e.parentType=d,e.blkIndent=h,e.ddIndent=f,e.tokens.push({type:"dd_close",level:--e.level}),a[1]=c=e.line,c>=n)break e;if(e.tShift[c]<e.blkIndent)break e;if((o=Pt(e,c))<0)break;i=c}if(c>=n)break;if(s=c,e.isEmpty(s))break;if(e.tShift[s]<e.blkIndent)break;if((i=s+1)>=n)break;if(e.isEmpty(i)&&i++,i>=n)break;if(e.tShift[i]<e.blkIndent)break;if((o=Pt(e,i))<0)break}return e.tokens.push({type:"dl_close",level:--e.level}),l[1]=c,e.line=c,y&&function(e,t){var n,r,o=e.level+2;for(n=t+2,r=e.tokens.length-2;n<r;n++)e.tokens[n].level===o&&"paragraph_open"===e.tokens[n].type&&(e.tokens[n+2].tight=!0,e.tokens[n].tight=!0,n+=2)}(e,u),!0},["paragraph"]],["paragraph",function(e,t){var n,r,o,i,s,a,l=t+1;if(l<(n=e.lineMax)&&!e.isEmpty(l))for(a=e.parser.ruler.getRules("paragraph");l<n&&!e.isEmpty(l);l++)if(!(e.tShift[l]-e.blkIndent>3)){for(o=!1,i=0,s=a.length;i<s;i++)if(a[i](e,l,n,!0)){o=!0;break}if(o)break}return r=e.getLines(t,l,e.blkIndent,!1).trim(),e.line=l,r.length&&(e.tokens.push({type:"paragraph_open",tight:!1,lines:[t,e.line],level:e.level}),e.tokens.push({type:"inline",content:r,level:e.level+1,lines:[t,e.line],children:[]}),e.tokens.push({type:"paragraph_close",tight:!1,level:e.level})),!0}]];function Lt(){this.ruler=new lt;for(var e=0;e<Rt.length;e++)this.ruler.push(Rt[e][0],Rt[e][1],{alt:(Rt[e][2]||[]).slice()})}Lt.prototype.tokenize=function(e,t,n){for(var r,o=this.ruler.getRules(""),i=o.length,s=t,a=!1;s<n&&(e.line=s=e.skipEmptyLines(s),!(s>=n))&&!(e.tShift[s]<e.blkIndent);){for(r=0;r<i&&!o[r](e,s,n,!1);r++);if(e.tight=!a,e.isEmpty(e.line-1)&&(a=!0),(s=e.line)<n&&e.isEmpty(s)){if(a=!0,++s<n&&"list"===e.parentType&&e.isEmpty(s))break;e.line=s}}};var $t=/[\n\t]/g,jt=/\r[\n\u0085]|[\u2424\u2028\u0085]/g,Nt=/\u00a0/g;function qt(e){switch(e){case 10:case 92:case 96:case 42:case 95:case 94:case 91:case 93:case 33:case 38:case 60:case 62:case 123:case 125:case 36:case 37:case 64:case 126:case 43:case 61:case 58:return!0;default:return!1}}Lt.prototype.parse=function(e,t,n,r){var o,i=0,s=0;if(!e)return[];(e=(e=e.replace(Nt," ")).replace(jt,"\n")).indexOf("\t")>=0&&(e=e.replace($t,(function(t,n){var r;return 10===e.charCodeAt(n)?(i=n+1,s=0,t):(r="    ".slice((n-i-s)%4),s=n-i+1,r)}))),o=new Ft(e,this,t,n,r),this.tokenize(o,o.line,o.lineMax)};for(var Ut=[],Ht=0;Ht<256;Ht++)Ut.push(0);function Vt(e){return e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122}function Wt(e,t){var n,r,o,i=t,s=!0,a=!0,l=e.posMax,u=e.src.charCodeAt(t);for(n=t>0?e.src.charCodeAt(t-1):-1;i<l&&e.src.charCodeAt(i)===u;)i++;return i>=l&&(s=!1),(o=i-t)>=4?s=a=!1:(32!==(r=i<l?e.src.charCodeAt(i):-1)&&10!==r||(s=!1),32!==n&&10!==n||(a=!1),95===u&&(Vt(n)&&(s=!1),Vt(r)&&(a=!1))),{can_open:s,can_close:a,delims:o}}"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach((function(e){Ut[e.charCodeAt(0)]=1}));var Kt=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;var Zt=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;var Gt=["coap","doi","javascript","aaa","aaas","about","acap","cap","cid","crid","data","dav","dict","dns","file","ftp","geo","go","gopher","h323","http","https","iax","icap","im","imap","info","ipp","iris","iris.beep","iris.xpc","iris.xpcs","iris.lwz","ldap","mailto","mid","msrp","msrps","mtqp","mupdate","news","nfs","ni","nih","nntp","opaquelocktoken","pop","pres","rtsp","service","session","shttp","sieve","sip","sips","sms","snmp","soap.beep","soap.beeps","tag","tel","telnet","tftp","thismessage","tn3270","tip","tv","urn","vemmi","ws","wss","xcon","xcon-userid","xmlrpc.beep","xmlrpc.beeps","xmpp","z39.50r","z39.50s","adiumxtra","afp","afs","aim","apt","attachment","aw","beshare","bitcoin","bolo","callto","chrome","chrome-extension","com-eventbrite-attendee","content","cvs","dlna-playsingle","dlna-playcontainer","dtn","dvb","ed2k","facetime","feed","finger","fish","gg","git","gizmoproject","gtalk","hcp","icon","ipn","irc","irc6","ircs","itms","jar","jms","keyparc","lastfm","ldaps","magnet","maps","market","message","mms","ms-help","msnim","mumble","mvn","notes","oid","palm","paparazzi","platform","proxy","psyc","query","res","resource","rmi","rsync","rtmp","secondlife","sftp","sgn","skype","smb","soldat","spotify","ssh","steam","svn","teamspeak","things","udp","unreal","ut2004","ventrilo","view-source","webcal","wtai","wyciwyg","xfire","xri","ymsgr"],Jt=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,Yt=/^<([a-zA-Z.\-]{1,25}):([^<>\x00-\x20]*)>/;function Qt(e,t){return e=e.source,t=t||"",function n(r,o){return r?(o=o.source||o,e=e.replace(r,o),n):new RegExp(e,t)}}var Xt=Qt(/(?:unquoted|single_quoted|double_quoted)/)("unquoted",/[^"'=<>`\x00-\x20]+/)("single_quoted",/'[^']*'/)("double_quoted",/"[^"]*"/)(),en=Qt(/(?:\s+attr_name(?:\s*=\s*attr_value)?)/)("attr_name",/[a-zA-Z_:][a-zA-Z0-9:._-]*/)("attr_value",Xt)(),tn=Qt(/<[A-Za-z][A-Za-z0-9]*attribute*\s*\/?>/)("attribute",en)(),nn=Qt(/^(?:open_tag|close_tag|comment|processing|declaration|cdata)/)("open_tag",tn)("close_tag",/<\/[A-Za-z][A-Za-z0-9]*\s*>/)("comment",/<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->/)("processing",/<[?].*?[?]>/)("declaration",/<![A-Z]+\s+[^>]*>/)("cdata",/<!\[CDATA\[[\s\S]*?\]\]>/)();var rn=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,on=/^&([a-z][a-z0-9]{1,31});/i;var sn=[["text",function(e,t){for(var n=e.pos;n<e.posMax&&!qt(e.src.charCodeAt(n));)n++;return n!==e.pos&&(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}],["newline",function(e,t){var n,r,o=e.pos;if(10!==e.src.charCodeAt(o))return!1;if(n=e.pending.length-1,r=e.posMax,!t)if(n>=0&&32===e.pending.charCodeAt(n))if(n>=1&&32===e.pending.charCodeAt(n-1)){for(var i=n-2;i>=0;i--)if(32!==e.pending.charCodeAt(i)){e.pending=e.pending.substring(0,i+1);break}e.push({type:"hardbreak",level:e.level})}else e.pending=e.pending.slice(0,-1),e.push({type:"softbreak",level:e.level});else e.push({type:"softbreak",level:e.level});for(o++;o<r&&32===e.src.charCodeAt(o);)o++;return e.pos=o,!0}],["escape",function(e,t){var n,r=e.pos,o=e.posMax;if(92!==e.src.charCodeAt(r))return!1;if(++r<o){if((n=e.src.charCodeAt(r))<256&&0!==Ut[n])return t||(e.pending+=e.src[r]),e.pos+=2,!0;if(10===n){for(t||e.push({type:"hardbreak",level:e.level}),r++;r<o&&32===e.src.charCodeAt(r);)r++;return e.pos=r,!0}}return t||(e.pending+="\\"),e.pos++,!0}],["backticks",function(e,t){var n,r,o,i,s,a=e.pos;if(96!==e.src.charCodeAt(a))return!1;for(n=a,a++,r=e.posMax;a<r&&96===e.src.charCodeAt(a);)a++;for(o=e.src.slice(n,a),i=s=a;-1!==(i=e.src.indexOf("`",s));){for(s=i+1;s<r&&96===e.src.charCodeAt(s);)s++;if(s-i===o.length)return t||e.push({type:"code",content:e.src.slice(a,i).replace(/[ \n]+/g," ").trim(),block:!1,level:e.level}),e.pos=s,!0}return t||(e.pending+=o),e.pos+=o.length,!0}],["del",function(e,t){var n,r,o,i,s,a=e.posMax,l=e.pos;if(126!==e.src.charCodeAt(l))return!1;if(t)return!1;if(l+4>=a)return!1;if(126!==e.src.charCodeAt(l+1))return!1;if(e.level>=e.options.maxNesting)return!1;if(i=l>0?e.src.charCodeAt(l-1):-1,s=e.src.charCodeAt(l+2),126===i)return!1;if(126===s)return!1;if(32===s||10===s)return!1;for(r=l+2;r<a&&126===e.src.charCodeAt(r);)r++;if(r>l+3)return e.pos+=r-l,t||(e.pending+=e.src.slice(l,r)),!0;for(e.pos=l+2,o=1;e.pos+1<a;){if(126===e.src.charCodeAt(e.pos)&&126===e.src.charCodeAt(e.pos+1)&&(i=e.src.charCodeAt(e.pos-1),126!==(s=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1)&&126!==i&&(32!==i&&10!==i?o--:32!==s&&10!==s&&o++,o<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"del_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"del_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}],["ins",function(e,t){var n,r,o,i,s,a=e.posMax,l=e.pos;if(43!==e.src.charCodeAt(l))return!1;if(t)return!1;if(l+4>=a)return!1;if(43!==e.src.charCodeAt(l+1))return!1;if(e.level>=e.options.maxNesting)return!1;if(i=l>0?e.src.charCodeAt(l-1):-1,s=e.src.charCodeAt(l+2),43===i)return!1;if(43===s)return!1;if(32===s||10===s)return!1;for(r=l+2;r<a&&43===e.src.charCodeAt(r);)r++;if(r!==l+2)return e.pos+=r-l,t||(e.pending+=e.src.slice(l,r)),!0;for(e.pos=l+2,o=1;e.pos+1<a;){if(43===e.src.charCodeAt(e.pos)&&43===e.src.charCodeAt(e.pos+1)&&(i=e.src.charCodeAt(e.pos-1),43!==(s=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1)&&43!==i&&(32!==i&&10!==i?o--:32!==s&&10!==s&&o++,o<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"ins_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"ins_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}],["mark",function(e,t){var n,r,o,i,s,a=e.posMax,l=e.pos;if(61!==e.src.charCodeAt(l))return!1;if(t)return!1;if(l+4>=a)return!1;if(61!==e.src.charCodeAt(l+1))return!1;if(e.level>=e.options.maxNesting)return!1;if(i=l>0?e.src.charCodeAt(l-1):-1,s=e.src.charCodeAt(l+2),61===i)return!1;if(61===s)return!1;if(32===s||10===s)return!1;for(r=l+2;r<a&&61===e.src.charCodeAt(r);)r++;if(r!==l+2)return e.pos+=r-l,t||(e.pending+=e.src.slice(l,r)),!0;for(e.pos=l+2,o=1;e.pos+1<a;){if(61===e.src.charCodeAt(e.pos)&&61===e.src.charCodeAt(e.pos+1)&&(i=e.src.charCodeAt(e.pos-1),61!==(s=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1)&&61!==i&&(32!==i&&10!==i?o--:32!==s&&10!==s&&o++,o<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"mark_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"mark_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}],["emphasis",function(e,t){var n,r,o,i,s,a,l,u=e.posMax,c=e.pos,h=e.src.charCodeAt(c);if(95!==h&&42!==h)return!1;if(t)return!1;if(n=(l=Wt(e,c)).delims,!l.can_open)return e.pos+=n,t||(e.pending+=e.src.slice(c,e.pos)),!0;if(e.level>=e.options.maxNesting)return!1;for(e.pos=c+n,a=[n];e.pos<u;)if(e.src.charCodeAt(e.pos)!==h)e.parser.skipToken(e);else{if(r=(l=Wt(e,e.pos)).delims,l.can_close){for(i=a.pop(),s=r;i!==s;){if(s<i){a.push(i-s);break}if(s-=i,0===a.length)break;e.pos+=i,i=a.pop()}if(0===a.length){n=i,o=!0;break}e.pos+=r;continue}l.can_open&&a.push(r),e.pos+=r}return o?(e.posMax=e.pos,e.pos=c+n,t||(2!==n&&3!==n||e.push({type:"strong_open",level:e.level++}),1!==n&&3!==n||e.push({type:"em_open",level:e.level++}),e.parser.tokenize(e),1!==n&&3!==n||e.push({type:"em_close",level:--e.level}),2!==n&&3!==n||e.push({type:"strong_close",level:--e.level})),e.pos=e.posMax+n,e.posMax=u,!0):(e.pos=c,!1)}],["sub",function(e,t){var n,r,o=e.posMax,i=e.pos;if(126!==e.src.charCodeAt(i))return!1;if(t)return!1;if(i+2>=o)return!1;if(e.level>=e.options.maxNesting)return!1;for(e.pos=i+1;e.pos<o;){if(126===e.src.charCodeAt(e.pos)){n=!0;break}e.parser.skipToken(e)}return n&&i+1!==e.pos?(r=e.src.slice(i+1,e.pos)).match(/(^|[^\\])(\\\\)*\s/)?(e.pos=i,!1):(e.posMax=e.pos,e.pos=i+1,t||e.push({type:"sub",level:e.level,content:r.replace(Kt,"$1")}),e.pos=e.posMax+1,e.posMax=o,!0):(e.pos=i,!1)}],["sup",function(e,t){var n,r,o=e.posMax,i=e.pos;if(94!==e.src.charCodeAt(i))return!1;if(t)return!1;if(i+2>=o)return!1;if(e.level>=e.options.maxNesting)return!1;for(e.pos=i+1;e.pos<o;){if(94===e.src.charCodeAt(e.pos)){n=!0;break}e.parser.skipToken(e)}return n&&i+1!==e.pos?(r=e.src.slice(i+1,e.pos)).match(/(^|[^\\])(\\\\)*\s/)?(e.pos=i,!1):(e.posMax=e.pos,e.pos=i+1,t||e.push({type:"sup",level:e.level,content:r.replace(Zt,"$1")}),e.pos=e.posMax+1,e.posMax=o,!0):(e.pos=i,!1)}],["links",function(e,t){var n,r,o,i,s,a,l,u,c=!1,h=e.pos,f=e.posMax,d=e.pos,p=e.src.charCodeAt(d);if(33===p&&(c=!0,p=e.src.charCodeAt(++d)),91!==p)return!1;if(e.level>=e.options.maxNesting)return!1;if(n=d+1,(r=ct(e,d))<0)return!1;if((a=r+1)<f&&40===e.src.charCodeAt(a)){for(a++;a<f&&(32===(u=e.src.charCodeAt(a))||10===u);a++);if(a>=f)return!1;for(d=a,dt(e,a)?(i=e.linkContent,a=e.pos):i="",d=a;a<f&&(32===(u=e.src.charCodeAt(a))||10===u);a++);if(a<f&&d!==a&&pt(e,a))for(s=e.linkContent,a=e.pos;a<f&&(32===(u=e.src.charCodeAt(a))||10===u);a++);else s="";if(a>=f||41!==e.src.charCodeAt(a))return e.pos=h,!1;a++}else{if(e.linkLevel>0)return!1;for(;a<f&&(32===(u=e.src.charCodeAt(a))||10===u);a++);if(a<f&&91===e.src.charCodeAt(a)&&(d=a+1,(a=ct(e,a))>=0?o=e.src.slice(d,a++):a=d-1),o||(void 0===o&&(a=r+1),o=e.src.slice(n,r)),!(l=e.env.references[gt(o)]))return e.pos=h,!1;i=l.href,s=l.title}return t||(e.pos=n,e.posMax=r,c?e.push({type:"image",src:i,title:s,alt:e.src.substr(n,r-n),level:e.level}):(e.push({type:"link_open",href:i,title:s,level:e.level++}),e.linkLevel++,e.parser.tokenize(e),e.linkLevel--,e.push({type:"link_close",level:--e.level}))),e.pos=a,e.posMax=f,!0}],["footnote_inline",function(e,t){var n,r,o,i,s=e.posMax,a=e.pos;return!(a+2>=s)&&(94===e.src.charCodeAt(a)&&(91===e.src.charCodeAt(a+1)&&(!(e.level>=e.options.maxNesting)&&(n=a+2,!((r=ct(e,a+1))<0)&&(t||(e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.list||(e.env.footnotes.list=[]),o=e.env.footnotes.list.length,e.pos=n,e.posMax=r,e.push({type:"footnote_ref",id:o,level:e.level}),e.linkLevel++,i=e.tokens.length,e.parser.tokenize(e),e.env.footnotes.list[o]={tokens:e.tokens.splice(i)},e.linkLevel--),e.pos=r+1,e.posMax=s,!0)))))}],["footnote_ref",function(e,t){var n,r,o,i,s=e.posMax,a=e.pos;if(a+3>s)return!1;if(!e.env.footnotes||!e.env.footnotes.refs)return!1;if(91!==e.src.charCodeAt(a))return!1;if(94!==e.src.charCodeAt(a+1))return!1;if(e.level>=e.options.maxNesting)return!1;for(r=a+2;r<s;r++){if(32===e.src.charCodeAt(r))return!1;if(10===e.src.charCodeAt(r))return!1;if(93===e.src.charCodeAt(r))break}return r!==a+2&&(!(r>=s)&&(r++,n=e.src.slice(a+2,r-1),void 0!==e.env.footnotes.refs[":"+n]&&(t||(e.env.footnotes.list||(e.env.footnotes.list=[]),e.env.footnotes.refs[":"+n]<0?(o=e.env.footnotes.list.length,e.env.footnotes.list[o]={label:n,count:0},e.env.footnotes.refs[":"+n]=o):o=e.env.footnotes.refs[":"+n],i=e.env.footnotes.list[o].count,e.env.footnotes.list[o].count++,e.push({type:"footnote_ref",id:o,subId:i,level:e.level})),e.pos=r,e.posMax=s,!0)))}],["autolink",function(e,t){var n,r,o,i,s,a=e.pos;return 60===e.src.charCodeAt(a)&&(!((n=e.src.slice(a)).indexOf(">")<0)&&((r=n.match(Yt))?!(Gt.indexOf(r[1].toLowerCase())<0)&&(s=ft(i=r[0].slice(1,-1)),!!e.parser.validateLink(i)&&(t||(e.push({type:"link_open",href:s,level:e.level}),e.push({type:"text",content:i,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=r[0].length,!0)):!!(o=n.match(Jt))&&(s=ft("mailto:"+(i=o[0].slice(1,-1))),!!e.parser.validateLink(s)&&(t||(e.push({type:"link_open",href:s,level:e.level}),e.push({type:"text",content:i,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=o[0].length,!0))))}],["htmltag",function(e,t){var n,r,o,i=e.pos;return!!e.options.html&&(o=e.posMax,!(60!==e.src.charCodeAt(i)||i+2>=o)&&(!(33!==(n=e.src.charCodeAt(i+1))&&63!==n&&47!==n&&!function(e){var t=32|e;return t>=97&&t<=122}(n))&&(!!(r=e.src.slice(i).match(nn))&&(t||e.push({type:"htmltag",content:e.src.slice(i,i+r[0].length),level:e.level}),e.pos+=r[0].length,!0))))}],["entity",function(e,t){var n,r,o=e.pos,i=e.posMax;if(38!==e.src.charCodeAt(o))return!1;if(o+1<i)if(35===e.src.charCodeAt(o+1)){if(r=e.src.slice(o).match(rn))return t||(n="x"===r[1][0].toLowerCase()?parseInt(r[1].slice(1),16):parseInt(r[1],10),e.pending+=Ke(n)?Ze(n):Ze(65533)),e.pos+=r[0].length,!0}else if(r=e.src.slice(o).match(on)){var s=qe(r[1]);if(r[1]!==s)return t||(e.pending+=s),e.pos+=r[0].length,!0}return t||(e.pending+="&"),e.pos++,!0}]];function an(){this.ruler=new lt;for(var e=0;e<sn.length;e++)this.ruler.push(sn[e][0],sn[e][1]);this.validateLink=ln}function ln(e){var t=e.trim().toLowerCase();return-1===(t=Qe(t)).indexOf(":")||-1===["vbscript","javascript","file","data"].indexOf(t.split(":")[0])}an.prototype.skipToken=function(e){var t,n,r=this.ruler.getRules(""),o=r.length,i=e.pos;if((n=e.cacheGet(i))>0)e.pos=n;else{for(t=0;t<o;t++)if(r[t](e,!0))return void e.cacheSet(i,e.pos);e.pos++,e.cacheSet(i,e.pos)}},an.prototype.tokenize=function(e){for(var t,n,r=this.ruler.getRules(""),o=r.length,i=e.posMax;e.pos<i;){for(n=0;n<o&&!(t=r[n](e,!1));n++);if(t){if(e.pos>=i)break}else e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()},an.prototype.parse=function(e,t,n,r){var o=new ut(e,this,t,n,r);this.tokenize(o)};var un={default:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","replacements","smartquotes","references","abbr2","footnote_tail"]},block:{rules:["blockquote","code","fences","footnote","heading","hr","htmlblock","lheading","list","paragraph","table"]},inline:{rules:["autolink","backticks","del","emphasis","entity","escape","footnote_ref","htmltag","links","newline","text"]}}},full:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{},block:{},inline:{}}},commonmark:{options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","abbr2"]},block:{rules:["blockquote","code","fences","heading","hr","htmlblock","lheading","list","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","htmltag","links","newline","text"]}}}};function cn(e,t,n){this.src=t,this.env=n,this.options=e.options,this.tokens=[],this.inlineMode=!1,this.inline=e.inline,this.block=e.block,this.renderer=e.renderer,this.typographer=e.typographer}function hn(e,t){"string"!=typeof e&&(t=e,e="default"),t&&null!=t.linkify&&console.warn("linkify option is removed. Use linkify plugin instead:\n\nimport Remarkable from 'remarkable';\nimport linkify from 'remarkable/linkify';\nnew Remarkable().use(linkify)\n"),this.inline=new an,this.block=new Lt,this.core=new St,this.renderer=new at,this.ruler=new lt,this.options={},this.configure(un[e]),this.set(t||{})}hn.prototype.set=function(e){He(this.options,e)},hn.prototype.configure=function(e){var t=this;if(!e)throw new Error("Wrong `remarkable` preset, check name/content");e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach((function(n){e.components[n].rules&&t[n].ruler.enable(e.components[n].rules,!0)}))},hn.prototype.use=function(e,t){return e(this,t),this},hn.prototype.parse=function(e,t){var n=new cn(this,e,t);return this.core.process(n),n.tokens},hn.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)},hn.prototype.parseInline=function(e,t){var n=new cn(this,e,t);return n.inlineMode=!0,this.core.process(n),n.tokens},hn.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};function fn(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function dn(e,t){for(var n=e.length-1;n>=0;n--)!0===t(e[n])&&e.splice(n,1)}function pn(e){throw new Error("Unhandled case for value: '".concat(e,"'"))}var gn=function(){function e(e){void 0===e&&(e={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=e.tagName||"",this.attrs=e.attrs||{},this.innerHTML=e.innerHtml||e.innerHTML||""}return e.prototype.setTagName=function(e){return this.tagName=e,this},e.prototype.getTagName=function(){return this.tagName||""},e.prototype.setAttr=function(e,t){return this.getAttrs()[e]=t,this},e.prototype.getAttr=function(e){return this.getAttrs()[e]},e.prototype.setAttrs=function(e){return Object.assign(this.getAttrs(),e),this},e.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},e.prototype.setClass=function(e){return this.setAttr("class",e)},e.prototype.addClass=function(e){for(var t,n=this.getClass(),r=this.whitespaceRegex,o=n?n.split(r):[],i=e.split(r);t=i.shift();)-1===fn(o,t)&&o.push(t);return this.getAttrs().class=o.join(" "),this},e.prototype.removeClass=function(e){for(var t,n=this.getClass(),r=this.whitespaceRegex,o=n?n.split(r):[],i=e.split(r);o.length&&(t=i.shift());){var s=fn(o,t);-1!==s&&o.splice(s,1)}return this.getAttrs().class=o.join(" "),this},e.prototype.getClass=function(){return this.getAttrs().class||""},e.prototype.hasClass=function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},e.prototype.setInnerHTML=function(e){return this.innerHTML=e,this},e.prototype.setInnerHtml=function(e){return this.setInnerHTML(e)},e.prototype.getInnerHTML=function(){return this.innerHTML||""},e.prototype.getInnerHtml=function(){return this.getInnerHTML()},e.prototype.toAnchorString=function(){var e=this.getTagName(),t=this.buildAttrsStr();return["<",e,t=t?" "+t:"",">",this.getInnerHtml(),"</",e,">"].join("")},e.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+'="'+e[n]+'"');return t.join(" ")},e}();var mn=function(){function e(e){void 0===e&&(e={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=e.newWindow||!1,this.truncate=e.truncate||{},this.className=e.className||""}return e.prototype.build=function(e){return new gn({tagName:"a",attrs:this.createAttrs(e),innerHtml:this.processAnchorText(e.getAnchorText())})},e.prototype.createAttrs=function(e){var t={href:e.getAnchorHref()},n=this.createCssClass(e);return n&&(t.class=n),this.newWindow&&(t.target="_blank",t.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<e.getAnchorText().length&&(t.title=e.getAnchorHref()),t},e.prototype.createCssClass=function(e){var t=this.className;if(t){for(var n=[t],r=e.getCssClassSuffixes(),o=0,i=r.length;o<i;o++)n.push(t+"-"+r[o]);return n.join(" ")}return""},e.prototype.processAnchorText=function(e){return e=this.doTruncate(e)},e.prototype.doTruncate=function(e){var t=this.truncate;if(!t||!t.length)return e;var n=t.length,r=t.location;return"smart"===r?function(e,t,n){var r,o;null==n?(n="&hellip;",o=3,r=8):(o=n.length,r=n.length);var i=function(e){var t="";return e.scheme&&e.host&&(t+=e.scheme+"://"),e.host&&(t+=e.host),e.path&&(t+="/"+e.path),e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t},s=function(e,t){var r=t/2,o=Math.ceil(r),i=-1*Math.floor(r),s="";return i<0&&(s=e.substr(i)),e.substr(0,o)+n+s};if(e.length<=t)return e;var a,l,u,c=t-o,h=(a={},(u=(l=e).match(/^([a-z]+):\/\//i))&&(a.scheme=u[1],l=l.substr(u[0].length)),(u=l.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(a.host=u[1],l=l.substr(u[0].length)),(u=l.match(/^\/(.*?)(?=(\?|#|$))/i))&&(a.path=u[1],l=l.substr(u[0].length)),(u=l.match(/^\?(.*?)(?=(#|$))/i))&&(a.query=u[1],l=l.substr(u[0].length)),(u=l.match(/^#(.*?)$/i))&&(a.fragment=u[1]),a);if(h.query){var f=h.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);f&&(h.query=h.query.substr(0,f[1].length),e=i(h))}if(e.length<=t)return e;if(h.host&&(h.host=h.host.replace(/^www\./,""),e=i(h)),e.length<=t)return e;var d="";if(h.host&&(d+=h.host),d.length>=c)return h.host.length==t?(h.host.substr(0,t-o)+n).substr(0,c+r):s(d,c).substr(0,c+r);var p="";if(h.path&&(p+="/"+h.path),h.query&&(p+="?"+h.query),p){if((d+p).length>=c)return(d+p).length==t?(d+p).substr(0,t):(d+s(p,c-d.length)).substr(0,c+r);d+=p}if(h.fragment){var g="#"+h.fragment;if((d+g).length>=c)return(d+g).length==t?(d+g).substr(0,t):(d+s(g,c-d.length)).substr(0,c+r);d+=g}if(h.scheme&&h.host){var m=h.scheme+"://";if((d+m).length<c)return(m+d).substr(0,t)}if(d.length<=t)return d;var y="";return c>0&&(y=d.substr(-1*Math.floor(c/2))),(d.substr(0,Math.ceil(c/2))+n+y).substr(0,c+r)}(e,n):"middle"===r?function(e,t,n){if(e.length<=t)return e;var r,o;null==n?(n="&hellip;",r=8,o=3):(r=n.length,o=n.length);var i=t-o,s="";return i>0&&(s=e.substr(-1*Math.floor(i/2))),(e.substr(0,Math.ceil(i/2))+n+s).substr(0,i+r)}(e,n):function(e,t,n){return function(e,t,n){var r;return e.length>t&&(null==n?(n="&hellip;",r=3):r=n.length,e=e.substring(0,t-r)+n),e}(e,t,n)}(e,n)},e}(),yn=function(){function e(e){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=e.tagBuilder,this.matchedText=e.matchedText,this.offset=e.offset}return e.prototype.getMatchedText=function(){return this.matchedText},e.prototype.setOffset=function(e){this.offset=e},e.prototype.getOffset=function(){return this.offset},e.prototype.getCssClassSuffixes=function(){return[this.getType()]},e.prototype.buildTag=function(){return this.tagBuilder.build(this)},e}(),bn=function(e,t){return(bn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function vn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}bn(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var wn=function(){return wn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},wn.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var kn,xn=function(e){function t(t){var n=e.call(this,t)||this;return n.email="",n.email=t.email,n}return vn(t,e),t.prototype.getType=function(){return"email"},t.prototype.getEmail=function(){return this.email},t.prototype.getAnchorHref=function(){return"mailto:"+this.email},t.prototype.getAnchorText=function(){return this.email},t}(yn),An=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="",n.hashtag="",n.serviceName=t.serviceName,n.hashtag=t.hashtag,n}return vn(t,e),t.prototype.getType=function(){return"hashtag"},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getHashtag=function(){return this.hashtag},t.prototype.getAnchorHref=function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;case"instagram":return"https://instagram.com/explore/tags/"+t;case"tiktok":return"https://www.tiktok.com/tag/"+t;default:throw new Error("Unknown service name to point hashtag to: "+e)}},t.prototype.getAnchorText=function(){return"#"+this.hashtag},t}(yn),En=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="twitter",n.mention="",n.mention=t.mention,n.serviceName=t.serviceName,n}return vn(t,e),t.prototype.getType=function(){return"mention"},t.prototype.getMention=function(){return this.mention},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},t.prototype.getAnchorText=function(){return"@"+this.mention},t.prototype.getCssClassSuffixes=function(){var t=e.prototype.getCssClassSuffixes.call(this),n=this.getServiceName();return n&&t.push(n),t},t}(yn),Cn=function(e){function t(t){var n=e.call(this,t)||this;return n.number="",n.plusSign=!1,n.number=t.number,n.plusSign=t.plusSign,n}return vn(t,e),t.prototype.getType=function(){return"phone"},t.prototype.getPhoneNumber=function(){return this.number},t.prototype.getNumber=function(){return this.getPhoneNumber()},t.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},t.prototype.getAnchorText=function(){return this.matchedText},t}(yn),_n=function(e){function t(t){var n=e.call(this,t)||this;return n.url="",n.urlMatchType="scheme",n.protocolUrlMatch=!1,n.protocolRelativeMatch=!1,n.stripPrefix={scheme:!0,www:!0},n.stripTrailingSlash=!0,n.decodePercentEncoding=!0,n.schemePrefixRegex=/^(https?:\/\/)?/i,n.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,n.protocolRelativeRegex=/^\/\//,n.protocolPrepended=!1,n.urlMatchType=t.urlMatchType,n.url=t.url,n.protocolUrlMatch=t.protocolUrlMatch,n.protocolRelativeMatch=t.protocolRelativeMatch,n.stripPrefix=t.stripPrefix,n.stripTrailingSlash=t.stripTrailingSlash,n.decodePercentEncoding=t.decodePercentEncoding,n}return vn(t,e),t.prototype.getType=function(){return"url"},t.prototype.getUrlMatchType=function(){return this.urlMatchType},t.prototype.getUrl=function(){var e=this.url;return this.protocolRelativeMatch||this.protocolUrlMatch||this.protocolPrepended||(e=this.url="http://"+e,this.protocolPrepended=!0),e},t.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},t.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},t.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},t.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},t.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},t.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},t.prototype.removePercentEncoding=function(e){var t=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(t)}catch(n){return t}},t}(yn),Bn=function(e){this.__jsduckDummyDocProp=null,this.tagBuilder=e.tagBuilder},Sn=/[A-Za-z]/,Fn=/[\d]/,zn=/[\D]/,Dn=/\s/,In=/['"]/,Mn=/[\x00-\x1F\x7F]/,On=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,Tn=On+/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,Pn=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,Rn=Tn+Pn,Ln=Tn+Pn,$n=new RegExp("[".concat(Ln,"]")),jn="(?:["+Pn+"]{1,3}\\.){3}["+Pn+"]{1,3}",Nn="["+Ln+"](?:["+Ln+"\\-_]{0,61}["+Ln+"])?",qn=function(e){return"(?=("+Nn+"))\\"+e},Un=function(e){return"(?:"+qn(e)+"(?:\\."+qn(e+1)+"){0,126}|"+jn+")"},Hn=$n,Vn=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|vermögensberatung|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|vermögensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|சிங்கப்பூர்|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|موريتانيا|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|السعودية|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|католик|اتصالات|البحرين|الجزائر|العليان|پاکستان|كاثوليك|இந்தியா|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|москва|онлайн|ابوظبي|ارامكو|الاردن|المغرب|امارات|فلسطين|مليسيا|भारतम्|இலங்கை|ファッション|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|music|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|ישראל|ایران|بازار|بھارت|سودان|سورية|همراه|भारोत|संगठन|বাংলা|భారత్|ഭാരതം|嘉里大酒店|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kids|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|read|reit|rent|rest|rich|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|дети|сайт|بارت|بيتك|ڀارت|تونس|شبكة|عراق|عمان|موقع|भारत|ভারত|ভাৰত|ਭਾਰਤ|ભારત|ଭାରତ|ಭಾರತ|ලංකා|アマゾン|グーグル|クラウド|ポイント|组织机构|電訊盈科|香格里拉|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|бел|ком|қаз|мкд|мон|орг|рус|срб|укр|հայ|קום|عرب|قطر|كوم|مصر|कॉम|नेट|คอม|ไทย|ລາວ|ストア|セール|みんな|中文网|亚马逊|天主教|我爱你|新加坡|淡马锡|诺基亚|飞利浦|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|ελ|ευ|бг|ею|рф|გე|닷넷|닷컴|삼성|한국|コム|世界|中信|中国|中國|企业|佛山|信息|健康|八卦|公司|公益|台湾|台灣|商城|商店|商标|嘉里|在线|大拿|娱乐|家電|广东|微博|慈善|手机|招聘|政务|政府|新闻|时尚|書籍|机构|游戏|澳門|点看|移动|网址|网店|网站|网络|联通|谷歌|购物|通販|集团|食品|餐厅|香港)/,Wn=new RegExp("[".concat(Ln,"!#$%&'*+/=?^_`{|}~-]")),Kn=new RegExp("^".concat(Vn.source,"$")),Zn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.localPartCharRegex=Wn,t.strictTldRegex=Kn,t}return vn(t,e),t.prototype.parseMatches=function(e){for(var t=this.tagBuilder,n=this.localPartCharRegex,r=this.strictTldRegex,o=[],i=e.length,s=new Gn,a={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},l=0,u=0,c=s;l<i;){var h=e.charAt(l);switch(u){case 0:f(h);break;case 1:d(e.charAt(l-1),h);break;case 2:p(h);break;case 3:g(h);break;case 4:m(h);break;case 5:y(h);break;case 6:b(h);break;case 7:v(h);break;default:pn(u)}l++}return x(),o;function f(e){"m"===e?w(1):n.test(e)&&w()}function d(e,t){":"===e?n.test(t)?(u=2,c=new Gn(wn(wn({},c),{hasMailtoPrefix:!0}))):k():a[e]===t||(n.test(t)?u=2:"."===t?u=3:"@"===t?u=4:k())}function p(e){"."===e?u=3:"@"===e?u=4:n.test(e)||k()}function g(e){"."===e||"@"===e?k():n.test(e)?u=2:k()}function m(e){Hn.test(e)?u=5:k()}function y(e){"."===e?u=7:"-"===e?u=6:Hn.test(e)||x()}function b(e){"-"===e||"."===e?x():Hn.test(e)?u=5:x()}function v(e){"."===e||"-"===e?x():Hn.test(e)?(u=5,c=new Gn(wn(wn({},c),{hasDomainDot:!0}))):x()}function w(e){void 0===e&&(e=2),u=e,c=new Gn({idx:l})}function k(){u=0,c=s}function x(){if(c.hasDomainDot){var n=e.slice(c.idx,l);/[-.]$/.test(n)&&(n=n.slice(0,-1));var i=c.hasMailtoPrefix?n.slice(7):n;s=(i.split(".").pop()||"").toLowerCase(),r.test(s)&&o.push(new xn({tagBuilder:t,matchedText:n,offset:c.idx,email:i}))}var s;k()}},t}(Bn),Gn=function(e){void 0===e&&(e={}),this.idx=void 0!==e.idx?e.idx:-1,this.hasMailtoPrefix=!!e.hasMailtoPrefix,this.hasDomainDot=!!e.hasDomainDot},Jn=function(){function e(){}return e.isValid=function(e,t){return!(t&&!this.isValidUriScheme(t)||this.urlMatchDoesNotHaveProtocolOrDot(e,t)||this.urlMatchDoesNotHaveAtLeastOneWordChar(e,t)&&!this.isValidIpAddress(e)||this.containsMultipleDots(e))},e.isValidIpAddress=function(e){var t=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==e.match(t)},e.containsMultipleDots=function(e){var t=e;return this.hasFullProtocolRegex.test(e)&&(t=e.split("://")[1]),t.split("/")[0].indexOf("..")>-1},e.isValidUriScheme=function(e){var t=e.match(this.uriSchemeRegex),n=t&&t[0].toLowerCase();return"javascript:"!==n&&"vbscript:"!==n},e.urlMatchDoesNotHaveProtocolOrDot=function(e,t){return!(!e||t&&this.hasFullProtocolRegex.test(t)||-1!==e.indexOf("."))},e.urlMatchDoesNotHaveAtLeastOneWordChar=function(e,t){return!(!e||!t)&&(!this.hasFullProtocolRegex.test(t)&&!this.hasWordCharAfterProtocolRegex.test(e))},e.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,e.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,e.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+On+"]"),e.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,e}(),Yn=(kn=new RegExp("[/?#](?:["+Ln+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^✓]*["+Ln+"\\-+&@#/%=~_()|'$*\\[\\]{}✓])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,Un(2),")","|","(","(//)?",/(?:www\.)/.source,Un(6),")","|","(","(//)?",Un(10)+"\\.",Vn.source,"(?![-"+Rn+"])",")",")","(?::[0-9]+)?","(?:"+kn.source+")?"].join(""),"gi")),Qn=new RegExp("["+Ln+"]"),Xn=function(e){function t(t){var n=e.call(this,t)||this;return n.stripPrefix={scheme:!0,www:!0},n.stripTrailingSlash=!0,n.decodePercentEncoding=!0,n.matcherRegex=Yn,n.wordCharRegExp=Qn,n.stripPrefix=t.stripPrefix,n.stripTrailingSlash=t.stripTrailingSlash,n.decodePercentEncoding=t.decodePercentEncoding,n}return vn(t,e),t.prototype.parseMatches=function(e){for(var t,n=this.matcherRegex,r=this.stripPrefix,o=this.stripTrailingSlash,i=this.decodePercentEncoding,s=this.tagBuilder,a=[],l=function(){var n=t[0],l=t[1],c=t[4],h=t[5],f=t[9],d=t.index,p=h||f,g=e.charAt(d-1);if(!Jn.isValid(n,l))return"continue";if(d>0&&"@"===g)return"continue";if(d>0&&p&&u.wordCharRegExp.test(g))return"continue";if(/\?$/.test(n)&&(n=n.substr(0,n.length-1)),u.matchHasUnbalancedClosingParen(n))n=n.substr(0,n.length-1);else{var m=u.matchHasInvalidCharAfterTld(n,l);m>-1&&(n=n.substr(0,m))}var y=["http://","https://"].find((function(e){return!!l&&-1!==l.indexOf(e)}));if(y){var b=n.indexOf(y);n=n.substr(b),l=l.substr(b),d+=b}var v=l?"scheme":c?"www":"tld",w=!!l;a.push(new _n({tagBuilder:s,matchedText:n,offset:d,urlMatchType:v,url:n,protocolUrlMatch:w,protocolRelativeMatch:!!p,stripPrefix:r,stripTrailingSlash:o,decodePercentEncoding:i}))},u=this;null!==(t=n.exec(e));)l();return a},t.prototype.matchHasUnbalancedClosingParen=function(e){var t,n=e.charAt(e.length-1);if(")"===n)t="(";else if("]"===n)t="[";else{if("}"!==n)return!1;t="{"}for(var r=0,o=0,i=e.length-1;o<i;o++){var s=e.charAt(o);s===t?r++:s===n&&(r=Math.max(r-1,0))}return 0===r},t.prototype.matchHasInvalidCharAfterTld=function(e,t){if(!e)return-1;var n=0;t&&(n=e.indexOf(":"),e=e.slice(n));var r=new RegExp("^((.?//)?[-."+Ln+"]*[-"+Ln+"]\\.[-"+Ln+"]+)").exec(e);return null===r?-1:(n+=r[1].length,e=e.slice(r[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?n:-1)},t}(Bn),er=new RegExp("[_".concat(Ln,"]")),tr=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="twitter",n.serviceName=t.serviceName,n}return vn(t,e),t.prototype.parseMatches=function(e){for(var t=this.tagBuilder,n=this.serviceName,r=[],o=e.length,i=0,s=-1,a=0;i<o;){var l=e.charAt(i);switch(a){case 0:u(l);break;case 1:c(l);break;case 2:h(l);break;case 3:f(l);break;default:pn(a)}i++}return d(),r;function u(e){"#"===e?(a=2,s=i):$n.test(e)&&(a=1)}function c(e){$n.test(e)||(a=0)}function h(e){a=er.test(e)?3:$n.test(e)?1:0}function f(e){er.test(e)||(d(),s=-1,a=$n.test(e)?1:0)}function d(){if(s>-1&&i-s<=140){var o=e.slice(s,i),a=new An({tagBuilder:t,matchedText:o,offset:s,serviceName:n,hashtag:o.slice(1)});r.push(a)}}},t}(Bn),nr=["twitter","facebook","instagram","tiktok"],rr=new RegExp("".concat(/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/.source,"|").concat(/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source),"g"),or=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.matcherRegex=rr,t}return vn(t,e),t.prototype.parseMatches=function(e){for(var t,n=this.matcherRegex,r=this.tagBuilder,o=[];null!==(t=n.exec(e));){var i=t[0],s=i.replace(/[^0-9,;#]/g,""),a=!(!t[1]&&!t[2]),l=0==t.index?"":e.substr(t.index-1,1),u=e.substr(t.index+i.length,1),c=!l.match(/\d/)&&!u.match(/\d/);this.testMatch(t[3])&&this.testMatch(i)&&c&&o.push(new Cn({tagBuilder:r,matchedText:i,offset:t.index,number:s,plusSign:a}))}return o},t.prototype.testMatch=function(e){return zn.test(e)},t}(Bn),ir=new RegExp("@[_".concat(Ln,"]{1,50}(?![_").concat(Ln,"])"),"g"),sr=new RegExp("@[_.".concat(Ln,"]{1,30}(?![_").concat(Ln,"])"),"g"),ar=new RegExp("@[-_.".concat(Ln,"]{1,50}(?![-_").concat(Ln,"])"),"g"),lr=new RegExp("@[_.".concat(Ln,"]{1,23}[_").concat(Ln,"](?![_").concat(Ln,"])"),"g"),ur=new RegExp("[^"+Ln+"]"),cr=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="twitter",n.matcherRegexes={twitter:ir,instagram:sr,soundcloud:ar,tiktok:lr},n.nonWordCharRegex=ur,n.serviceName=t.serviceName,n}return vn(t,e),t.prototype.parseMatches=function(e){var t,n=this.serviceName,r=this.matcherRegexes[this.serviceName],o=this.nonWordCharRegex,i=this.tagBuilder,s=[];if(!r)return s;for(;null!==(t=r.exec(e));){var a=t.index,l=e.charAt(a-1);if(0===a||o.test(l)){var u=t[0].replace(/\.+$/g,""),c=u.slice(1);s.push(new En({tagBuilder:i,matchedText:u,offset:a,serviceName:n,mention:c}))}}return s},t}(Bn);function hr(e,t){for(var n,r=t.onOpenTag,o=t.onCloseTag,i=t.onText,s=t.onComment,a=t.onDoctype,l=new fr,u=0,c=e.length,h=0,f=0,d=l;u<c;){var p=e.charAt(u);switch(h){case 0:g(p);break;case 1:m(p);break;case 2:b(p);break;case 3:y(p);break;case 4:v(p);break;case 5:w(p);break;case 6:k(p);break;case 7:x(p);break;case 8:A(p);break;case 9:E(p);break;case 10:C(p);break;case 11:_(p);break;case 12:B(p);break;case 13:S();break;case 14:F(p);break;case 15:z(p);break;case 16:D(p);break;case 17:I(p);break;case 18:M(p);break;case 19:O(p);break;case 20:T(p);break;default:pn(h)}u++}function g(e){"<"===e&&R()}function m(e){"!"===e?h=13:"/"===e?(h=2,d=new fr(wn(wn({},d),{isClosing:!0}))):"<"===e?R():Sn.test(e)?(h=3,d=new fr(wn(wn({},d),{isOpening:!0}))):(h=0,d=l)}function y(e){Dn.test(e)?(d=new fr(wn(wn({},d),{name:$()})),h=4):"<"===e?R():"/"===e?(d=new fr(wn(wn({},d),{name:$()})),h=12):">"===e?(d=new fr(wn(wn({},d),{name:$()})),L()):Sn.test(e)||Fn.test(e)||":"===e||P()}function b(e){">"===e?P():Sn.test(e)?h=3:P()}function v(e){Dn.test(e)||("/"===e?h=12:">"===e?L():"<"===e?R():"="===e||In.test(e)||Mn.test(e)?P():h=5)}function w(e){Dn.test(e)?h=6:"/"===e?h=12:"="===e?h=7:">"===e?L():"<"===e?R():In.test(e)&&P()}function k(e){Dn.test(e)||("/"===e?h=12:"="===e?h=7:">"===e?L():"<"===e?R():In.test(e)?P():h=5)}function x(e){Dn.test(e)||('"'===e?h=8:"'"===e?h=9:/[>=`]/.test(e)?P():"<"===e?R():h=10)}function A(e){'"'===e&&(h=11)}function E(e){"'"===e&&(h=11)}function C(e){Dn.test(e)?h=4:">"===e?L():"<"===e&&R()}function _(e){Dn.test(e)?h=4:"/"===e?h=12:">"===e?L():"<"===e?R():(h=4,u--)}function B(e){">"===e?(d=new fr(wn(wn({},d),{isClosing:!0})),L()):h=4}function S(t){"--"===e.substr(u,2)?(u+=2,d=new fr(wn(wn({},d),{type:"comment"})),h=14):"DOCTYPE"===e.substr(u,7).toUpperCase()?(u+=7,d=new fr(wn(wn({},d),{type:"doctype"})),h=20):P()}function F(e){"-"===e?h=15:">"===e?P():h=16}function z(e){"-"===e?h=18:">"===e?P():h=16}function D(e){"-"===e&&(h=17)}function I(e){h="-"===e?18:16}function M(e){">"===e?L():"!"===e?h=19:"-"===e||(h=16)}function O(e){"-"===e?h=17:">"===e?L():h=16}function T(e){">"===e?L():"<"===e&&R()}function P(){h=0,d=l}function R(){h=1,d=new fr({idx:u})}function L(){var t=e.slice(f,d.idx);t&&i(t,f),"comment"===d.type?s(d.idx):"doctype"===d.type?a(d.idx):(d.isOpening&&r(d.name,d.idx),d.isClosing&&o(d.name,d.idx)),P(),f=u+1}function $(){var t=d.idx+(d.isClosing?2:1);return e.slice(t,u).toLowerCase()}f<u&&(n=e.slice(f,u),i(n,f),f=u+1)}var fr=function(e){void 0===e&&(e={}),this.idx=void 0!==e.idx?e.idx:-1,this.type=e.type||"tag",this.name=e.name||"",this.isOpening=!!e.isOpening,this.isClosing=!!e.isClosing},dr=function(){function e(t){void 0===t&&(t={}),this.version=e.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(t.urls),this.email="boolean"==typeof t.email?t.email:this.email,this.phone="boolean"==typeof t.phone?t.phone:this.phone,this.hashtag=t.hashtag||this.hashtag,this.mention=t.mention||this.mention,this.newWindow="boolean"==typeof t.newWindow?t.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(t.stripPrefix),this.stripTrailingSlash="boolean"==typeof t.stripTrailingSlash?t.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof t.decodePercentEncoding?t.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=t.sanitizeHtml||!1;var n=this.mention;if(!1!==n&&-1===["twitter","instagram","soundcloud","tiktok"].indexOf(n))throw new Error("invalid `mention` cfg '".concat(n,"' - see docs"));var r=this.hashtag;if(!1!==r&&-1===nr.indexOf(r))throw new Error("invalid `hashtag` cfg '".concat(r,"' - see docs"));this.truncate=this.normalizeTruncateCfg(t.truncate),this.className=t.className||this.className,this.replaceFn=t.replaceFn||this.replaceFn,this.context=t.context||this}return e.link=function(t,n){return new e(n).link(t)},e.parse=function(t,n){return new e(n).parse(t)},e.prototype.normalizeUrlsCfg=function(e){return null==e&&(e=!0),"boolean"==typeof e?{schemeMatches:e,wwwMatches:e,tldMatches:e}:{schemeMatches:"boolean"!=typeof e.schemeMatches||e.schemeMatches,wwwMatches:"boolean"!=typeof e.wwwMatches||e.wwwMatches,tldMatches:"boolean"!=typeof e.tldMatches||e.tldMatches}},e.prototype.normalizeStripPrefixCfg=function(e){return null==e&&(e=!0),"boolean"==typeof e?{scheme:e,www:e}:{scheme:"boolean"!=typeof e.scheme||e.scheme,www:"boolean"!=typeof e.www||e.www}},e.prototype.normalizeTruncateCfg=function(e){return"number"==typeof e?{length:e,location:"end"}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&void 0===e[n]&&(e[n]=t[n]);return e}(e||{},{length:Number.POSITIVE_INFINITY,location:"end"})},e.prototype.parse=function(e){var t=this,n=["a","style","script"],r=0,o=[];return hr(e,{onOpenTag:function(e){n.indexOf(e)>=0&&r++},onText:function(e,n){if(0===r){var i=function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var n,r=[],o=0;n=t.exec(e);)r.push(e.substring(o,n.index)),r.push(n[0]),o=n.index+n[0].length;return r.push(e.substring(o)),r}(e,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),s=n;i.forEach((function(e,n){if(n%2==0){var r=t.parseText(e,s);o.push.apply(o,r)}s+=e.length}))}},onCloseTag:function(e){n.indexOf(e)>=0&&(r=Math.max(r-1,0))},onComment:function(e){},onDoctype:function(e){}}),o=this.compactMatches(o),o=this.removeUnwantedMatches(o)},e.prototype.compactMatches=function(e){e.sort((function(e,t){return e.getOffset()-t.getOffset()}));for(var t=0;t<e.length-1;){var n=e[t],r=n.getOffset(),o=n.getMatchedText().length,i=r+o;if(t+1<e.length){if(e[t+1].getOffset()===r){var s=e[t+1].getMatchedText().length>o?t:t+1;e.splice(s,1);continue}if(e[t+1].getOffset()<i){e.splice(t+1,1);continue}}t++}return e},e.prototype.removeUnwantedMatches=function(e){return this.hashtag||dn(e,(function(e){return"hashtag"===e.getType()})),this.email||dn(e,(function(e){return"email"===e.getType()})),this.phone||dn(e,(function(e){return"phone"===e.getType()})),this.mention||dn(e,(function(e){return"mention"===e.getType()})),this.urls.schemeMatches||dn(e,(function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()})),this.urls.wwwMatches||dn(e,(function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()})),this.urls.tldMatches||dn(e,(function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()})),e},e.prototype.parseText=function(e,t){void 0===t&&(t=0),t=t||0;for(var n=this.getMatchers(),r=[],o=0,i=n.length;o<i;o++){for(var s=n[o].parseMatches(e),a=0,l=s.length;a<l;a++)s[a].setOffset(t+s[a].getOffset());r.push.apply(r,s)}return r},e.prototype.link=function(e){if(!e)return"";this.sanitizeHtml&&(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var t=this.parse(e),n=[],r=0,o=0,i=t.length;o<i;o++){var s=t[o];n.push(e.substring(r,s.getOffset())),n.push(this.createMatchReturnVal(s)),r=s.getOffset()+s.getMatchedText().length}return n.push(e.substring(r)),n.join("")},e.prototype.createMatchReturnVal=function(e){var t;return this.replaceFn&&(t=this.replaceFn.call(this.context,e)),"string"==typeof t?t:!1===t?e.getMatchedText():t instanceof gn?t.toAnchorString():e.buildTag().toAnchorString()},e.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var e=this.getTagBuilder(),t=[new tr({tagBuilder:e,serviceName:this.hashtag}),new Zn({tagBuilder:e}),new or({tagBuilder:e}),new cr({tagBuilder:e,serviceName:this.mention}),new Xn({tagBuilder:e,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=t},e.prototype.getTagBuilder=function(){var e=this.tagBuilder;return e||(e=this.tagBuilder=new mn({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),e},e.version="3.16.2",e.AnchorTagBuilder=mn,e.HtmlTag=gn,e.matcher={Email:Zn,Hashtag:tr,Matcher:Bn,Mention:cr,Phone:or,Url:Xn},e.match={Email:xn,Hashtag:An,Match:yn,Mention:En,Phone:Cn,Url:_n},e}(),pr=/www|@|\:\/\//;function gr(e){return/^<\/a\s*>/i.test(e)}function mr(){var e=[],t=new dr({stripPrefix:!1,url:!0,email:!0,replaceFn:function(t){switch(t.getType()){case"url":e.push({text:t.matchedText,url:t.getUrl()});break;case"email":e.push({text:t.matchedText,url:"mailto:"+t.getEmail().replace(/^mailto:/i,"")})}return!1}});return{links:e,autolinker:t}}function yr(e){var t,n,r,o,i,s,a,l,u,c,h,f,d,p,g=e.tokens,m=null;for(n=0,r=g.length;n<r;n++)if("inline"===g[n].type)for(h=0,t=(o=g[n].children).length-1;t>=0;t--)if("link_close"!==(i=o[t]).type){if("htmltag"===i.type&&(p=i.content,/^<a[>\s]/i.test(p)&&h>0&&h--,gr(i.content)&&h++),!(h>0)&&"text"===i.type&&pr.test(i.content)){if(m||(f=(m=mr()).links,d=m.autolinker),s=i.content,f.length=0,d.link(s),!f.length)continue;for(a=[],c=i.level,l=0;l<f.length;l++)e.inline.validateLink(f[l].url)&&((u=s.indexOf(f[l].text))&&a.push({type:"text",content:s.slice(0,u),level:c}),a.push({type:"link_open",href:f[l].url,title:"",level:c++}),a.push({type:"text",content:f[l].text,level:c}),a.push({type:"link_close",level:--c}),s=s.slice(u+f[l].text.length));s.length&&a.push({type:"text",content:s,level:c}),g[n].children=o=[].concat(o.slice(0,t),a,o.slice(t+1))}}else for(t--;o[t].level!==i.level&&"link_open"!==o[t].type;)t--}function br(e){e.core.ruler.push("linkify",yr)}function vr(e,{delay:t}={}){if("number"!=typeof t&&void 0!==t)throw new TypeError(`Expected \`interval\` to be of type \`number\` but received type \`${typeof t}\``);const n=void 0===t?async()=>{}:(r=t,async()=>new Promise((e=>{setTimeout(e,r)})));var r;let o=[];return t=>{o.push(t),1===o.length&&(async()=>{await n(),e(o),o=[]})()}}const wr=Symbol("store-raw"),kr=Symbol("store-node"),xr=Symbol("store-has"),Ar=Symbol("store-self");function Er(e){let t=e[o];if(!t&&(Object.defineProperty(e,o,{value:t=new Proxy(e,Dr)}),!Array.isArray(e))){const n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let o=0,i=n.length;o<i;o++){const i=n[o];r[i].get&&Object.defineProperty(e,i,{enumerable:r[i].enumerable,get:r[i].get.bind(t)})}}return t}function Cr(e){let t;return null!=e&&"object"==typeof e&&(e[o]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function _r(e,t=new Set){let n,r,o,i;if(n=null!=e&&e[wr])return n;if(!Cr(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let n=0,i=e.length;n<i;n++)o=e[n],(r=_r(o,t))!==o&&(e[n]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const n=Object.keys(e),s=Object.getOwnPropertyDescriptors(e);for(let a=0,l=n.length;a<l;a++)i=n[a],s[i].get||(o=e[i],(r=_r(o,t))!==o&&(e[i]=r))}return e}function Br(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function Sr(e,t,n){if(e[t])return e[t];const[r,o]=w(n,{equals:!1,internal:!0});return r.$=o,e[t]=r}function Fr(e){z()&&Sr(Br(e,kr),Ar)()}function zr(e){return Fr(e),Reflect.ownKeys(e)}const Dr={get(e,t,n){if(t===wr)return e;if(t===o)return n;if(t===i)return Fr(e),n;const r=Br(e,kr),s=r[t];let a=s?s():e[t];if(t===kr||t===xr||"__proto__"===t)return a;if(!s){const n=Object.getOwnPropertyDescriptor(e,t);!z()||"function"==typeof a&&!e.hasOwnProperty(t)||n&&n.get||(a=Sr(r,t,a)())}return Cr(a)?Er(a):a},has:(e,t)=>t===wr||t===o||t===i||t===kr||t===xr||"__proto__"===t||(z()&&Sr(Br(e,xr),t)(),t in e),set:()=>!0,deleteProperty:()=>!0,ownKeys:zr,getOwnPropertyDescriptor:function(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return n&&!n.get&&n.configurable&&t!==o&&t!==kr?(delete n.value,delete n.writable,n.get=()=>e[o][t],n):n}};function Ir(e,t,n,r=!1){if(!r&&e[t]===n)return;const o=e[t],i=e.length;void 0===n?(delete e[t],e[xr]&&e[xr][t]&&void 0!==o&&e[xr][t].$()):(e[t]=n,e[xr]&&e[xr][t]&&void 0===o&&e[xr][t].$());let s,a=Br(e,kr);if((s=Sr(a,t,o))&&s.$((()=>n)),Array.isArray(e)&&e.length!==i){for(let t=e.length;t<i;t++)(s=a[t])&&s.$();(s=Sr(a,"length",i))&&s.$(e.length)}(s=a[Ar])&&s.$()}function Mr(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const o=n[r];Ir(e,o,t[o])}}function Or(e,t,n=[]){let r,o=e;if(t.length>1){r=t.shift();const i=typeof r,s=Array.isArray(e);if(Array.isArray(r)){for(let o=0;o<r.length;o++)Or(e,[r[o]].concat(t),n);return}if(s&&"function"===i){for(let o=0;o<e.length;o++)r(e[o],o)&&Or(e,[o].concat(t),n);return}if(s&&"object"===i){const{from:o=0,to:i=e.length-1,by:s=1}=r;for(let r=o;r<=i;r+=s)Or(e,[r].concat(t),n);return}if(t.length>1)return void Or(e[r],t,[r].concat(n));o=e[r],n=[r].concat(n)}let i=t[0];"function"==typeof i&&(i=i(o,n),i===o)||void 0===r&&null==i||(i=_r(i),void 0===r||Cr(o)&&Cr(i)&&!Array.isArray(i)?Mr(o,i):Ir(e,r,i))}function Tr(...[e,t]){const n=_r(e||{}),r=Array.isArray(n);return[Er(n),function(...e){_((()=>{r&&1===e.length?function(e,t){if("function"==typeof t&&(t=t(e)),t=_r(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){const r=t[n];e[n]!==r&&Ir(e,n,r)}Ir(e,"length",r)}else Mr(e,t)}(n,e[0]):Or(n,e)}))}]}const Pr={get(e,t,n){if(t===wr)return e;if(t===o)return n;if(t===i)return Fr(e),n;const r=Br(e,kr),s=r[t];let a=s?s():e[t];if(t===kr||t===xr||"__proto__"===t)return a;if(!s){const o=Object.getOwnPropertyDescriptor(e,t),i="function"==typeof a;if(!z()||i&&!e.hasOwnProperty(t)||o&&o.get){if(null!=a&&i&&a===Array.prototype[t])return(...e)=>_((()=>Array.prototype[t].apply(n,e)))}else a=Sr(r,t,a)()}return Cr(a)?Rr(a):a},has:(e,t)=>t===wr||t===o||t===i||t===kr||t===xr||"__proto__"===t||(z()&&Sr(Br(e,xr),t)(),t in e),set:(e,t,n)=>(_((()=>Ir(e,t,_r(n)))),!0),deleteProperty:(e,t)=>(_((()=>Ir(e,t,void 0,!0))),!0),ownKeys:zr,getOwnPropertyDescriptor:function(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||n.set||!n.configurable||t===o||t===kr||(delete n.value,delete n.writable,n.get=()=>e[o][t],n.set=n=>e[o][t]=n),n}};function Rr(e){let t=e[o];if(!t){Object.defineProperty(e,o,{value:t=new Proxy(e,Pr)});const n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e),i=Object.getPrototypeOf(e),s=null!==e&&"object"==typeof e&&!Array.isArray(e)&&i!==Object.prototype;if(s){const e=Object.getOwnPropertyDescriptors(i);n.push(...Object.keys(e)),Object.assign(r,e)}for(let o=0,a=n.length;o<a;o++){const i=n[o];if(!s||"constructor"!==i){if(r[i].get){const n=r[i].get.bind(t);Object.defineProperty(e,i,{get:n,configurable:!0})}if(r[i].set){const n=r[i].set,o=e=>_((()=>n.call(t,e)));Object.defineProperty(e,i,{set:o,configurable:!0})}}}}return t}function Lr(e,t){return Rr(_r(e||{}))}const $r=Symbol("store-root");function jr(e,t,n,r,o){const i=t[n];if(e===i)return;const s=Array.isArray(e);if(n!==$r&&(!Cr(e)||!Cr(i)||s!==Array.isArray(i)||o&&e[o]!==i[o]))return void Ir(t,n,e);if(s){if(e.length&&i.length&&(!r||o&&e[0]&&null!=e[0][o])){let t,n,s,a,l,u,c,h;for(s=0,a=Math.min(i.length,e.length);s<a&&(i[s]===e[s]||o&&i[s]&&e[s]&&i[s][o]===e[s][o]);s++)jr(e[s],i,s,r,o);const f=new Array(e.length),d=new Map;for(a=i.length-1,l=e.length-1;a>=s&&l>=s&&(i[a]===e[l]||o&&i[s]&&e[s]&&i[a][o]===e[l][o]);a--,l--)f[l]=i[a];if(s>l||s>a){for(n=s;n<=l;n++)Ir(i,n,e[n]);for(;n<e.length;n++)Ir(i,n,f[n]),jr(e[n],i,n,r,o);return void(i.length>e.length&&Ir(i,"length",e.length))}for(c=new Array(l+1),n=l;n>=s;n--)u=e[n],h=o&&u?u[o]:u,t=d.get(h),c[n]=void 0===t?-1:t,d.set(h,n);for(t=s;t<=a;t++)u=i[t],h=o&&u?u[o]:u,n=d.get(h),void 0!==n&&-1!==n&&(f[n]=i[t],n=c[n],d.set(h,n));for(n=s;n<e.length;n++)n in f?(Ir(i,n,f[n]),jr(e[n],i,n,r,o)):Ir(i,n,e[n])}else for(let t=0,n=e.length;t<n;t++)jr(e[t],i,t,r,o);return void(i.length>e.length&&Ir(i,"length",e.length))}const a=Object.keys(e);for(let u=0,c=a.length;u<c;u++)jr(e[a[u]],i,a[u],r,o);const l=Object.keys(i);for(let u=0,c=l.length;u<c;u++)void 0===e[l[u]]&&Ir(i,l[u],void 0)}function Nr(e,t={}){const{merge:n,key:r="id"}=t,o=_r(e);return e=>{if(!Cr(e)||!Cr(o))return o;const t=jr(o,{[$r]:e},$r,n,r);return void 0===t?e:t}}const qr=new WeakMap,Ur={get(e,t){if(t===wr)return e;const n=e[t];let r;return Cr(n)?qr.get(n)||(qr.set(n,r=new Proxy(n,Ur)),r):n},set:(e,t,n)=>(Ir(e,t,_r(n)),!0),deleteProperty:(e,t)=>(Ir(e,t,void 0,!0),!0)};const Hr=(e,t)=>t.some((t=>e instanceof t));let Vr,Wr;const Kr=new WeakMap,Zr=new WeakMap,Gr=new WeakMap,Jr=new WeakMap,Yr=new WeakMap;let Qr={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Zr.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Gr.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return to(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Xr(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Wr||(Wr=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(no(this),t),to(Kr.get(this))}:function(...t){return to(e.apply(no(this),t))}:function(t,...n){const r=e.call(no(this),t,...n);return Gr.set(r,t.sort?t.sort():[t]),to(r)}}function eo(e){return"function"==typeof e?Xr(e):(e instanceof IDBTransaction&&function(e){if(Zr.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));Zr.set(e,t)}(e),Hr(e,Vr||(Vr=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Qr):e)}function to(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",i)},o=()=>{t(to(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&Kr.set(t,e)})).catch((()=>{})),Yr.set(t,e),t}(e);if(Jr.has(e))return Jr.get(e);const t=eo(e);return t!==e&&(Jr.set(e,t),Yr.set(t,e)),t}const no=e=>Yr.get(e);const ro=["get","getKey","getAll","getAllKeys","count"],oo=["put","add","delete","clear"],io=new Map;function so(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(io.get(t))return io.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=oo.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!ro.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,o?"readwrite":"readonly");let s=i.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),o&&i.done]))[0]};return io.set(t,i),i}function ao(e){const t={reply:void 0,root:void 0,mentions:[],profiles:[]},n=[];for(const r of e.tags)"e"===r[0]&&r[1]&&n.push(r),"p"===r[0]&&r[1]&&t.profiles.push({pubkey:r[1],relays:r[2]?[r[2]]:[]});for(let r=0;r<n.length;r++){const e=n[r],[o,i,s,a]=e,l={id:i,relays:s?[s]:[]},u=0===r,c=r===n.length-1;"root"!==a?"reply"!==a?"mention"!==a?u?t.root=l:c?t.reply=l:t.mentions.push(l):t.mentions.push(l):t.reply=l:t.root=l}return t}Qr=(e=>({...e,get:(t,n,r)=>so(t,n)||e.get(t,n,r),has:(t,n)=>!!so(t,n)||e.has(t,n)}))(Qr);var lo={equals:!1},uo=(t=class{constructor(t=Map){__privateAdd(this,e,void 0),__privateSet(this,e,new t)}dirty(t){var n;null==(n=__privateGet(this,e).get(t))||n.$$()}track(t){if(!z())return;let n=__privateGet(this,e).get(t);if(n)n.n++;else{const[r,o]=w(void 0,lo);__privateGet(this,e).set(t,n={$:r,$$:o,n:1})}F((()=>{1==n.n--&&queueMicrotask((()=>0===n.n&&__privateGet(this,e).delete(t)))})),n.$()}},e=new WeakMap,t),co=Symbol("track-keys"),ho=(r=class extends Set{constructor(e){if(super(),__privateAdd(this,n,new uo),e)for(const t of e)super.add(t)}get size(){return __privateGet(this,n).track(co),super.size}has(e){return __privateGet(this,n).track(e),super.has(e)}*keys(){for(const e of super.keys())__privateGet(this,n).track(e),yield e;__privateGet(this,n).track(co)}values(){return this.keys()}*entries(){for(const e of super.keys())__privateGet(this,n).track(e),yield[e,e];__privateGet(this,n).track(co)}[Symbol.iterator](){return this.values()}forEach(e){__privateGet(this,n).track(co),super.forEach(e)}add(e){return super.has(e)||(super.add(e),_((()=>{__privateGet(this,n).dirty(e),__privateGet(this,n).dirty(co)}))),this}delete(e){const t=super.delete(e);return t&&_((()=>{__privateGet(this,n).dirty(e),__privateGet(this,n).dirty(co)})),t}clear(){super.size&&_((()=>{for(const e of super.keys())__privateGet(this,n).dirty(e);super.clear(),__privateGet(this,n).dirty(co)}))}},n=new WeakMap,r);function fo(e){const[t,n]=w(e);return e=>void 0===e?t():n(e)}function po(e){return e(!e())}const go=Lr({ready:fo(!1),readRelays:[],writeRelays:[],rootEventIds:[],topRootEventIds:new Set,userObservedComments:!1,userStartedReadingComments:!1,commentContexts:new Map,additionalTags:[],maxCommentLength:0,writePowDifficulty:0,minReadPow:0,maxWritePow:0,lists:{eventsBlocked:new Set,pubkeysBlocked:new Set,pubkeysFollowed:new Set,checkUpdates:!0},ranks:new Map,showReportButton:new Set,moderators:new ho,subscribed:fo(!1),filter:{},profiles:()=>[],requestedProfileUpdate:new Set}),mo=Lr({}),yo=["reply","likes","votes","singleVoteCounter","zaps","publish","watch","hideContent","relayInformation","spamNostrBand","followIsApproval"],bo=e=>yo.includes(e),vo="aa,ab,ae,af,ak,am,an,ar,as,av,ay,az,ba,be,bg,bi,bm,bn,bo,br,bs,ca,ce,ch,co,cr,cs,cu,cv,cy,da,de,dv,dz,ee,el,en,eo,es,et,eu,fa,ff,fi,fj,fo,fr,fy,ga,gd,gl,gn,gu,gv,ha,he,hi,ho,hr,ht,hu,hy,hz,ia,id,ie,ig,ii,ik,io,is,it,iu,ja,jv,ka,kg,ki,kj,kk,kl,km,kn,ko,kr,ks,ku,kv,kw,ky,la,lb,lg,li,ln,lo,lt,lu,lv,mg,mh,mi,mk,ml,mn,mr,ms,mt,my,na,nb,nd,ne,ng,nl,nn,no,nr,nv,ny,oc,oj,om,or,os,pa,pi,pl,ps,pt,qu,rm,rn,ro,ru,rw,sa,sc,sd,se,sg,si,sk,sl,sm,sn,so,sq,sr,ss,st,su,sv,sw,ta,te,tg,th,ti,tk,tl,tn,to,tr,ts,tt,tw,ty,ug,uk,ur,uz,ve,vi,vo,wa,wo,xh,yi,yo,za,zh,zu".split(","),wo=e=>vo.includes(e);function ko(e){-1===e.indexOf("://")&&(e="wss://"+e);let t=new URL(e);return t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),("80"===t.port&&"ws:"===t.protocol||"443"===t.port&&"wss:"===t.protocol)&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}new TextDecoder("utf-8"),new TextEncoder;function xo(e,t){if(e.ids&&-1===e.ids.indexOf(t.id))return!1;if(e.kinds&&-1===e.kinds.indexOf(t.kind))return!1;if(e.authors&&-1===e.authors.indexOf(t.pubkey))return!1;for(let n in e)if("#"===n[0]){let r=e[`#${n.slice(1)}`];if(r&&!t.tags.find((([e,t])=>e===n.slice(1)&&-1!==r.indexOf(t))))return!1}return!(e.since&&t.created_at<e.since)&&!(e.until&&t.created_at>e.until)}new TextDecoder("utf-8"),new TextEncoder;var Ao=class{constructor(e){__publicField(this,"value"),__publicField(this,"next",null),__publicField(this,"prev",null),this.value=e}},Eo=class{constructor(){__publicField(this,"first"),__publicField(this,"last"),this.first=null,this.last=null}enqueue(e){const t=new Ao(e);return this.last?this.last===this.first?(this.last=t,this.last.prev=this.first,this.first.next=t):(t.prev=this.last,this.last.next=t,this.last=t):(this.first=t,this.last=t),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const e=this.first;return this.first=null,this.last=null,e.value}const e=this.first;return this.first=e.next,e.value}};async function Co(){return new Promise((e=>{const t=new MessageChannel,n=()=>{t.port1.removeEventListener("message",n),e()};t.port1.addEventListener("message",n),t.port2.postMessage(0),t.port1.start()}))}var _o=class{constructor(e,t){__publicField(this,"url"),__publicField(this,"_connected",!1),__publicField(this,"onclose",null),__publicField(this,"onnotice",(e=>console.debug(`NOTICE from ${this.url}: ${e}`))),__publicField(this,"_onauth",null),__publicField(this,"baseEoseTimeout",4400),__publicField(this,"connectionTimeout",4400),__publicField(this,"openSubs",new Map),__publicField(this,"connectionTimeoutHandle"),__publicField(this,"connectionPromise"),__publicField(this,"openCountRequests",new Map),__publicField(this,"openEventPublishes",new Map),__publicField(this,"ws"),__publicField(this,"incomingMessageQueue",new Eo),__publicField(this,"queueRunning",!1),__publicField(this,"challenge"),__publicField(this,"serial",0),__publicField(this,"verifyEvent"),__publicField(this,"_WebSocket"),this.url=function(e){-1===e.indexOf("://")&&(e="wss://"+e);let t=new URL(e);return t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),("80"===t.port&&"ws:"===t.protocol||"443"===t.port&&"wss:"===t.protocol)&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}(e),this.verifyEvent=t.verifyEvent,this._WebSocket=t.websocketImplementation||WebSocket}static async connect(e,t){const n=new _o(e,t);return await n.connect(),n}closeAllSubscriptions(e){for(let[t,n]of this.openSubs)n.close(e);this.openSubs.clear();for(let[t,n]of this.openEventPublishes)n.reject(new Error(e));this.openEventPublishes.clear();for(let[t,n]of this.openCountRequests)n.reject(new Error(e));this.openCountRequests.clear()}get connected(){return this._connected}async connect(){return this.connectionPromise||(this.challenge=void 0,this.connectionPromise=new Promise(((e,t)=>{this.connectionTimeoutHandle=setTimeout((()=>{var e;t("connection timed out"),this.connectionPromise=void 0,null==(e=this.onclose)||e.call(this),this.closeAllSubscriptions("relay connection timed out")}),this.connectionTimeout);try{this.ws=new this._WebSocket(this.url)}catch(n){return void t(n)}this.ws.onopen=()=>{clearTimeout(this.connectionTimeoutHandle),this._connected=!0,e()},this.ws.onerror=e=>{var n;t(e.message||"websocket error"),this._connected&&(this._connected=!1,this.connectionPromise=void 0,null==(n=this.onclose)||n.call(this),this.closeAllSubscriptions("relay connection errored"))},this.ws.onclose=async()=>{var e;this._connected&&(this._connected=!1,this.connectionPromise=void 0,null==(e=this.onclose)||e.call(this),this.closeAllSubscriptions("relay connection closed"))},this.ws.onmessage=this._onmessage.bind(this)}))),this.connectionPromise}async runQueue(){for(this.queueRunning=!0;!1!==this.handleNext();)await Co();this.queueRunning=!1}handleNext(){var e,t,n;const r=this.incomingMessageQueue.dequeue();if(!r)return!1;const o=function(e){let t=e.slice(0,22).indexOf('"EVENT"');if(-1===t)return null;let n=e.slice(t+7+1).indexOf('"');if(-1===n)return null;let r=t+7+1+n,o=e.slice(r+1,80).indexOf('"');if(-1===o)return null;let i=r+1+o;return e.slice(r+1,i)}(r);if(o){const n=this.openSubs.get(o);if(!n)return;const i=function(e,t){let n=t.length+3,r=e.indexOf(`"${t}":`)+n,o=e.slice(r).indexOf('"')+r+1;return e.slice(o,o+64)}(r,"id"),s=null==(e=n.alreadyHaveEvent)?void 0:e.call(n,i);if(null==(t=n.receivedEvent)||t.call(n,this,i),s)return}try{let e=JSON.parse(r);switch(e[0]){case"EVENT":{const t=this.openSubs.get(e[1]),n=e[2];return void(this.verifyEvent(n)&&function(e,t){for(let n=0;n<e.length;n++)if(xo(e[n],t))return!0;return!1}(t.filters,n)&&t.onevent(n))}case"COUNT":{const t=e[1],n=e[2],r=this.openCountRequests.get(t);return void(r&&(r.resolve(n.count),this.openCountRequests.delete(t)))}case"EOSE":{const t=this.openSubs.get(e[1]);if(!t)return;return void t.receivedEose()}case"OK":{const t=e[1],n=e[2],r=e[3],o=this.openEventPublishes.get(t);return n?o.resolve(r):o.reject(new Error(r)),void this.openEventPublishes.delete(t)}case"CLOSED":{const t=e[1],n=this.openSubs.get(t);if(!n)return;return n.closed=!0,void n.close(e[2])}case"NOTICE":return void this.onnotice(e[1]);case"AUTH":return this.challenge=e[1],void(null==(n=this._onauth)||n.call(this,e[1]))}}catch(i){return}}async send(e){if(!this.connectionPromise)throw new Error("sending on closed connection");this.connectionPromise.then((()=>{var t;null==(t=this.ws)||t.send(e)}))}async auth(e){if(!this.challenge)throw new Error("can't perform auth, no challenge was received");const t=await e((n=this.url,r=this.challenge,{kind:22242,created_at:Math.floor(Date.now()/1e3),tags:[["relay",n],["challenge",r]],content:""}));var n,r;const o=new Promise(((e,n)=>{this.openEventPublishes.set(t.id,{resolve:e,reject:n})}));return this.send('["AUTH",'+JSON.stringify(t)+"]"),o}async publish(e){const t=new Promise(((t,n)=>{this.openEventPublishes.set(e.id,{resolve:t,reject:n})}));return this.send('["EVENT",'+JSON.stringify(e)+"]"),t}async count(e,t){this.serial++;const n=(null==t?void 0:t.id)||"count:"+this.serial,r=new Promise(((e,t)=>{this.openCountRequests.set(n,{resolve:e,reject:t})}));return this.send('["COUNT","'+n+'",'+JSON.stringify(e).substring(1)),r}subscribe(e,t){const n=this.prepareSubscription(e,t);return n.fire(),n}prepareSubscription(e,t){this.serial++;const n=t.id||"sub:"+this.serial,r=new Bo(this,n,e,t);return this.openSubs.set(n,r),r}close(){var e;this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,null==(e=this.ws)||e.close()}_onmessage(e){this.incomingMessageQueue.enqueue(e.data),this.queueRunning||this.runQueue()}},Bo=class{constructor(e,t,n,r){__publicField(this,"relay"),__publicField(this,"id"),__publicField(this,"closed",!1),__publicField(this,"eosed",!1),__publicField(this,"filters"),__publicField(this,"alreadyHaveEvent"),__publicField(this,"receivedEvent"),__publicField(this,"onevent"),__publicField(this,"oneose"),__publicField(this,"onclose"),__publicField(this,"eoseTimeout"),__publicField(this,"eoseTimeoutHandle"),this.relay=e,this.filters=n,this.id=t,this.alreadyHaveEvent=r.alreadyHaveEvent,this.receivedEvent=r.receivedEvent,this.eoseTimeout=r.eoseTimeout||e.baseEoseTimeout,this.oneose=r.oneose,this.onclose=r.onclose,this.onevent=r.onevent||(e=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,e)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){var e;this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,null==(e=this.oneose)||e.call(this))}close(e="closed by caller"){var t;!this.closed&&this.relay.connected&&(this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]"),this.closed=!0),this.relay.openSubs.delete(this.id),null==(t=this.onclose)||t.call(this,e)}};function So(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Fo(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function zo(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}const Do="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,Io=e=>e instanceof Uint8Array,Mo=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Oo=(e,t)=>e<<32-t|e>>>t;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function To(e){if("string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),!Io(e))throw new Error("expected Uint8Array, got "+typeof e);return e}class Po{clone(){return this._cloneInto()}}function Ro(e){const t=t=>e().update(To(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Lo(e=32){if(Do&&"function"==typeof Do.getRandomValues)return Do.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}let $o=class extends Po{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Mo(this.buffer)}update(e){zo(this);const{view:t,buffer:n,blockLen:r}=this,o=(e=To(e)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=Mo(e);for(;r<=o-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){zo(this),function(e,t){Fo(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let c=i;c<r;c++)t[c]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),l=r?4:0,u=r?0:4;e.setUint32(t+l,s,r),e.setUint32(t+u,a,r)}(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=Mo(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=a/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let c=0;c<l;c++)s.setUint32(4*c,u[c],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return e.length=r,e.pos=s,e.finished=o,e.destroyed=i,r%t&&e.buffer.set(n),e}};const jo=(e,t,n)=>e&t^e&n^t&n,No=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qo=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Uo=new Uint32Array(64);let Ho=class extends $o{constructor(){super(64,32,8,!1),this.A=0|qo[0],this.B=0|qo[1],this.C=0|qo[2],this.D=0|qo[3],this.E=0|qo[4],this.F=0|qo[5],this.G=0|qo[6],this.H=0|qo[7]}get(){const{A:e,B:t,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[e,t,n,r,o,i,s,a]}set(e,t,n,r,o,i,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(e,t){for(let h=0;h<16;h++,t+=4)Uo[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const e=Uo[h-15],t=Uo[h-2],n=Oo(e,7)^Oo(e,18)^e>>>3,r=Oo(t,17)^Oo(t,19)^t>>>10;Uo[h]=r+Uo[h-7]+n+Uo[h-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:l,H:u}=this;for(let h=0;h<64;h++){const e=u+(Oo(s,6)^Oo(s,11)^Oo(s,25))+((c=s)&a^~c&l)+No[h]+Uo[h]|0,t=(Oo(n,2)^Oo(n,13)^Oo(n,22))+jo(n,r,o)|0;u=l,l=a,a=s,s=i+e|0,i=o,o=r,r=n,n=e+t|0}var c;n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,l,u)}roundClean(){Uo.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Vo=Ro((()=>new Ho)),Wo=BigInt(0),Ko=BigInt(1),Zo=BigInt(2),Go=e=>e instanceof Uint8Array,Jo=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Yo(e){if(!Go(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=Jo[e[n]];return t}function Qo(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function Xo(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":`0x${e}`)}function ei(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){const t=2*r,o=e.slice(t,t+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n}function ti(e){return Xo(Yo(e))}function ni(e){if(!Go(e))throw new Error("Uint8Array expected");return Xo(Yo(Uint8Array.from(e).reverse()))}function ri(e,t){return ei(e.toString(16).padStart(2*t,"0"))}function oi(e,t){return ri(e,t).reverse()}function ii(e,t,n){let r;if("string"==typeof t)try{r=ei(t)}catch(i){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${i}`)}else{if(!Go(t))throw new Error(`${e} must be hex string or Uint8Array`);r=Uint8Array.from(t)}const o=r.length;if("number"==typeof n&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function si(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let n=0;return e.forEach((e=>{if(!Go(e))throw new Error("Uint8Array expected");t.set(e,n),n+=e.length})),t}const ai=e=>(Zo<<BigInt(e-1))-Ko,li=e=>new Uint8Array(e),ui=e=>Uint8Array.from(e);function ci(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=li(e),o=li(e),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},a=(...e)=>n(o,r,...e),l=(e=li())=>{o=a(ui([0]),e),r=a(),0!==e.length&&(o=a(ui([1]),e),r=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=a();const t=r.slice();n.push(t),e+=r.length}return si(...n)};return(e,t)=>{let n;for(s(),l(e);!(n=t(u()));)l();return s(),n}}const hi={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function fi(e,t,n={}){const r=(t,n,r)=>{const o=hi[n];if("function"!=typeof o)throw new Error(`Invalid validator "${n}", expected function`);const i=e[t];if(!(r&&void 0===i||o(i,e)))throw new Error(`Invalid param ${String(t)}=${i} (${typeof i}), expected ${n}`)};for(const[o,i]of Object.entries(t))r(o,i,!1);for(const[o,i]of Object.entries(n))r(o,i,!0);return e}const di=Object.freeze(Object.defineProperty({__proto__:null,bitGet:function(e,t){return e>>BigInt(t)&Ko},bitLen:function(e){let t;for(t=0;e>Wo;e>>=Ko,t+=1);return t},bitMask:ai,bitSet:(e,t,n)=>e|(n?Ko:Wo)<<BigInt(t),bytesToHex:Yo,bytesToNumberBE:ti,bytesToNumberLE:ni,concatBytes:si,createHmacDrbg:ci,ensureBytes:ii,equalBytes:function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},hexToBytes:ei,hexToNumber:Xo,numberToBytesBE:ri,numberToBytesLE:oi,numberToHexUnpadded:Qo,numberToVarBytesBE:function(e){return ei(Qo(e))},utf8ToBytes:function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))},validateObject:fi},Symbol.toStringTag,{value:"Module"})),pi=BigInt(0),gi=BigInt(1),mi=BigInt(2),yi=BigInt(3),bi=BigInt(4),vi=BigInt(5),wi=BigInt(8);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ki(e,t){const n=e%t;return n>=pi?n:t+n}function xi(e,t,n){if(n<=pi||t<pi)throw new Error("Expected power/modulo > 0");if(n===gi)return pi;let r=gi;for(;t>pi;)t&gi&&(r=r*e%n),e=e*e%n,t>>=gi;return r}function Ai(e,t,n){let r=e;for(;t-- >pi;)r*=r,r%=n;return r}function Ei(e,t){if(e===pi||t<=pi)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=ki(e,t),r=t,o=pi,i=gi;for(;n!==pi;){const e=r%n,t=o-i*(r/n);r=n,n=e,o=i,i=t}if(r!==gi)throw new Error("invert: does not exist");return ki(o,t)}function Ci(e){if(e%bi===yi){const t=(e+gi)/bi;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%wi===vi){const t=(e-vi)/wi;return function(e,n){const r=e.mul(n,mi),o=e.pow(r,t),i=e.mul(n,o),s=e.mul(e.mul(i,mi),o),a=e.mul(i,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),n))throw new Error("Cannot find square root");return a}}return function(e){const t=(e-gi)/mi;let n,r,o;for(n=e-gi,r=0;n%mi===pi;n/=mi,r++);for(o=mi;o<e&&xi(o,t,e)!==e-gi;o++);if(1===r){const t=(e+gi)/bi;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}const i=(n+gi)/mi;return function(e,s){if(e.pow(s,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=r,l=e.pow(e.mul(e.ONE,o),n),u=e.pow(s,i),c=e.pow(s,n);for(;!e.eql(c,e.ONE);){if(e.eql(c,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(c);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);const n=e.pow(l,gi<<BigInt(a-t-1));l=e.sqr(n),u=e.mul(u,n),c=e.mul(c,l),a=t}return u}}(e)}BigInt(9),BigInt(16);const _i=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Bi(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function Si(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Fi(e){const t=Si(e);return t+Math.ceil(t/2)}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const zi=BigInt(0),Di=BigInt(1);function Ii(e){return fi(e.Fp,_i.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),fi(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Bi(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const{bytesToNumberBE:Mi,hexToBytes:Oi}=di,Ti={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(e){const{Err:t}=Ti;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");const n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(128&r[0])throw new t("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:Mi(r),l:e.subarray(n+2)}},toSig(e){const{Err:t}=Ti,n="string"==typeof e?Oi(e):e;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||48!=n[0])throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:o,l:i}=Ti._parseInt(n.subarray(2)),{d:s,l:a}=Ti._parseInt(i);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:s}},hexFromSig(e){const t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,n=e=>{const t=e.toString(16);return 1&t.length?`0${t}`:t},r=t(n(e.s)),o=t(n(e.r)),i=r.length/2,s=o.length/2,a=n(i),l=n(s);return`30${n(s+i+4)}02${l}${o}02${a}${r}`}},Pi=BigInt(0),Ri=BigInt(1);BigInt(2);const Li=BigInt(3);function $i(e){const t=function(e){const t=Ii(e);fi(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:n}=t,r=t.toBytes||((e,t,r)=>{const o=t.toAffine();return si(Uint8Array.from([4]),n.toBytes(o.x),n.toBytes(o.y))}),o=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function i(e){const{a:r,b:o}=t,i=n.sqr(e),s=n.mul(i,e);return n.add(n.add(s,n.mul(e,r)),o)}if(!n.eql(n.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function s(e){return"bigint"==typeof e&&Pi<e&&e<t.n}function a(e){if(!s(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:o,n:i}=t;if(n&&"bigint"!=typeof e){if(e instanceof Uint8Array&&(e=Yo(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*r,"0")}let s;try{s="bigint"==typeof e?e:ti(ii("private key",e,r))}catch(l){throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof e}`)}return o&&(s=ki(s,i)),a(s),s}const u=new Map;function c(e){if(!(e instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof h)throw new Error("projective point not allowed");const o=e=>n.eql(e,n.ZERO);return o(t)&&o(r)?h.ZERO:new h(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(h.fromAffine)}static fromHex(e){const t=h.fromAffine(o(ii("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return h.BASE.multiply(l(e))}_setWindowSize(e){this._WINDOW_SIZE=e,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:e,y:r}=this.toAffine();if(!n.isValid(e)||!n.isValid(r))throw new Error("bad point: x or y not FE");const o=n.sqr(r),s=i(e);if(!n.eql(o,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){c(e);const{px:t,py:r,pz:o}=this,{px:i,py:s,pz:a}=e,l=n.eql(n.mul(t,a),n.mul(i,o)),u=n.eql(n.mul(r,a),n.mul(s,o));return l&&u}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,o=n.mul(r,Li),{px:i,py:s,pz:a}=this;let l=n.ZERO,u=n.ZERO,c=n.ZERO,f=n.mul(i,i),d=n.mul(s,s),p=n.mul(a,a),g=n.mul(i,s);return g=n.add(g,g),c=n.mul(i,a),c=n.add(c,c),l=n.mul(e,c),u=n.mul(o,p),u=n.add(l,u),l=n.sub(d,u),u=n.add(d,u),u=n.mul(l,u),l=n.mul(g,l),c=n.mul(o,c),p=n.mul(e,p),g=n.sub(f,p),g=n.mul(e,g),g=n.add(g,c),c=n.add(f,f),f=n.add(c,f),f=n.add(f,p),f=n.mul(f,g),u=n.add(u,f),p=n.mul(s,a),p=n.add(p,p),f=n.mul(p,g),l=n.sub(l,f),c=n.mul(p,d),c=n.add(c,c),c=n.add(c,c),new h(l,u,c)}add(e){c(e);const{px:r,py:o,pz:i}=this,{px:s,py:a,pz:l}=e;let u=n.ZERO,f=n.ZERO,d=n.ZERO;const p=t.a,g=n.mul(t.b,Li);let m=n.mul(r,s),y=n.mul(o,a),b=n.mul(i,l),v=n.add(r,o),w=n.add(s,a);v=n.mul(v,w),w=n.add(m,y),v=n.sub(v,w),w=n.add(r,i);let k=n.add(s,l);return w=n.mul(w,k),k=n.add(m,b),w=n.sub(w,k),k=n.add(o,i),u=n.add(a,l),k=n.mul(k,u),u=n.add(y,b),k=n.sub(k,u),d=n.mul(p,w),u=n.mul(g,b),d=n.add(u,d),u=n.sub(y,d),d=n.add(y,d),f=n.mul(u,d),y=n.add(m,m),y=n.add(y,m),b=n.mul(p,b),w=n.mul(g,w),y=n.add(y,b),b=n.sub(m,b),b=n.mul(p,b),w=n.add(w,b),m=n.mul(y,w),f=n.add(f,m),m=n.mul(k,w),u=n.mul(v,u),u=n.sub(u,m),m=n.mul(v,y),d=n.mul(k,d),d=n.add(d,m),new h(u,f,d)}subtract(e){return this.add(e.negate())}is0(){return this.equals(h.ZERO)}wNAF(e){return d.wNAFCached(this,u,e,(e=>{const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(h.fromAffine)}))}multiplyUnsafe(e){const r=h.ZERO;if(e===Pi)return r;if(a(e),e===Ri)return this;const{endo:o}=t;if(!o)return d.unsafeLadder(this,e);let{k1neg:i,k1:s,k2neg:l,k2:u}=o.splitScalar(e),c=r,f=r,p=this;for(;s>Pi||u>Pi;)s&Ri&&(c=c.add(p)),u&Ri&&(f=f.add(p)),p=p.double(),s>>=Ri,u>>=Ri;return i&&(c=c.negate()),l&&(f=f.negate()),f=new h(n.mul(f.px,o.beta),f.py,f.pz),c.add(f)}multiply(e){a(e);let r,o,i=e;const{endo:s}=t;if(s){const{k1neg:e,k1:t,k2neg:a,k2:l}=s.splitScalar(i);let{p:u,f:c}=this.wNAF(t),{p:f,f:p}=this.wNAF(l);u=d.constTimeNegate(e,u),f=d.constTimeNegate(a,f),f=new h(n.mul(f.px,s.beta),f.py,f.pz),r=u.add(f),o=c.add(p)}else{const{p:e,f:t}=this.wNAF(i);r=e,o=t}return h.normalizeZ([r,o])[0]}multiplyAndAddUnsafe(e,t,n){const r=h.BASE,o=(e,t)=>t!==Pi&&t!==Ri&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),i=o(this,t).add(o(e,n));return i.is0()?void 0:i}toAffine(e){const{px:t,py:r,pz:o}=this,i=this.is0();null==e&&(e=i?n.ONE:n.inv(o));const s=n.mul(t,e),a=n.mul(r,e),l=n.mul(o,e);if(i)return{x:n.ZERO,y:n.ZERO};if(!n.eql(l,n.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===Ri)return!0;if(n)return n(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===Ri?this:n?n(h,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return this.assertValidity(),r(h,this,e)}toHex(e=!0){return Yo(this.toRawBytes(e))}}h.BASE=new h(t.Gx,t.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const f=t.nBitLength,d=function(e,t){const n=(e,t)=>{const n=t.negate();return e?n:t},r=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:n,unsafeLadder(t,n){let r=e.ZERO,o=t;for(;n>zi;)n&Di&&(r=r.add(o)),o=o.double(),n>>=Di;return r},precomputeWindow(e,t){const{windows:n,windowSize:o}=r(t),i=[];let s=e,a=s;for(let r=0;r<n;r++){a=s,i.push(a);for(let e=1;e<o;e++)a=a.add(s),i.push(a);s=a.double()}return i},wNAF(t,o,i){const{windows:s,windowSize:a}=r(t);let l=e.ZERO,u=e.BASE;const c=BigInt(2**t-1),h=2**t,f=BigInt(t);for(let e=0;e<s;e++){const t=e*a;let r=Number(i&c);i>>=f,r>a&&(r-=h,i+=Di);const s=t,d=t+Math.abs(r)-1,p=e%2!=0,g=r<0;0===r?u=u.add(n(p,o[s])):l=l.add(n(g,o[d]))}return{p:l,f:u}},wNAFCached(e,t,n,r){const o=e._WINDOW_SIZE||1;let i=t.get(e);return i||(i=this.precomputeWindow(e,o),1!==o&&t.set(e,r(i))),this.wNAF(o,i,n)}}}(h,t.endo?Math.ceil(f/2):f);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:l,weierstrassEquation:i,isWithinCurveOrder:s}}function ji(e){const t=function(e){const t=Ii(e);return fi(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:n,n:r}=t,o=n.BYTES+1,i=2*n.BYTES+1;function s(e){return ki(e,r)}function a(e){return Ei(e,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:c,isWithinCurveOrder:h}=$i({...t,toBytes(e,t,r){const o=t.toAffine(),i=n.toBytes(o.x),s=si;return r?s(Uint8Array.from([t.hasEvenY()?2:3]),i):s(Uint8Array.from([4]),i,n.toBytes(o.y))},fromBytes(e){const t=e.length,r=e[0],s=e.subarray(1);if(t!==o||2!==r&&3!==r){if(t===i&&4===r){return{x:n.fromBytes(s.subarray(0,n.BYTES)),y:n.fromBytes(s.subarray(n.BYTES,2*n.BYTES))}}throw new Error(`Point of length ${t} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}{const e=ti(s);if(!(Pi<(a=e)&&a<n.ORDER))throw new Error("Point is not on curve");const t=c(e);let o=n.sqrt(t);return!(1&~r)!==((o&Ri)===Ri)&&(o=n.neg(o)),{x:e,y:o}}var a}}),f=e=>Yo(ri(e,t.nByteLength));function d(e){return e>r>>Ri}const p=(e,t,n)=>ti(e.slice(t,n));class g{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=ii("compactSignature",e,2*n),new g(p(e,0,n),p(e,n,2*n))}static fromDER(e){const{r:t,s:n}=Ti.toSig(ii("DER",e));return new g(t,n)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new g(this.r,this.s,e)}recoverPublicKey(e){const{r:r,s:o,recovery:i}=this,u=v(ii("msgHash",e));if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");const c=2===i||3===i?r+t.n:r;if(c>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=1&i?"03":"02",d=l.fromHex(h+f(c)),p=a(c),g=s(-u*p),m=s(o*p),y=l.BASE.multiplyAndAddUnsafe(d,g,m);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return ei(this.toDERHex())}toDERHex(){return Ti.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ei(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const m={isValidPrivateKey(e){try{return u(e),!0}catch(t){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const e=Fi(t.n);return function(e,t,n=!1){const r=e.length,o=Si(t),i=Fi(t);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const s=ki(n?ti(e):ni(e),t-gi)+gi;return n?oi(s,o):ri(s,o)}(t.randomBytes(e),t.n)},precompute:(e=8,t=l.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function y(e){const t=e instanceof Uint8Array,n="string"==typeof e,r=(t||n)&&e.length;return t?r===o||r===i:n?r===2*o||r===2*i:e instanceof l}const b=t.bits2int||function(e){const n=ti(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},v=t.bits2int_modN||function(e){return s(b(e))},w=ai(t.nBitLength);function k(e){if("bigint"!=typeof e)throw new Error("bigint expected");if(!(Pi<=e&&e<w))throw new Error(`bigint expected < 2^${t.nBitLength}`);return ri(e,t.nByteLength)}function x(e,r,o=A){if(["recovered","canonical"].some((e=>e in o)))throw new Error("sign() legacy options not supported");const{hash:i,randomBytes:c}=t;let{lowS:f,prehash:p,extraEntropy:m}=o;null==f&&(f=!0),e=ii("msgHash",e),p&&(e=ii("prehashed msgHash",i(e)));const y=v(e),w=u(r),x=[k(w),k(y)];if(null!=m){const e=!0===m?c(n.BYTES):m;x.push(ii("extraEntropy",e))}const E=si(...x),C=y;return{seed:E,k2sig:function(e){const t=b(e);if(!h(t))return;const n=a(t),r=l.BASE.multiply(t).toAffine(),o=s(r.x);if(o===Pi)return;const i=s(n*s(C+o*w));if(i===Pi)return;let u=(r.x===o?0:2)|Number(r.y&Ri),c=i;return f&&d(i)&&(c=function(e){return d(e)?s(-e):e}(i),u^=1),new g(o,c,u)}}}const A={lowS:t.lowS,prehash:!1},E={lowS:t.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return l.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,n=!0){if(y(e))throw new Error("first arg must be private key");if(!y(t))throw new Error("second arg must be public key");return l.fromHex(t).multiply(u(e)).toRawBytes(n)},sign:function(e,n,r=A){const{seed:o,k2sig:i}=x(e,n,r),s=t;return ci(s.hash.outputLen,s.nByteLength,s.hmac)(o,i)},verify:function(e,n,r,o=E){var i;const u=e;if(n=ii("msgHash",n),r=ii("publicKey",r),"strict"in o)throw new Error("options.strict was renamed to lowS");const{lowS:c,prehash:h}=o;let f,d;try{if("string"==typeof u||u instanceof Uint8Array)try{f=g.fromDER(u)}catch(A){if(!(A instanceof Ti.Err))throw A;f=g.fromCompact(u)}else{if("object"!=typeof u||"bigint"!=typeof u.r||"bigint"!=typeof u.s)throw new Error("PARSE");{const{r:e,s:t}=u;f=new g(e,t)}}d=l.fromHex(r)}catch(C){if("PARSE"===C.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(c&&f.hasHighS())return!1;h&&(n=t.hash(n));const{r:p,s:m}=f,y=v(n),b=a(m),w=s(y*b),k=s(p*b),x=null==(i=l.BASE.multiplyAndAddUnsafe(d,w,k))?void 0:i.toAffine();return!!x&&s(x.x)===p},ProjectivePoint:l,Signature:g,utils:m}}BigInt(4);class Ni extends Po{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");So(e.outputLen),So(e.blockLen)}(e);const n=To(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?e.create().update(n).digest():n);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=e.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),o.fill(0)}update(e){return zo(this),this.iHash.update(e),this}digestInto(e){zo(this),Fo(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return e.finished=r,e.destroyed=o,e.blockLen=i,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const qi=(e,t,n)=>new Ni(e,t).update(n).digest();
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function Ui(e){return{hash:e,hmac:(t,...n)=>qi(e,t,function(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let n=0;return e.forEach((e=>{if(!Io(e))throw new Error("Uint8Array expected");t.set(e,n),n+=e.length})),t}(...n)),randomBytes:Lo}}qi.create=(e,t)=>new Ni(e,t);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const Hi=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Vi=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Wi=BigInt(1),Ki=BigInt(2),Zi=(e,t)=>(e+t/Ki)/t;function Gi(e){const t=Hi,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),l=BigInt(88),u=e*e*e%t,c=u*u*e%t,h=Ai(c,n,t)*c%t,f=Ai(h,n,t)*c%t,d=Ai(f,Ki,t)*u%t,p=Ai(d,o,t)*d%t,g=Ai(p,i,t)*p%t,m=Ai(g,a,t)*g%t,y=Ai(m,l,t)*m%t,b=Ai(y,a,t)*g%t,v=Ai(b,n,t)*c%t,w=Ai(v,s,t)*p%t,k=Ai(w,r,t)*u%t,x=Ai(k,Ki,t);if(!Ji.eql(Ji.sqr(x),e))throw new Error("Cannot find square root");return x}const Ji=function(e,t,n=!1,r={}){if(e<=pi)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:o,nByteLength:i}=Bi(e,t);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=Ci(e),a=Object.freeze({ORDER:e,BITS:o,BYTES:i,MASK:ai(o),ZERO:pi,ONE:gi,create:t=>ki(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("Invalid field element: expected bigint, got "+typeof t);return pi<=t&&t<e},is0:e=>e===pi,isOdd:e=>(e&gi)===gi,neg:t=>ki(-t,e),eql:(e,t)=>e===t,sqr:t=>ki(t*t,e),add:(t,n)=>ki(t+n,e),sub:(t,n)=>ki(t-n,e),mul:(t,n)=>ki(t*n,e),pow:(e,t)=>function(e,t,n){if(n<pi)throw new Error("Expected power > 0");if(n===pi)return e.ONE;if(n===gi)return t;let r=e.ONE,o=t;for(;n>pi;)n&gi&&(r=e.mul(r,o)),o=e.sqr(o),n>>=gi;return r}(a,e,t),div:(t,n)=>ki(t*Ei(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>Ei(t,e),sqrt:r.sqrt||(e=>s(a,e)),invertBatch:e=>function(e,t){const n=new Array(t.length),r=t.reduce(((t,r,o)=>e.is0(r)?t:(n[o]=t,e.mul(t,r))),e.ONE),o=e.inv(r);return t.reduceRight(((t,r,o)=>e.is0(r)?t:(n[o]=e.mul(t,n[o]),e.mul(t,r))),o),n}(a,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?oi(e,i):ri(e,i),fromBytes:e=>{if(e.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${e.length}`);return n?ni(e):ti(e)}});return Object.freeze(a)}(Hi,void 0,void 0,{sqrt:Gi}),Yi=function(e,t){const n=t=>ji({...e,...Ui(t)});return Object.freeze({...n(t),create:n})}({a:BigInt(0),b:BigInt(7),Fp:Ji,n:Vi,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=Vi,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Wi*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),a=Zi(i*e,t),l=Zi(-r*e,t);let u=ki(e-a*n-l*o,t),c=ki(-a*r-l*i,t);const h=u>s,f=c>s;if(h&&(u=t-u),f&&(c=t-c),u>s||c>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:u,k2neg:f,k2:c}}}},Vo),Qi=BigInt(0),Xi=e=>"bigint"==typeof e&&Qi<e&&e<Hi,es=e=>"bigint"==typeof e&&Qi<e&&e<Vi,ts={};function ns(e,...t){let n=ts[e];if(void 0===n){const t=Vo(Uint8Array.from(e,(e=>e.charCodeAt(0))));n=si(t,t),ts[e]=n}return Vo(si(n,...t))}const rs=e=>e.toRawBytes(!0).slice(1),os=e=>ri(e,32),is=e=>ki(e,Hi),ss=e=>ki(e,Vi),as=Yi.ProjectivePoint,ls=(e,t,n)=>as.BASE.multiplyAndAddUnsafe(e,t,n);function us(e){let t=Yi.utils.normPrivateKeyToScalar(e),n=as.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:ss(-t),bytes:rs(n)}}function cs(e){if(!Xi(e))throw new Error("bad x: need 0 < x < p");const t=is(e*e);let n=Gi(is(t*e+BigInt(7)));n%Ki!==Qi&&(n=is(-n));const r=new as(e,n,Wi);return r.assertValidity(),r}function hs(...e){return ss(ti(ns("BIP0340/challenge",...e)))}function fs(e){return us(e).bytes}function ds(e,t,n=Lo(32)){const r=ii("message",e),{bytes:o,scalar:i}=us(t),s=ii("auxRand",n,32),a=os(i^ti(ns("BIP0340/aux",s))),l=ns("BIP0340/nonce",a,o,r),u=ss(ti(l));if(u===Qi)throw new Error("sign failed: k is zero");const{bytes:c,scalar:h}=us(u),f=hs(c,o,r),d=new Uint8Array(64);if(d.set(c,0),d.set(os(ss(h+f*i)),32),!ps(d,r,o))throw new Error("sign: Invalid signature produced");return d}function ps(e,t,n){const r=ii("signature",e,64),o=ii("message",t),i=ii("publicKey",n,32);try{const e=cs(ti(i)),t=ti(r.subarray(0,32));if(!Xi(t))return!1;const n=ti(r.subarray(32,64));if(!es(n))return!1;const s=hs(os(t),rs(e),o),a=ls(e,n,ss(-s));return!(!a||!a.hasEvenY()||a.toAffine().x!==t)}catch(s){return!1}}const gs=(()=>({getPublicKey:fs,sign:ds,verify:ps,utils:{randomPrivateKey:Yi.utils.randomPrivateKey,lift_x:cs,pointToBytes:rs,numberToBytesBE:ri,bytesToNumberBE:ti,taggedHash:ns,mod:ki}}))();function ms(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function ys(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}const bs={number:ms,bool:function(e){if("boolean"!=typeof e)throw new Error(`Expected boolean, not ${e}`)},bytes:ys,hash:function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");ms(e.outputLen),ms(e.blockLen)},exists:function(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")},output:function(e,t){ys(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}};class vs extends ke{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ge(this.buffer)}update(e){bs.exists(this);const{view:t,buffer:n,blockLen:r}=this,o=(e=we(e)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=ge(e);for(;r<=o-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){bs.exists(this),bs.output(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let c=i;c<r;c++)t[c]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),l=r?4:0,u=r?0:4;e.setUint32(t+l,s,r),e.setUint32(t+u,a,r)}(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=ge(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=a/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let c=0;c<l;c++)s.setUint32(4*c,u[c],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return e.length=r,e.pos=s,e.finished=o,e.destroyed=i,r%t&&e.buffer.set(n),e}}const ws=(e,t,n)=>e&t^e&n^t&n,ks=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),xs=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),As=new Uint32Array(64);class Es extends vs{constructor(){super(64,32,8,!1),this.A=0|xs[0],this.B=0|xs[1],this.C=0|xs[2],this.D=0|xs[3],this.E=0|xs[4],this.F=0|xs[5],this.G=0|xs[6],this.H=0|xs[7]}get(){const{A:e,B:t,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[e,t,n,r,o,i,s,a]}set(e,t,n,r,o,i,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(e,t){for(let h=0;h<16;h++,t+=4)As[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const e=As[h-15],t=As[h-2],n=me(e,7)^me(e,18)^e>>>3,r=me(t,17)^me(t,19)^t>>>10;As[h]=r+As[h-7]+n+As[h-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:l,H:u}=this;for(let h=0;h<64;h++){const e=u+(me(s,6)^me(s,11)^me(s,25))+((c=s)&a^~c&l)+ks[h]+As[h]|0,t=(me(n,2)^me(n,13)^me(n,22))+ws(n,r,o)|0;u=l,l=a,a=s,s=i+e|0,i=o,o=r,r=n,n=e+t|0}var c;n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,l,u)}roundClean(){As.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Cs extends Es{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const _s=xe((()=>new Es));xe((()=>new Cs));var Bs=Symbol("verified"),Ss=e=>e instanceof Object;new TextDecoder("utf-8");var Fs=new TextEncoder;function zs(e){if(!function(e){if(!Ss(e))return!1;if("number"!=typeof e.kind)return!1;if("string"!=typeof e.content)return!1;if("number"!=typeof e.created_at)return!1;if("string"!=typeof e.pubkey)return!1;if(!e.pubkey.match(/^[a-f0-9]{64}$/))return!1;if(!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let e=0;e<n.length;e++)if("object"==typeof n[e])return!1}return!0}(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function Ds(e){return be(_s(Fs.encode(zs(e))))}var Is=new class{generateSecretKey(){return gs.utils.randomPrivateKey()}getPublicKey(e){return be(gs.getPublicKey(e))}finalizeEvent(e,t){const n=e;return n.pubkey=be(gs.getPublicKey(t)),n.id=Ds(n),n.sig=be(gs.sign(Ds(n),t)),n[Bs]=!0,n}verifyEvent(e){if("boolean"==typeof e[Bs])return e[Bs];const t=Ds(e);if(t!==e.id)return e[Bs]=!1,!1;try{const n=gs.verify(e.sig,t,e.pubkey);return e[Bs]=n,n}catch(n){return e[Bs]=!1,!1}}};Is.generateSecretKey,Is.getPublicKey,Is.finalizeEvent;var Ms=Is.verifyEvent,Os=Symbol("verified"),Ts=e=>e instanceof Object;new TextDecoder("utf-8");var Ps=new TextEncoder;function Rs(e){if(!function(e){if(!Ts(e))return!1;if("number"!=typeof e.kind)return!1;if("string"!=typeof e.content)return!1;if("number"!=typeof e.created_at)return!1;if("string"!=typeof e.pubkey)return!1;if(!e.pubkey.match(/^[a-f0-9]{64}$/))return!1;if(!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let e=0;e<n.length;e++)if("object"==typeof n[e])return!1}return!0}(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function Ls(e){return be(_s(Ps.encode(Rs(e))))}var $s=new class{generateSecretKey(){return gs.utils.randomPrivateKey()}getPublicKey(e){return be(gs.getPublicKey(e))}finalizeEvent(e,t){const n=e;return n.pubkey=be(gs.getPublicKey(t)),n.id=Ls(n),n.sig=be(gs.sign(Ls(n),t)),n[Os]=!0,n}verifyEvent(e){if("boolean"==typeof e[Os])return e[Os];const t=Ls(e);if(t!==e.id)return e[Os]=!1,!1;try{const n=gs.verify(e.sig,t,e.pubkey);return e[Os]=n,n}catch(n){return e[Os]=!1,!1}}};function js(e){let t=0;for(let n=0;n<e.length;n++){const r=parseInt(e[n],16);if(0!==r){t+=Math.clz32(r)-28;break}t+=4}return t}function Ns(e){const t=e.length;if(0===t)return 0;const n=e.toSorted(((e,t)=>e-t)),r=Math.floor(t/2);return t%2==0?Math.floor((n[r-1]+n[r])/2):n[r]}function qs(e,t){if(0===e.length)return;const n=function(e){if(0===e.length)return;let t=0,n=e[0];for(let r=1;r<e.length;r++)e[r]>n&&(n=e[r],t=r);return t}(e.map(t));return e[n]}$s.generateSecretKey,$s.getPublicKey,$s.finalizeEvent,$s.verifyEvent;const Us=86400,Hs=604800,Vs=()=>Math.round(Date.now()/1e3),Ws=(e,t=!1)=>e.sort(((e,n)=>{const r=(e.ts||0)-(n.ts||0),o=0!==r?r:e.id.localeCompare(n.id);return t?o:-o})),Ks=()=>Js(window.nostr)?window.nostr:void 0;async function Zs(e,t){if(Js(window.nostr))return window.nostr;const n=new AbortController,{signal:r}=n,o=[new Promise(((e,r)=>{var o;null==(o=null==t?void 0:t.signal)||o.addEventListener("abort",(()=>{var e,o;n.abort(null==(e=t.signal)?void 0:e.reason);try{null==(o=null==t?void 0:t.signal)||o.throwIfAborted()}catch(i){return void r(i)}r(new Error("aborted unexpectedly"))}))})),Gs({signal:r})];var i;return"number"==typeof e&&Number.isFinite(e)&&e>0&&o.push((i={signal:r,timeoutMs:e},new Promise((e=>{var t;const n=setTimeout((()=>{e(void 0)}),i.timeoutMs);null==(t=i.signal)||t.addEventListener("abort",(()=>{clearTimeout(n)}))})))),function(){const e=Object.getOwnPropertyDescriptor(window,"nostr");if(!e)return!0;return e.configurable??!1}()&&o.push(function(){let e=window.nostr;return new Promise((t=>{Object.defineProperty(window,"nostr",{configurable:!0,get:()=>e,set:n=>{Js(n)&&t(n),e=n}})}))}()),Promise.race(o).then((e=>(n.abort("teardown"),e)))}function Gs(e){return new Promise((t=>{var n;const r=function(e){let t,n=0,r=0;const o=()=>{n+=r,r=n<1e3?10:n<5e3?100:1e3},i=()=>{o(),t=setTimeout((()=>{e(),i()}),r)},s=()=>{clearTimeout(t)};return i(),s}((()=>{const e=Ks();e&&(t(e),r())}));null==(n=e.signal)||n.addEventListener("abort",r)}))}function Js(e){if(!e)return!1;const t=e;try{const e="getPublicKey"in t&&("function"==typeof t.getPublicKey||"object"==typeof t.getPublicKey),n="signEvent"in t&&("function"==typeof t.signEvent||"object"==typeof t.signEvent);return e&&n}catch{return!1}}const Ys=[1,Me],Qs=[...Ys,7,Ie],Xs=["wss://purplepag.es/","wss://hist.nostr.land/"],ea=Math.max(5600,6e3);const ta=new class{constructor(e){__publicField(this,"relays",new Map),__publicField(this,"seenOn",new Map),__publicField(this,"verifyEvent"),__publicField(this,"_WebSocket"),__publicField(this,"eventsCount",{}),__publicField(this,"eventsTs",{}),this.verifyEvent=e.verifyEvent,this._WebSocket=e.websocketImplementation}async ensureRelay(e){let t=this.relays.get(e);return t||(t=new _o(e,{verifyEvent:this.verifyEvent,websocketImplementation:this._WebSocket}),t.connectionTimeout=ea,t._onauth=t=>{go.readRelays.includes(e)&&this.updateRelayInfo(e,{readAuth:!0})},this.relays.set(e,t)),await t.connect(),t}close(e){e.forEach((e=>{var t;null==(t=this.relays.get(e))||t.close()}))}async updateRelays(e){const t=e=>{const t=Object.values(e);return!(!t.find((e=>e.read))||!t.find((e=>e.write)))};let n=!1;const r=!(!mo.active||!window.nostr);let o={};const i=async()=>{const e=mo.active.pk,n=await this.queryProfileEvent({authors:[e],kinds:[10002]}),r=n?n.tags:[],o=Object.fromEntries(r.filter((e=>e.length>=2&&"r"===e[0])).map((e=>{let t={read:!0,write:!0};if(3===e.length){t["read"===e[2]?"write":"read"]=!1}return[e[1],t]})));return t(o)&&Ka("profileRelays",{pk:e,relays:JSON.stringify(o)}),o};if(r){const e=mo.active.pk;if(o=await window.nostr.getRelays(),!t(o)){const t=await Ha("profileRelays",IDBKeyRange.only(e));t&&(o=JSON.parse(t.relays))}t(o)||(n=!0,o=await i())}const s=r&&t(o)?o:Object.fromEntries((e||"").split(",").map((e=>[e,{read:!0,write:r}]))),a=Object.fromEntries(Object.entries(s).map((([e,t])=>[e.trim(),t])).filter((([e,t])=>e.length>0)).map((([e,t])=>[ko(new URL(e).toString()),t]))),l=Object.entries(a),u=l.filter((([e,t])=>t.read)).map((([e,t])=>e));var c,h,f;c=go,f=e=>{e.writeRelays=l.filter((([e,t])=>t.write)).map((([e,t])=>e)),JSON.stringify(e.readRelays)!==JSON.stringify(u)&&(e.readRelays=u)},h=e=>{if(Cr(e)){let t;(t=qr.get(e))||qr.set(e,t=new Proxy(e,Ur)),f(t)}return e},_((()=>h(_r(c)))),console.log(`[zapthreads] readRelays=${JSON.stringify(go.readRelays)} writeRelays=${JSON.stringify(go.writeRelays)}`),await this.updateWritePow(),r&&!n&&i()}async subscribeMany(e,t,n){return await this.subscribeManyMap(Object.fromEntries(e.map((e=>[e,t]))),n)}async subscribeManyMap(e,t){const{fastRelays:n,slowRelays:r,ranks:o}=await aa(Object.keys(e)),i=new Set([...n,r]),s=[];for(const[y,b]of Object.entries(e)){if(!i.has(y))continue;const e=[];for(const t of b)e.push({...t,since:await this.getSince(y,t)});s.push({url:y,filters:e,maxSince:Math.max(...e.map((e=>e.since))),latency:o.get(y)})}console.log(`[zapthreads] subscribing to ${s.length} relays (${Object.keys(e).length-s.length} failing)`),s.sort(((e,t)=>e.latency!==t.latency?e.latency-t.latency:e.maxSince!==t.maxSince?e.maxSince-t.maxSince:0)),t.receivedEvent=(e,t)=>{let n=this.seenOn.get(t);n||(n=new Set,this.seenOn.set(t,n)),n.add(e.url),this.eventsCount[e.url]=(this.eventsCount[e.url]||0)+1};const a=new Set,l=[],u=[];let c=e=>{var n;u[e]=!0,u.filter((e=>e)).length===s.length&&(null==(n=t.oneose)||n.call(t),c=()=>{})};const h=[];let f=(e,n,r)=>{var o;"connection timed out"===r||"websocket error"===r?na(n,1/0):r.includes("blocked")||"relay connection errored"===r?na(n,1/0,-1,!0):r.includes("auth")?this.updateRelayInfo(n,{readAuth:!0}):r.includes("write-only")&&this.updateRelayInfo(n,{writeOnly:!0}),c(e),h[e]=r,h.filter((e=>e)).length===s.length&&(null==(o=t.onclose)||o.call(t,h),f=()=>{})};const d=e=>{var n;if(null==(n=t.alreadyHaveEvent)?void 0:n.call(t,e))return!0;const r=a.has(e);return a.add(e),r},p=s.map((async({url:e,filters:n,latency:r},o)=>{let i;console.log(`[zapthreads] subscribing on ${e} with estimated latency ${Math.floor(r)} ms`);try{i=await this.ensureRelay(e)}catch(h){const t=cl(h)||"";return console.log(`[zapthreads] ${e} closed ${t}`),void f(o,e,t)}const s=this.eventsCount[e]||0,a=Date.now(),u=i.subscribe(n,{...t,onevent:r=>{var o;n.filter((e=>function(e,t){if(e.ids&&-1===e.ids.indexOf(t.id))return!1;if(e.kinds&&-1===e.kinds.indexOf(t.kind))return!1;if(e.authors&&-1===e.authors.indexOf(t.pubkey))return!1;for(let n in e)if("#"===n[0]){let r=e[`#${n.slice(1)}`];if(r&&!t.tags.find((([e,t])=>e===n.slice(1)&&-1!==r.indexOf(t))))return!1}return!(e.since&&t.created_at<e.since||e.until&&t.created_at>e.until)}(e,r))).forEach((t=>this.saveSince(e,t,r.created_at))),null==(o=t.onevent)||o.call(t,r)},oneose:()=>{var n;const r=Date.now()-a,i=(this.eventsCount[e]||0)-s;delete this.eventsCount[e];const l=r/Math.max(1,i);na(e,l),null==(n=t.oneoseOnRelay)||n.call(t,e),c(o)},onclose:t=>f(o,e,t),alreadyHaveEvent:d,eoseTimeout:t.maxWait});l.push(u)})),g=Date.now(),m=Promise.allSettled(p).then((e=>{console.log(`[zapthreads] processed subscriptions in ${Date.now()-g} ms`)}));return{async close(){await m,l.forEach((e=>{e.close()}))}}}async subscribeManyEose(e,t,n){const r=Vs()+900,o=await this.subscribeMany(e,t.map((e=>e.until?e:{...e,until:r})),{...n,oneose(){o.close()}});return o}async querySync(e,t,n){return new Promise((async r=>{const o=[];await this.subscribeManyEose(e,[t],{...n,onevent(e){o.push(e)},onclose(e){r(o)}})}))}async queryLast(e,t,n){return qs(await this.querySync(e,t,n),(e=>e.created_at))}async queryProfileEvent(e,t){let n=[...go.readRelays,...go.writeRelays,...Xs];if(mo.active){const e=await Ha("profileRelays",IDBKeyRange.only(mo.active.pk));e&&(n=[...n,...Object.keys(JSON.parse(e.relays))])}return await this.queryLast(n,e,t)}async publishEvent(e){let t=go.writeRelays;0===t.length&&await this.updateRelays(),t=go.writeRelays;const{fastRelays:n,slowRelays:r,offlineRelays:o,unsupported:i}=await aa(t,{event:e,write:!0});console.log(`[zapthreads] publishing to ${n.length+r.length} relays`+(i+o>0?` (ignored ${i} unsupported, ${o} failing)`:""));let s=!0;if(go.onPublish){const e=await go.onPublish({relays:[...n,...r]});if(!e.accepted)return{ok:0,failures:0};void 0!==e.concurrent&&(s=e.concurrent)}const a=await this.publish(e,n,s);return this.publish(e,r,s),a}async publish(e,t,n){return 0===t.length?{ok:0,failures:0}:n?await this.concurrentPublish(e,t):await this.sequentialPublish(e,t)}async concurrentPublish(e,t){const n=Date.now(),r=t.map((async t=>await this.publishOnRelay(t,e))),o=await Promise.allSettled(r),i=Date.now()-n,{ok:s,failures:a}=ca(o,t);return console.log(`[zapthreads] event ${e.id} published concurrently in ${i} ms to ${s} relays (${a} failed)`,t),{ok:s,failures:a}}async sequentialPublish(e,t){let n=0,r=0;const o=Date.now();for(const a of t)try{await this.publishOnRelay(a,e),n++}catch(s){console.error(s),r++}const i=Date.now()-o;return console.log(`[zapthreads] event ${e.id} published sequentially in ${i} ms to ${n} relays (${r} failed)`,t),{ok:n,failures:r}}async estimateWriteRelayLatencies(){const e=async e=>{var t;if(null==(t=this.relays.get(e))?void 0:t.connected)return;if((await Ua("relayStats",e,{index:"name"})).length>=5)return;const n=Date.now();let r=1/0;try{await this.ensureRelay(e);r=Date.now()-n}finally{na(e,r)}},t=go.writeRelays.map((async t=>await e(t)));await Promise.allSettled(t)}async publishOnRelay(e,t){const n=Date.now();let r=1/0;try{const o=await this.ensureRelay(e);await o.publish(t),r=Date.now()-n}finally{na(e,r,t.kind)}}async updateRelayInfos(){var e;if(go.disableFeatures.includes("relayInformation"))return;const t=Vs(),n=[],{fastRelays:r,slowRelays:o,offlineRelays:i}=await aa([...go.readRelays,...go.writeRelays]);for(const u of[...r,...o])if(null==(e=this.relays.get(u))?void 0:e.connected){const e=await Ha("relayInfos",IDBKeyRange.only(u));ua(t,e)&&n.push(u)}if(0===n.length)return;const s=await Promise.allSettled(n.map((async e=>{let n;try{const t=await la(e);ia(t),sa(void 0,t),n=t}catch(r){const t=(null==r?void 0:r.message)||String(r);console.info(`[zapthreads] info for ${e} failed with "${t}"`)}await Ka("relayInfos",{name:e,info:n,l:t})}))),{ok:a,failures:l}=ca(s,n);console.log(`[zapthreads] updated infos for ${a} relays (${l} failed)`),await Ga((async()=>await this.updateWritePow()))}async updateRelayInfo(e,t){const n=await Ha("relayInfos",IDBKeyRange.only(e))||{};await Ka("relayInfos",{...n,...t,name:e})}async updateWritePow(){const e=await Promise.all(go.writeRelays.map((async e=>{var t,n;const r=null==(t=await Ha("relayInfos",IDBKeyRange.only(e)))?void 0:t.info;return(null==(n=null==r?void 0:r.limitation)?void 0:n.min_pow_difficulty)||0})));go.writePowDifficulty=Math.max(go.minReadPow,...e)}async getSince(e,t){if(void 0!==t.since)return t.since;if(!go.anchor)return 0;const n=ya(e,t);if(void 0!==this.eventsTs[n])return this.eventsTs[n];const r=await Ha("requestFilters",IDBKeyRange.only(n));if(!r)return 0;const o=Vs(),i=r.l+3600<o;return Math.max(0,i?r.l+1:r.l-3600)}saveSince(e,t,n){var r;if(!go.anchor||(null==(r=t.kinds)?void 0:r.filter((e=>{return[0,3].includes(t=e)||1e4<=t&&t<2e4;var t}))))return;const o=ya(e,t),i=Math.max(this.eventsTs[o]||0,n);this.eventsTs[o]=i,Ka("requestFilters",{key:o,l:i})}}({verifyEvent:Ms,websocketImplementation:void 0}),na=async(e,t,n=-1,r=!1)=>{const o=qs((await Ua("relayStats",e,{index:"name"})).filter((e=>e.kind===n)),(e=>e.ts));Ka("relayStats",{name:e,kind:n,serial:o?(o.serial+(r?0:1))%5:0,latency:t,ts:Vs()})},ra=(e,t,n)=>{if(0===n)return!0;let r=0;if("number"==typeof t)r=t;else if("object"==typeof t){const e=t.find((e=>e.length>2&&"nonce"===e[0]));r=e&&+e[2]||0}return r>=n&&js(e)>=n},oa=e=>!0===(null==e?void 0:e.writeOnly),ia=(e,t)=>{if(!0===(null==t?void 0:t.readAuth))return!1;if(!e)return!0;const n=go.language;return!(n&&e.language_tags&&e.language_tags.length>0&&!e.language_tags.includes(n))},sa=(e,t)=>{if(!t)return!0;if(!ia(t))return!1;const n=t.retention;if(n){const t=e?e.kind:1;if(!(0===n.filter((e=>{const n=e.time&&0===e.time||e.count&&0===e.count,r=e.kinds&&e.kinds.includes(t),o=e.kinds&&e.kinds.filter((e=>Array.isArray(e))).map((e=>e)).map((e=>2==e.length&&t>=e[0]&&t<=e[1])).length>0;return n&&(r||o)})).length))return!1}const r=t.limitation,o=go.maxWritePow;if(r){if(r.auth_required&&r.auth_required)return!1;if(r.payment_required&&r.payment_required)return!1;if(r.min_pow_difficulty&&(o&&o<r.min_pow_difficulty||e&&!ra(e.id,e.tags,r.min_pow_difficulty)))return!1;if(r.max_content_length&&e&&e.content.length>r.max_content_length)return!1;if(r.max_message_length&&e&&('["EVENT",'+JSON.stringify(e)+"]").length>r.max_message_length)return!1}return!0},aa=async(e,t)=>{const n=Vs();let r=-1;t&&t.kind?r=t.kind:t&&t.event&&(r=t.event.kind);const o=(null==t?void 0:t.write)||!1;let i=[];const s=[];let a=0,l=0;const u=new Map;for(const h of new Set(e)){const e=await Ha("relayInfos",IDBKeyRange.only(h));if(e)try{if(!o&&(!ia(null==e?void 0:e.info,e)||oa(e))||o&&!sa(null==t?void 0:t.event,null==e?void 0:e.info)){l++;continue}}catch(c){}const f=await Ua("relayStats",h,{index:"name"}),d=Ns(f.map((e=>e.latency))),p=f.filter((e=>e.kind===r)),g=Ns(p.map((e=>e.latency))),m=p.length>0?qs(p,(e=>e.ts)):qs(f,(e=>e.ts)),y=p.length>0?g:d;u.set(h,y),y===1/0?m&&m.latency===1/0&&n<m.ts+30?a++:s.push(h):i.push({relayUrl:h,latency:y})}return i=i.sort(((e,t)=>e.latency-t.latency)).map((({relayUrl:e})=>e)),0===i.length?{fastRelays:s,slowRelays:[],offlineRelays:0,ranks:u,unsupported:l}:{fastRelays:i,slowRelays:s,offlineRelays:a,unsupported:l,ranks:u}},la=async e=>{if(!go.disableFeatures.includes("relayInformation"))return await(await ha(e.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()},ua=(e,t)=>{const n=t&&t.l;return!n||e>n+Hs},ca=(e,t)=>{var n;let r=0,o=0;for(let i=0;i<e.length;i++)if("fulfilled"===e[i].status)r++;else{const r=null==(n=e[i])?void 0:n.reason;console.error(t[i],(null==r?void 0:r.message)||String(r)),o++}return{ok:r,failures:o}},ha=(e,t)=>fetch(e,{...t,signal:AbortSignal.timeout(ea)}),fa=async(e,t)=>{go.client&&0===e.tags.filter((e=>e.length>0&&"client"===e[0])).length&&e.tags.push(["client",go.client]);const n=go.writePowDifficulty;let r;if(n>0){const o=function(e,t){let n=0;const r=e,o=["nonce",n.toString(),t.toString()];for(r.tags.push(o);;){const e=Math.floor((new Date).getTime()/1e3);if(e!==r.created_at&&(n=0,r.created_at=e),o[1]=(++n).toString(),r.id=Ls(r),js(r.id)>=t)break}return r}(e,n),i=await t.signEvent(o);r={...o,...i}}else{const n=Ds(e),o=await t.signEvent(e);r={id:n,...e,...o}}return console.log(JSON.stringify(r,null,2)),r},da=async(e,t)=>{const n=await fa(e,t),{ok:r,failures:o}=await ta.publishEvent(n);return{ok:r,failures:o,event:n}},pa=async()=>{if(mo.active)return mo.active;let e,t=!1;const n=await Ua("sessions",0,{index:"autoLogin"});if(n.length>0)if(window.nostr){console.log("[zapthreads] nip-07 became available, trying to re-enable auto-login");try{e=await window.nostr.getPublicKey()}catch(i){console.error(i),console.log("[zapthreads] cannot retrieve pubkey, removing old sessions"),Za("sessions",n.map((e=>e.pk))),go.subscribed(!1)}const r=n.find((t=>t.pk===e));r&&(t=!0,console.log("[zapthreads] re-enabling auto-login"),go.subscribed(r.subscriber))}else{console.log("[zapthreads] nip-07 is probably removed");const e=await Ua("sessions",0,{index:"autoLogin"});e.length>0&&console.log("[zapthreads] disabling auto-login"),e.forEach((e=>Ka("sessions",{...e,autoLogin:0}))),go.subscribed(!1)}const{accepted:r,autoLogin:o}=go.onLogin?await go.onLogin({knownUser:t}):{accepted:!0,autoLogin:!1};if(r){if(!window.nostr)throw new Error("No NIP-07 extension!");return e||(e=await window.nostr.getPublicKey()),mo.active={pk:e,signEvent:async e=>await window.nostr.signEvent(e)},mo.active.signEvent||console.error("User has no signer!"),(!0===o||t)&&(console.log("[zapthreads] saving session"),Ka("sessions",{pk:e,autoLogin:1,subscriber:go.subscribed()})),await ta.updateRelays(),mo.active}e&&(console.log("[zapthreads] removing session",e),Za("sessions",[e]),go.subscribed(!1))},ga=e=>{const{e:t,rankable:n,minReadPow:r,upvotes:o,downvotes:i}=e,s=al(t);ma({id:t.id,pubkey:t.pk,kind:t.k,powOrTags:t.pow,content:t.c},r);return{...go.onEvent?go.onEvent({rankable:n,kind:t.k,content:nl(t,go),replies:s,upvotes:o,downvotes:i,client:t.client,language:t.language,pow:t.pow,followedByModerator:go.lists.pubkeysFollowed.has(t.pk)}):{sanitizedContent:t.c,rank:void 0,showReportButton:!1},noteEvent:t}},ma=(e,t)=>{if(!go.disableFeatures.includes("followIsApproval")&&go.lists.pubkeysFollowed.has(e.pubkey))return;const n=e.id&&go.lists.eventsBlocked.has(e.id);n&&wa("eventsBlocked",e.id);const r=go.lists.pubkeysBlocked.has(e.pubkey);if(r&&wa("pubkeysBlocked",e.pubkey),n)throw new Error("Block-listed event");if(r)throw new Error("Block-listed user");if(!e.content.trim()&&e.content.length>go.maxCommentLength)throw new Error("Invalid message length");if(void 0!==e.id&&void 0!==t&&!ra(e.id,e.powOrTags,t))throw new Error("NIP-13 PoW is not okay")},ya=(e,t)=>{const n=["since","until","limit"],r=Object.fromEntries(Object.entries(t).filter((([e,t])=>!n.includes(e))).sort()),o=[e,go.anchor.value,r];return be(_s(JSON.stringify(o)))},ba=async()=>{if(!mo.active)return;const e=go.externalAuthor||go.anchorAuthor;if(!e)return;const t=await ta.queryProfileEvent({kinds:[3],authors:[mo.active.pk]});if(!t)return;const n=t.tags.filter((e=>e.length>=2&&"p"===e[0])).map((e=>e[1])).reverse().includes(e);return go.subscribed(n),await va(),t},va=async()=>{const e=go.subscribed(),t=await Ha("sessions",IDBKeyRange.only(mo.active.pk));t&&t.subscriber!==e&&Ka("sessions",{...t,subscriber:e})},wa=async(e,t,n)=>{const r=await Ha(e,IDBKeyRange.only(t))||{id:t,addedAt:Vs(),used:!1};if(r.used)return;let o,i;if("eventsBlocked"===e){const e=await Ha("events",IDBKeyRange.only(t));e&&(o=await Ha("pubkeysBlocked",IDBKeyRange.only(e.pk)))}if(o)Ka("pubkeysBlocked",{...o,used:!0});else{const t=r.reason||n;Ka(e,{...r,used:!0,reason:t})}if("eventsBlocked"===e)i=[t];else if("pubkeysBlocked"===e){i=(await Ua("events",t,{index:"pk"})).map((e=>e.id))}i&&Za("events",i)},ka=async e=>{go.lists.checkUpdates&&(go.lists.checkUpdates=!1,await Ca(e),await xa(),await Ba(),console.log("[zapthreads] updated block-lists"))},xa=async()=>{if(!go.community||!go.anchorAuthor)return;const e=go.community&&await Ha("communities",IDBKeyRange.only(go.community)),t=e?e.l+1:0,n=Vs();if(e&&n<t+Us)return;(await ta.querySync(go.readRelays,{kinds:[34550],authors:[go.anchorAuthor],"#d":[go.community],since:t})).forEach((e=>{if(34550===e.kind){const t=e.tags.filter((e=>e.length>=4&&"p"===e[0]&&"moderator"===e[3])).map((e=>e[1]));Ka("communities",{community:go.community,moderators:t,l:Vs()},{immediate:!0})}}))},Aa=async()=>{const e=Vs();return Math.max(...await Promise.all(["eventsBlocked","pubkeysBlocked"].map((async t=>{const n=go.lists[t];let r=0;const o=[],i=await Ua(t);for(const s of i)r=Math.max(r,s.addedAt),!s.used&&e>=s.addedAt+Hs?o.push(s.id):n.add(s.id);return Za(t,o),r}))))},Ea=async()=>{const e=await Ua("pubkeysFollowed");let t=0;for(const n of e)t<n.addedAt&&(t=n.addedAt),n.pks.forEach((e=>go.lists.pubkeysFollowed.add(e)));return t},Ca=async e=>{if(go.disableFeatures.includes("spamNostrBand"))return;const t=Vs();if(t<e+Us)return;await Promise.allSettled(["eventsBlocked","pubkeysBlocked"].map((async e=>{try{const n=e.replace("Blocked",""),r=ha(`https://spam.nostr.band/spam_api?method=get_current_spam&view=${n}`),o=go.lists[e],i=await r;if(200===i.status){(await i.json())[`cluster_${n}`].map((e=>e[n])).flat().filter((e=>!o.has(e))).forEach((r=>{o.add(r),Ka(e,{id:r,addedAt:t,used:!1,reason:`Block-listed ${n.slice(0,-1)} by spam.nostr.band`})}))}}catch(n){console.error(n)}}))),console.log("[zapthreads] updated spam.nostr.band")},_a=async()=>{const e=go.community&&await Ha("communities",IDBKeyRange.only(go.community)),t=e?e.l:0;return go.moderators.clear(),go.anchorAuthor&&go.moderators.add(go.anchorAuthor),e&&e.moderators.forEach((e=>go.moderators.add(e))),go.externalAuthor&&go.moderators.add(go.externalAuthor),t},Ba=async()=>{await _a();const e=mo.active?[mo.active.pk]:[],t=[...go.moderators,...e],n=await ta.querySync(go.readRelays,{kinds:[De,Oe,3],authors:t});n.forEach((e=>{e.kind===De?Sa(e.tags):e.kind===Oe&&Fa(e.tags)}));const r=new Map;n.filter((e=>3===e.kind)).forEach((e=>{const t=r.get(e.pubkey);(!t||e.created_at>t.created_at)&&r.set(e.pubkey,e)})),[...r.values()].forEach((e=>za(e)))},Sa=e=>{const t=e.filter((e=>e.length>=2&&"p"===e[0])).map((e=>e[1]));if(!(t.length>0&&0===t.filter((e=>go.moderators.has(e))).length))return;const n=e.filter((e=>e.length>=3&&"e"===e[0]));n.length>0?n.forEach((e=>wa("eventsBlocked",e[1],e[2]))):e.filter((e=>e.length>=3&&"p"===e[0])).forEach((e=>wa("pubkeysBlocked",e[1],e[2])))},Fa=e=>{const t=e.filter((e=>2===e.length)),n=t.filter((e=>"p"===e[0])).map((e=>e[1])),r=t.filter((e=>"e"===e[0])).map((e=>e[1]));n.forEach((e=>wa("pubkeysBlocked",e,"Mute-listed user"))),r.forEach((e=>wa("eventsBlocked",e,"Mute-listed event")))},za=e=>{const t=e.tags.filter((e=>e.length>=2)).filter((e=>"p"===e[0])).map((e=>e[1]));Ka("pubkeysFollowed",{moderator:e.pubkey,pks:t,addedAt:e.created_at}),t.forEach((e=>go.lists.pubkeysFollowed.add(e)))},Da=e=>"-"===e.content?-1:0===e.content.length||"+"===e.content?1:0,Ia={events:"id",reactions:"id",aggregates:["eid","k"],profiles:"pk",profileRelays:"pk",sessions:"pk",requestFilters:"key",relayInfos:"name",relayStats:["name","kind","serial"],eventsBlocked:"id",pubkeysBlocked:"id",pubkeysFollowed:"moderator",communities:"community"},Ma=async(e,t)=>{if(t<=3){const t=[...e.objectStoreNames];await Promise.all(t.map((t=>e.deleteObjectStore(t))))}const n=e.createObjectStore("events",{keyPath:Ia.events});n.createIndex("pk","pk"),n.createIndex("a","a"),n.createIndex("ro","ro"),n.createIndex("r","r"),n.createIndex("d","d"),n.createIndex("k","k");e.createObjectStore("reactions",{keyPath:Ia.reactions}).createIndex("a","a"),e.createObjectStore("aggregates",{keyPath:Ia.aggregates});e.createObjectStore("profiles",{keyPath:Ia.profiles}).createIndex("l","l"),e.createObjectStore("profileRelays",{keyPath:Ia.profileRelays});e.createObjectStore("sessions",{keyPath:Ia.sessions}).createIndex("autoLogin","autoLogin"),e.createObjectStore("requestFilters",{keyPath:Ia.requestFilters}),e.createObjectStore("relayInfos",{keyPath:Ia.relayInfos});e.createObjectStore("relayStats",{keyPath:Ia.relayStats}).createIndex("name","name"),e.createObjectStore("pubkeysBlocked",{keyPath:Ia.pubkeysBlocked}),e.createObjectStore("eventsBlocked",{keyPath:Ia.eventsBlocked}),e.createObjectStore("pubkeysFollowed",{keyPath:Ia.pubkeysFollowed}),e.createObjectStore("communities",{keyPath:Ia.communities}),ka(0)},Oa=e=>e.filter((e=>2===e.length&&"client"===e[0])).map((e=>e[1]))[0],Ta=e=>{var t,n;const r=ao(e),o=e.tags.find((e=>"a"===e[0])),i=o&&o[1],s=o&&"mention"===o[3],a=e.tags.find((e=>"r"===e[0])),l=a&&a[1],u=e.tags.filter((e=>"t"===e[0])),c=[...new Set(u.map((e=>e[1])))],h=e.tags.find((e=>"d"===e[0])),f=h&&h[1],d=e.tags.find((e=>"title"===e[0])),p=d&&d[1],g=e.tags.find((e=>e.length>2&&"nonce"===e[0])),m=g&&+g[2]||0,y=Oa(e.tags),b=e.tags.filter((e=>e.length>=3&&"l"===e[0]&&"ISO-639-1"===e[2])).map((e=>e[1].trim())).filter(wo)[0];return{id:e.id??"",k:e.kind,c:e.content,ts:e.created_at,pk:e.pubkey,ro:null==(t=r.root)?void 0:t.id,re:null==(n=r.reply)?void 0:n.id,me:r.mentions.map((e=>e.id)),p:r.profiles.map((e=>e.pubkey)),a:i,am:s,r:l,t:c,d:f,tl:p,pow:m,client:y,language:b}};let Pa,Ra={},La=!0,$a=!0;const ja=async()=>{if(La&&$a)try{return Pa||(Pa=await function(e,t,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const s=indexedDB.open(e,t),a=to(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(to(s.result),e.oldVersion,e.newVersion,to(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{i&&e.addEventListener("close",(()=>i())),o&&e.addEventListener("versionchange",(e=>o(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}("zapthreads-codonaft",4,{upgrade:Ma}),Pa.addEventListener("close",(e=>{console.log("[zapthreads] closed database"),$a=!1}),{once:!0}),window.addEventListener("storage",(e=>{null===e.key&&(console.log("[zapthreads] cleared storage"),$a=!1)}),{once:!0})),Pa}catch(e){La=!1}},Na=e=>{const t=E(S(e,(()=>{const[t,n,r]=e(),[o,{mutate:i}]=C((()=>Ja[t]),(()=>Ua(t,n,r)),{initialValue:[],storage:Ya});return Ua(t,n,r).then(i),o})));return()=>t()()},qa=e=>{const t=E(S(e,(()=>{const[t,n,r]=e(),[o,{mutate:i}]=C((()=>Ja[t]),(()=>Ha(t,n,r)),{initialValue:void 0,storage:Ya});return Ha(t,n,r).then(i),o})));return()=>t()()},Ua=async(e,t,n)=>{if(!$a)return[];const r=await ja();if(!r){const r=Ra[e];if(r){if(n){const e=Array.isArray(t)?t:[t];return Object.values(r).filter((t=>e.includes(t[n.index])))}return Object.values(r)}return[]}if(t&&n){if(Array.isArray(t)){const o=t.map((t=>r.getAllFromIndex(e,n.index,t)));return(await Promise.all(o)).flat()}return r.getAllFromIndex(e,n.index,t)}return r.getAll(e)},Ha=async(e,t,n)=>{if(!$a)return;const r=await ja();if(r)return n?r.getFromIndex(e,n.index,t):r.get(e,t);{const r=Ra[e];if(r){if(n)return Object.values(r).find((e=>e[n.index]===t));return r[(t.lower?t.lower:t).toString()]}}},Va={},Wa=(e,t)=>{Ra[e]??(Ra[e]={});for(const n of t){let t=Ia[e];t=Array.isArray(t)?t:[t];const r=t.map((e=>n[e])).join(",");Ra[e][r]=n}},Ka=async(e,t,n={immediate:!1})=>{if(!$a)return;const r=await ja();if(n.immediate)return r?r.put(e,t):Wa(e,[t]),void(Ja[e]=+new Date);Va[e]||(Va[e]=vr((async t=>{if(!r)return Wa(e,t),void(Ja[e]=+new Date);const n=r.transaction(e,"readwrite");await Promise.all([...t.map((e=>n.store.put(e))),n.done])&&(Ja[e]=+new Date)}),{delay:96})),Va[e](t)},Za=async(e,t,n={immediate:!0})=>{if(!$a)return;const r=await ja();let o=!0;if(!n.immediate)throw new Error("unimplemented");if(r){const n=r.transaction(e,"readwrite");o=!!(await Promise.all([...t.map((e=>n.store.delete(e))),n.done]))}else((e,t)=>{const n=Ra[e];n&&delete n[(t.lower?t.lower:t).toString()]})(e,t);o&&(Ja[e]=+new Date)},Ga=async e=>{await new Promise((e=>setTimeout(e,96))),await e()},Ja=Lr({});function Ya(e){const[t,n]=Tr({value:e});return[()=>t.value,e=>{const r=_r(t.value);return"function"==typeof e&&(e=e(r)),n("value",Nr(e)),t.value}]}const Qa=e=>{if(e.length<15)throw new Error("Too short hash");const t=((e,t,n)=>{const r=[n+=t*=n<.5?n:1-n,n-(e*=6)%1*t*2,n-=t*=2,n,n+e%1*t,n+t];return[Math.round(255*r[Math.floor(e)%6]),Math.round(255*r[(16|e)%6]),Math.round(255*r[(8|e)%6]),255]})(parseInt(e.substr(-7),16)/268435455,.7,.5),n=Math.floor(53.76/5),r=Math.floor((64-5*n)/2),o=`rgba(${[240,240,240,255].join(",")})`,i=`rgba(${t.join(",")})`,s=(e,t,r)=>`<rect x='${e}' y='${t}' width='${n+1}' height='${n+1}' fill='${r}'/>`;let a=`<svg xmlns='http://www.w3.org/2000/svg' width='64' height='64' style='background-color:${o};'>`;for(let u=0;u<15;u++){const t=parseInt(e.charAt(u),16)%2?o:i;u<5?a+=s(2*n+r,u*n+r,t):u<10?(a+=s(1*n+r,(u-5)*n+r,t),a+=s(3*n+r,(u-5)*n+r,t)):u<15&&(a+=s(0*n+r,(u-10)*n+r,t),a+=s(4*n+r,(u-10)*n+r,t))}a+="</svg>";const l=new Blob([a],{type:"image/svg+xml"});return URL.createObjectURL(l)},Xa=async(e,t,n)=>{const r=new Set([...e].filter((e=>!go.requestedProfileUpdate.has(e))));r.forEach((e=>go.requestedProfileUpdate.add(e)));const o=+new Date,i=n.map((e=>[e.pk,e])),s=new Map(i),a=new Set([...r].filter((e=>{const t=s.get(e);return!((null==t?void 0:t.l)&&t.l>o-216e5)})).filter((e=>!!e)));if(0===a.size)return;const l=Math.min(...i.filter((([e,t])=>a.has(e))).map((([e,t])=>t.l?t.l+1:0))),{fastRelays:u,slowRelays:c}=await aa([...t,...Xs],{kind:0}),h=[{kinds:[0],authors:[...a],since:l===1/0?0:l}],f=async e=>{0!==e.length&&await ta.subscribeManyEose(e,h,{onevent(e){const t=e.pubkey;if(a.has(t))try{const n=JSON.parse(e.content),r={pk:t,ts:e.created_at,i:n.image||n.picture,n:n.displayName||n.display_name||n.name},i=s.get(t);if(!i||!(null==i?void 0:i.i)||!(null==i?void 0:i.n)||i.ts<r.ts){const e=i?{...i,...r,l:o}:{...r,l:o};s.set(t,e),Ka("profiles",e),console.log(`[zapthreads] updated profile ${t}`)}}catch(n){console.error(n)}}})};await f(u),f(c)},el=new RegExp("(?<=^|\\s)@?((naddr|npub|nevent|note)[a-z0-9]{20,})","g"),tl=/\B\#([a-zA-Z0-9]+\b)(?!;)/g,nl=(e,t,n=[])=>{let r=e.c;const o=t.urlPrefixes,i=t.profiles,s=[...new Set(e.t)];if(s.length>0){const e=new RegExp(`(^|\\s)\\#(${s.join("|")})`,"gi");r=r.replaceAll(e,`$1[#$2](${o.tag}$2)`)}r=r.replaceAll(el,"nostr:$1"),r=function(e,t){return e.replaceAll(Ne(),((e,n)=>t({uri:e,value:n,decoded:Re(n)})))}(r,(({decoded:e,value:t})=>{switch(e.type){case"nprofile":let r=i().find((t=>t.pk===e.data.pubkey));return`[@${(null==r?void 0:r.n)||ol(t)}](${o.nprofile}${t})`;case"npub":let s=i().find((t=>t.pk===e.data));return`[@${(null==s?void 0:s.n)||ol(t)}](${o.npub}${t})`;case"note":return`[@${ol(t)}](${o.note}${t})`;case"naddr":const a=e.data,l=n.find((e=>e.pk===a.pubkey&&e.d===a.identifier));return l&&l.tl?`[${l.tl}](${o.naddr}${t})`:`[@${ol(t)}](${o.naddr}${t})`;case"nevent":return`[@${ol(t)}](${o.nevent}${t})`;default:return t}}));return new hn("full",{linkTarget:"_blank",typographer:!0,quotes:"ru"===e.language?"«»‘’":"“”‘’"}).use(br).render(r.trim())},rl=e=>{const t=[],n=function*(e){const t=e.matchAll(Ne());for(const r of t)try{const[e,t]=r;yield{uri:e,value:t,decoded:Re(t),start:r.index,end:r.index+e.length}}catch(n){}}(e);for(const i of n){if("npub"===i.decoded.type&&t.push(["p",i.decoded.data]),"naddr"===i.decoded.type){const e=i.decoded.data;t.push(["a",`${e.kind}:${e.pubkey}:${e.identifier}`,"","mention"])}"nevent"===i.decoded.type&&t.push(["e",i.decoded.data.id]),"note"===i.decoded.type&&t.push(["e",i.decoded.data])}const r=e.matchAll(tl),o=new Set([...r].map((e=>e[1].toLowerCase())));for(const i of o)t.push(["t",i]);return t},ol=e=>e.substring(0,8)+"..."+e.substring(e.length-4),il=20,sl=e=>{if(!e)return'data:image/svg+xml;utf-8,<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><circle cx="512" cy="512" r="512" fill="%23333" fill-rule="evenodd" /></svg>';const t=go.urlPrefixes.picture;if(t){const n=new URL(t);return n.pathname=e,n.href}return Qa(e)},al=e=>e.children.reduce(((e,t)=>e+al(t)),e.children.length),ll=/\/+$/,ul=(e,t=!0)=>{const n=new URL(e);return n.hash="",t&&(n.pathname=n.pathname.replace(ll,"")),n.toString()},cl=e=>{const t=e;return(null==t?void 0:t.message)||String(null==t?void 0:t.reason)},hl=async()=>{try{return await pa()}catch(e){console.error(cl(e))}},fl=(e,t)=>{let n=e.map((e=>({...e,children:[]})));const r=new Set(n.filter((e=>{if(t){const n=t.id===(e.re||e.ro);return n&&(e.parent=t),n}return!n.find((t=>t.id===(e.re||e.ro)))})));n=n.filter((e=>!r.has(e)));for(let o of r)o.children.push(...fl(n,o));return[...r]};var dl=J("<span>"),pl=J("<li class=ztr-comment-action-upvote>"),gl=J("<li class=ztr-comment-action-votes><span>"),ml=J("<li class=ztr-comment-action-downvote>"),yl=J('<svg xmlns=http://www.w3.org/2000/svg width=32 height=32 fill=#000000 viewBox="0 0 256 256"><path d=M237,77.47A28,28,0,0,0,216,68H164V56a44.05,44.05,0,0,0-44-44,12,12,0,0,0-10.73,6.63L72.58,92H32a20,20,0,0,0-20,20v88a20,20,0,0,0,20,20H204a28,28,0,0,0,27.78-24.53l12-96A28,28,0,0,0,237,77.47ZM36,116H68v80H36ZM220,96.5l-12,96a4,4,0,0,1-4,3.5H92V106.83L126.82,37.2A20,20,0,0,1,140,56V80a12,12,0,0,0,12,12h64a4,4,0,0,1,4,4.5Z>'),bl=J('<svg xmlns=http://www.w3.org/2000/svg width=32 height=32 fill=#000000 viewBox="0 0 256 256"><path d=M243.78,156.53l-12-96A28,28,0,0,0,204,36H32A20,20,0,0,0,12,56v88a20,20,0,0,0,20,20H72.58l36.69,73.37A12,12,0,0,0,120,244a44.05,44.05,0,0,0,44-44V188h52a28,28,0,0,0,27.78-31.47ZM68,140H36V60H68Zm151,22.65a4,4,0,0,1-3,1.35H152a12,12,0,0,0-12,12v24a20,20,0,0,1-13.18,18.8L92,149.17V60H204a4,4,0,0,1,4,3.5l12,96A4,4,0,0,1,219,162.65Z>'),vl=J('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 256 256"><path fill=none d="M0 0h256v256H0z"></path><path d="M234 80.12A24 24 0 0 0 216 72h-56V56a40 40 0 0 0-40-40 8 8 0 0 0-7.16 4.42L75.06 96H32a16 16 0 0 0-16 16v88a16 16 0 0 0 16 16h172a24 24 0 0 0 23.82-21l12-96A24 24 0 0 0 234 80.12M32 112h40v88H32Z"></path><path d="M27.419 101.919h49.822v109.612H27.419z">'),wl=J('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 256 256"><path fill=none d="M0 0h256v256H0z"></path><path d="m239.82 157-12-96A24 24 0 0 0 204 40H32a16 16 0 0 0-16 16v88a16 16 0 0 0 16 16h43.06l37.78 75.58A8 8 0 0 0 120 240a40 40 0 0 0 40-40v-16h56a24 24 0 0 0 23.82-27M72 144H32V56h40Z"></path><path d="M26.819 45.073h49.284v107.561H26.819z">');const kl=e=>{const t=()=>e.eventId(),n=()=>e.rootEventId(),r=fo(!1),o=fo(0),i=()=>e.votes().filter((e=>e.noteId===t()));A((()=>{_((()=>{const t=(()=>{const e=new Map;return i().forEach((t=>{!function(e,t,n,r){let o,i,s=!1;e.has(t)?o=e.get(t):(o=n(),s=!0),r?(i=r(o),s=!0):i=o,s&&e.set(t,i)}(e,t.pk,(()=>[]),(e=>[...e,t]))})),[...e.values()].map((e=>Ws(e)[0]))})();r(t.length>0);const n=t.map((e=>+(1===Da(e)))).reduce(((e,t)=>e+t),0),s=t.map((e=>+(-1===Da(e)))).reduce(((e,t)=>e+t),0);e.voteCounts().upvotesCount(n),e.voteCounts().downvotesCount(s);const a=mo.active,l=a&&t.filter((e=>e.pk===a.pk)).map((e=>Da(e)))[0]||0;o(l)}))}));const s=async e=>{const r=await hl();if(!r)return;const s=r,a=o()===e?0:e;await(async()=>{const e=Ws(i().filter((e=>e.pk===s.pk))).reverse().map((e=>e.id));if(0===e.length)return;await da({kind:5,created_at:Vs(),content:"",pubkey:s.pk,tags:[...e.map((e=>["e",e])),...e.map((e=>["k","7"]))]},s)&&Za("reactions",e)})(),[-1,1].includes(a)&&await(async()=>{const e=[];n()&&e.push(["e",n(),"","root"]),await da({kind:7,created_at:Vs(),content:-1===a?"-":"+",pubkey:s.pk,tags:[...e,["e",t(),"","reply"],["p",s.pk]]},s)})()};return W(Z,{get when(){return!go.disableFeatures.includes("votes")},get children(){return[(a=pl(),a.$$click=()=>s(1),ee(a,(i=E((()=>1===o())),()=>i()?El():xl()),null),ee(a,W(Z,{get when(){return E((()=>!!go.disableFeatures.includes("singleVoteCounter")))()&&r()},get children(){var t=dl();return ee(t,(()=>e.voteCounts().upvotesCount())),t}}),null),x((()=>a.classList.toggle("selected",!(1!==o())))),a),W(Z,{get when(){return!go.disableFeatures.includes("singleVoteCounter")||!r()},get children(){var t,n=gl();return ee(n.firstChild,(t=E((()=>!!r())),()=>t()?e.voteCounts().upvotesCount()-e.voteCounts().downvotesCount():"Vote")),n}}),(n=ml(),n.$$click=()=>s(-1),ee(n,(t=E((()=>-1===o())),()=>t()?Cl():Al()),null),ee(n,W(Z,{get when(){return E((()=>!!go.disableFeatures.includes("singleVoteCounter")))()&&r()},get children(){var t=dl();return ee(t,(()=>e.voteCounts().downvotesCount())),t}}),null),x((()=>n.classList.toggle("selected",!(-1!==o())))),n)];var t,n,i,a}})},xl=()=>yl(),Al=()=>bl(),El=()=>vl(),Cl=()=>wl();Y(["click"]);var _l=J("<div class=ztr-comment-info-picture><img>"),Bl=J("<div class=ztr-reply-form><textarea></textarea><div class=ztr-reply-controls>"),Sl=J("<span> Comment is limited to <!> characters; you entered <!>."),Fl=J("<span>Publishing is disabled"),zl=J("<span class=ztr-reply-error>"),Dl=J('<svg class=ztr-spinner viewBox="0 0 50 50"><circle class=path cx=25 cy=25 r=20 fill=none stroke-width=5>'),Il=J("<button class=ztr-reply-button>Reply as "),Ml=J("<button class=ztr-reply-login-button><div style=display:inline-grid;vertical-align:middle></div>&nbsp;Login"),Ol=J("<li class=ztr-comment-action-like><span> likes"),Tl=J("<li class=ztr-comment-action-zap><span> sats"),Pl=J("<div class=ztr-comment-new><div class=ztr-comment-body><ul class=ztr-comment-actions><button class=ztr-comment-subscribe-button>");const Rl=e=>{const t=()=>e.comment(),n=t=>e.comment(t),[r,o]=w(!1),[i,s]=w(),[a,l]=w(""),u=()=>go.anchor,c=go.profiles;A((async()=>{if(mo.active){const e=mo.active.pk;let t=c().find((t=>t.pk===e));t||(t={pk:e,l:0,ts:0},await Ka("profiles",t)),s(t),Xa(new Set([e]),go.readRelays,c())}else s()}));const h=async(t,r)=>{var i;o(!1),n(""),l(r??""),await Ka("events",Ta(t),{immediate:!0}),null==(i=e.onDone)||i.call(void 0)},f=e=>{o(!1),l(e)},d=async n=>{let r;if(!n)return;if(r=mo.active,!(null==r?void 0:r.signEvent))return void f("User has no signer!");const i=t().trim();if(!i)return;const s={kind:1,created_at:Vs(),content:i,pubkey:r.pk,tags:rl(i)};try{((e,t)=>{const n=!1;Ys.includes(e.kind)?ga({e:{...Ta(e),children:[]},rankable:n,minReadPow:t,upvotes:0,downvotes:0}):(ma({id:e.id,pubkey:e.pubkey,kind:e.kind,powOrTags:e.tags,content:e.content},t),go.onEvent?go.onEvent({rankable:n,kind:e.kind,content:e.content,client:Oa(e.tags),replies:0,upvotes:0,downvotes:0,pow:go.writePowDifficulty,followedByModerator:go.lists.pubkeysFollowed.has(e.pubkey)}):e.content)})({...s,id:void 0})}catch(a){return void f(cl(a))}if(go.anchorAuthor&&go.anchorAuthor!==s.pubkey&&s.tags.push(["p",go.anchorAuthor]),go.externalAuthor)try{s.tags.push(["p",go.externalAuthor])}catch(l){}if(e.replyTo){const t=await Ha("events",IDBKeyRange.only(e.replyTo));t&&(console.log("[zapthreads] publishing reply"),s.tags.push(["e",t.ro,"","root"]),t.pk!==s.pubkey&&s.tags.push(["p",t.pk])),s.tags.push(["e",e.replyTo,"","reply"])}else{const e=go.version||go.rootEventIds[0];if(e)s.tags.push(["e",e,"","root"]);else if("http"===u().type){const e=ko(u().value),t={pubkey:r.pk,created_at:Vs(),kind:8812,tags:[["r",e]],content:`Comments on ${e} ↴`},n=await fa(t,r);Ka("events",Ta(n)),go.disableFeatures.includes("publish")?console.log("Publishing root event disabled",n):(console.log("publishing root event"),ta.publishEvent(n)),go.filter={"#e":[n.id]},s.tags.push(["e",n.id,"","root"])}}"naddr"===u().type&&s.tags.push(["a",u().value,"","root"]),go.language&&(s.tags.push(["L","ISO-639-1"]),s.tags.push(["l",go.language,"ISO-639-1"]));for(const e of _r(go.additionalTags))s.tags.push(e);if(o(!0),go.disableFeatures.includes("publish")){const e=await fa(s,r);setTimeout((()=>h(e)),1e3)}else{const{ok:e,failures:t,event:n}=await da(s,r);if(0===e)f("Your comment was not published to any relay");else{const r=`Published to ${e}/${go.writeRelays.length} relays (see console for more info)`;h(n,t>0?r:void 0)}}},p=void 0!==e.replyTo;let g;(e=>{A((()=>{const t=e();t&&setTimeout((()=>t.focus()))}))})((()=>p&&g));const m=()=>go.maxCommentLength,y=()=>t().length>m(),b=()=>{var e;return sl(null==(e=i())?void 0:e.pk)},v=fo(b());return A((async()=>{var e;v((null==(e=i())?void 0:e.i)||b())})),(()=>{var e=Bl(),o=e.firstChild,s=o.nextSibling;o.$$input=e=>n(e.target.value);var u,c,h,w,k;return"function"==typeof g?X(g,o):g=o,o.autofocus=p,ee(e,(u=E((()=>t().length>.98*m())),()=>{return u()&&(e=Sl(),n=e.firstChild,r=n.nextSibling,(o=r.nextSibling.nextSibling).nextSibling,ee(e,du,n),ee(e,m,r),ee(e,(()=>t().length),o),x((()=>e.classList.toggle("ztr-reply-error",!!y()))),e);var e,n,r,o}),s),ee(s,(c=E((()=>!!go.disableFeatures.includes("publish"))),()=>c()&&Fl()),null),ee(s,(h=E((()=>!!a())),()=>{return h()&&(ee(e=zl(),a),e);var e}),null),ee(s,W(Z,{get when(){return!r()},get fallback(){return Dl()},get children(){var e=_l(),t=e.firstChild;return t.addEventListener("error",(()=>v(b()))),x((()=>Q(t,"src",v()))),e}}),null),ee(s,(w=E((()=>!!i())),()=>{return w()&&((e=Il()).firstChild,e.$$click=()=>d(i()),ee(e,(()=>i().n||ol(Se(i().pk))),null),x((()=>e.disabled=r()||y())),e);var e}),null),ee(s,(k=E((()=>!i())),()=>{return k()&&(e=Ml(),t=e.firstChild,e.$$click=()=>(async()=>{try{await pa(),l("")}catch(e){f(cl(e))}})(),ee(t,iu),e);var e,t}),null),x((e=>{var t=r(),n=go.replyPlaceholder||"Add your comment...",i=!!y();return t!==e.e&&(o.disabled=e.e=t),n!==e.t&&Q(o,"placeholder",e.t=n),i!==e.a&&o.classList.toggle("too-long",e.a=i),e}),{e:void 0,t:void 0,a:void 0}),x((()=>o.value=t())),e})()},Ll=e=>{const t=()=>go.anchor,n=qa((()=>["aggregates",IDBKeyRange.only([t().value,9735])])),r=qa((()=>["aggregates",IDBKeyRange.only([t().value,7])])),o=()=>{var e;return(null==(e=r())?void 0:e.ids.length)??0},i=fo(""),s=fo(0),a=fo(0),l=()=>({upvotesCount:s,downvotesCount:a}),u=()=>t().value,c=fo(!1),h=()=>go.subscribed()?c()?"Unsubscribe?":"Subscribed":"Subscribe";return d=Pl(),p=d.firstChild,g=p.firstChild,m=g.firstChild,ee(g,W(Z,{get when(){return!go.disableFeatures.includes("likes")},get children(){var e=Ol(),t=e.firstChild,n=t.firstChild;return ee(e,lu,t),ee(t,o,n),e}}),m),ee(g,W(Z,{get when(){return!go.disableFeatures.includes("zaps")},get children(){var e=Tl(),t=e.firstChild,r=t.firstChild;return ee(e,au,t),ee(t,(()=>{return(e=(null==(t=n())?void 0:t.sum)??0)<1e4?e.toString():e<1e6?Math.round(e/1e3)+"k":Math.round(e/1e6)+"M";var e,t}),r),e}}),m),m.$$click=()=>(async()=>{const e=await hl(),t=go.externalAuthor||go.anchorAuthor;if(!e||!t)return;const n=go.subscribed(),r=await ba();if(go.subscribed()!==n)return void console.log("[zapthreads] already toggled subscription");const o=r?r.tags:[];if(n){const e=o.findIndex((e=>e.length>=2&&"p"===e[0]&&e[1]===t));o.splice(e,1)}else o.push(["p",t]);const i={kind:3,created_at:Vs(),content:"",pubkey:e.pk,tags:o},s=Ds(i),a=await e.signEvent(i),l={id:s,...i,...a};console.log(JSON.stringify(l,null,2));const{ok:u,failures:c}=await ta.publishEvent(l);u>0&&go.subscribed(!n),await va(),console.log("[zapthreads] subscribed",go.subscribed())})(),m.addEventListener("mouseleave",(()=>c(!1))),m.addEventListener("mouseenter",(()=>c(!0))),ee(m,h),ee(g,(f=E((()=>!!["note","naddr"].includes(t().type))),()=>f()&&W(kl,{eventId:u,rootEventId:u,voteCounts:l,get votes(){return e.votes}})),null),ee(p,W(Rl,{comment:i}),null),x((()=>m.classList.toggle("selected",!!go.subscribed()))),d;var f,d,p,g,m};Y(["input","click"]);var $l=J("<div class=ztr-thread>"),jl=J("<li class=ztr-comment-action-reply><span>"),Nl=J("<div class=ztr-comment><div class=ztr-comment-body><div class=ztr-comment-info-wrapper><div class=ztr-comment-info><div class=ztr-comment-info-picture><img></div><ul class=ztr-comment-info-items><li class=ztr-comment-info-author><a target=_blank></a><span style=white-space:nowrap;><a target=_blank style=font-weight:400><small>ed </small></a></span></li></ul></div></div><div class=ztr-comment-text></div><ul class=ztr-comment-actions></ul></div><div class=ztr-comment-replies><div class=ztr-comment-replies-info-actions>"),ql=J("<div class=ztr-comment-text><p class=warning><span>This is a <!> that referenced this article in <a>another thread"),Ul=J("<div class=ztr-comment-text><p class=warning><span>Article contents may have changed since this <!> was made"),Hl=J("<div class=ztr-comment-text><p class=warning><span>Article contents changed since this <!> was made"),Vl=J("<div class=ztr-comment-expand><span>"),Wl=J("<li class=ztr-comment-action-remove>"),Kl=J("<li class=ztr-comment-action-report>"),Zl=J("<ul class=ztr-comment-replies-info-items><li><span></span></li><li> repl"),Gl=J('<svg width=40 height=46 viewBox="0 0 525 600"fill=none xmlns=http://www.w3.org/2000/svg><path d="M442.711 254.675C454.209 334.323 371.764 351.177 324.332 349.703C321.286 349.608 318.416 351.091 316.617 353.55C311.71 360.258 303.867 368.932 297.812 368.932C291.012 368.932 284.892 382.009 282.101 390.146C281.808 391 282.648 391.788 283.507 391.509C358.626 367.118 388.103 358.752 400.801 361.103C411.052 363.001 430.226 397.321 438.532 414.244C417.886 415.43 411.005 396.926 406.259 393.604C402.462 390.947 401.038 403.094 400.801 409.499C396.292 407.127 390.597 403.806 390.122 393.604C389.648 383.403 384.427 386.013 380.393 386.487C376.359 386.962 314.423 406.89 305.169 409.499C295.914 412.109 285.235 415.667 276.455 421.836C261.743 428.953 252.251 423.971 249.64 411.872C247.552 402.192 261.11 372.411 268.15 358.731C259.449 361.973 241.382 368.552 238.724 368.932C236.147 369.3 203.454 394.539 185.97 408.253C184.95 409.053 184.294 410.225 184.059 411.499C181.262 426.698 172.334 430.952 156.856 438.917C144.4 445.326 100.9 512.174 78.5318 548.261C76.9851 550.756 74.7151 552.673 72.2776 554.31C58.0697 563.847 43.5996 588.121 37.7308 600C29.3778 575.897 40.262 555.162 46.7482 547.808C43.9006 545.341 37.3353 546.78 34.4086 547.808C42.4768 520.051 70.7156 520.051 69.7664 520.051C74.987 515.544 136.211 428.004 137.634 423.971C139.047 419.97 136.723 401.262 167.494 391.005C167.982 390.842 168.467 390.619 168.9 390.34C192.873 374.933 210.857 350.094 216.893 339.514C184.887 337.314 148.236 319.47 129.072 308.008C124.941 305.538 120.56 303.387 115.777 302.846C89.5384 299.876 63.2668 316.661 52.6808 326.229C48.3144 320.156 53.2345 302.506 56.2403 294.44C45.6092 292.921 29.979 308.357 23.4928 316.265C16.4687 305.258 22.6227 285.583 26.5777 277.121C12.5295 277.501 3.00581 283.922 0 287.085C11.6277 200.494 100.569 225.677 101.565 226.827C96.8187 221.893 97.2142 215.44 98.0052 212.83C151.872 214.254 177.026 205.239 192.925 195.986C318.22 126.002 372.206 168.942 392.139 179.736C412.073 190.53 448.261 194.919 473.296 184.955C503.196 171.432 498.695 136.577 492.636 123.274C485.992 108.683 448.498 88.5179 435.209 63.0154C421.921 37.5129 433.5 6.50012 448.895 2.17754C463.562 -1.94096 474.037 2.85041 482.076 10.1115C487.436 14.9524 502.484 18.4148 508.773 20.6685C515.061 22.9223 525.502 25.8877 524.909 27.667C524.316 29.4463 514.249 29.2088 512.688 29.2088C509.485 29.2088 505.688 29.6833 509.485 31.4626C513.937 33.2682 520.657 35.8924 523.875 37.6198C524.294 37.8443 524.207 38.4293 523.749 38.5526C501.912 44.4295 482.414 32.3029 467.957 46.2898C453.244 60.524 484.568 71.4369 500.704 88.5179C516.841 105.599 533.452 126.001 520.163 172.5C509.875 208.497 466.758 239.103 444.486 251.075C443.205 251.764 442.503 253.235 442.711 254.675Z">'),Jl=J('<svg viewBox="0 -6 60 60"xmlns=http://www.w3.org/2000/svg><path d="M 12.6030 50.4905 C 13.3758 50.4905 13.9307 50.1140 14.8621 49.2421 L 20.6483 43.8720 C 19.5188 42.9803 18.6073 41.5733 18.6073 38.3433 L 18.6073 25.2052 C 18.6073 19.1217 22.3129 15.5152 28.3766 15.5152 L 42.2479 15.5152 L 42.2281 14.7622 C 41.9306 10.6999 39.2557 8.0643 34.7177 8.0643 L 7.5301 8.0643 C 2.9922 8.0643 0 10.7791 0 15.4954 L 0 34.9548 C 0 39.6710 2.9922 42.7028 7.5301 42.7028 L 10.8195 42.7028 L 10.8195 48.4693 C 10.8195 49.6979 11.4735 50.4905 12.6030 50.4905 Z M 44.6058 53.2450 C 45.7353 53.2450 46.3895 52.4325 46.3895 51.2237 L 46.3895 45.4374 L 48.4702 45.4374 C 53.0078 45.4374 56 42.4056 56 37.7092 L 56 25.6610 C 56 20.9250 53.0078 18.2300 48.4702 18.2300 L 28.8522 18.2300 C 24.1161 18.2300 21.3221 20.9250 21.3221 25.6610 L 21.3221 37.7092 C 21.3221 42.4056 24.1161 45.4374 28.8522 45.4374 L 35.1735 45.4374 L 42.3470 51.9767 C 43.2784 52.8487 43.8331 53.2450 44.6058 53.2450 Z">'),Yl=J('<svg xmlns=http://www.w3.org/2000/svg viewBox="-120 -80 528 588"><path d="M349.4 44.6c5.9-13.7 1.5-29.7-10.6-38.5s-28.6-8-39.9 1.8l-256 224c-10 8.8-13.6 22.9-8.9 35.3S50.7 288 64 288H175.5L98.6 467.4c-5.9 13.7-1.5 29.7 10.6 38.5s28.6 8 39.9-1.8l256-224c10-8.8 13.6-22.9 8.9-35.3s-16.6-20.7-30-20.7H272.5L349.4 44.6z">'),Ql=J('<svg viewBox="0 -16 180 180"xmlns=http://www.w3.org/2000/svg><path d="M60.732 29.7C41.107 29.7 22 39.7 22 67.41c0 27.29 45.274 67.29 74 94.89 28.744-27.6 74-67.6 74-94.89 0-27.71-19.092-37.71-38.695-37.71C116 29.7 104.325 41.575 96 54.066 87.638 41.516 76 29.7 60.732 29.7z">'),Xl=J('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 448 512"style=width:90%><path d="M170.5 51.6L151.5 80l145 0-19-28.4c-1.5-2.2-4-3.6-6.7-3.6l-93.7 0c-2.7 0-5.2 1.3-6.7 3.6zm147-26.6L354.2 80 368 80l48 0 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-8 0 0 304c0 44.2-35.8 80-80 80l-224 0c-44.2 0-80-35.8-80-80l0-304-8 0c-13.3 0-24-10.7-24-24S10.7 80 24 80l8 0 48 0 13.8 0 36.7-55.1C140.9 9.4 158.4 0 177.1 0l93.7 0c18.7 0 36.2 9.4 46.6 24.9zM80 128l0 304c0 17.7 14.3 32 32 32l224 0c17.7 0 32-14.3 32-32l0-304L80 128zm80 64l0 208c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-208c0-8.8 7.2-16 16-16s16 7.2 16 16zm80 0l0 208c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-208c0-8.8 7.2-16 16-16s16 7.2 16 16zm80 0l0 208c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-208c0-8.8 7.2-16 16-16s16 7.2 16 16z">'),eu=J('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 448 512"style=width:85%><path d="M48 24C48 10.7 37.3 0 24 0S0 10.7 0 24L0 64 0 350.5 0 400l0 88c0 13.3 10.7 24 24 24s24-10.7 24-24l0-100 80.3-20.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30l0-279.7c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L48 52l0-28zm0 77.5l96.6-24.2c27-6.7 55.5-3.6 80.4 8.8c54.9 27.4 118.7 29.7 175 6.8l0 241.8-24.4 9.1c-33.7 12.6-71.2 10.7-103.4-5.4c-48.2-24.1-103.3-30.1-155.6-17.1L48 338.5l0-237z">'),tu=J('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 448 512"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z">'),nu=J('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 448 512"><path d="M201.4 137.4c12.5-12.5 32.8-12.5 45.3 0l160 160c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L224 205.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l160-160z">'),ru=J('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 512 512"><path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z">');const ou=e=>{const t=()=>e.articles(),n=go.profiles,r=()=>go.userObservedComments,o=e=>{const t=go.commentContexts.get(e.id);if(t)return t;{const[t,n]=w(),r={thread:{collapsed:t,setCollapsed:n,trigger:()=>n(!t())},text:{value:fo(""),overflowed:fo(void 0),collapsed:fo(!0)},votes:{upvotesCount:fo(0),downvotesCount:fo(0)},reply:{text:fo(""),isOpen:fo(!1)}};return go.commentContexts.set(e.id,r),r}},i=t=>{const n=[],r=[],i=!!e.firstLevelComments;for(const e of t){let t=0,a=!1;try{const n=o(e),{upvotesCount:r,downvotesCount:s}=n.votes,l=ga({e:e,rankable:i,minReadPow:go.minReadPow,upvotes:r(),downvotes:s()});n.text.value(nl(e,go)),a=!0,i&&(t=go.ranks.get(e.id)||l.rank||0,go.ranks.set(e.id,t)),!0===l.showReportButton&&go.showReportButton.add(e.id)}catch(s){wa("eventsBlocked",e.id,cl(s)),r.push(e.id)}a&&n.push({rank:t,e:e})}return n},s=()=>[...i(Ws(e.topNestedEvents(),!e.firstLevelComments)).sort(((t,n)=>e.firstLevelComments?n.rank-t.rank:0)).map((({e:e})=>e)),...i(e.bottomNestedEvents?e.bottomNestedEvents():[]).map((({e:e})=>e))];return ee(a=$l(),W(K,{get each(){return s()},children:i=>{const s=!i().parent,a=E((()=>al(i()))),l=()=>(e.firstLevelComments?e.firstLevelComments():0)>=3||a()>=5,u=()=>{var e;return i().pk===(null==(e=mo.active)?void 0:e.pk)},c=()=>o(i()),h=()=>c().votes;A(S([t],(()=>{if(go.commentContexts.has(i().id)){const n={...c()};if(go.onEvent){const r=al(i()),o=nl(i(),go,t()),s=!!e.firstLevelComments,{sanitizedContent:a}=go.onEvent({rankable:s,kind:i().k,content:o,replies:r,upvotes:n.votes.upvotesCount(),downvotes:n.votes.downvotesCount(),client:i().client,language:i().language,pow:i().pow,followedByModerator:go.lists.pubkeysFollowed.has(i().pk)});n.text.value(a||o)}go.commentContexts.set(i().id,n)}})));const[f,d]=w(),p=()=>{const e=c().text.overflowed();if(void 0!==e)return e;const t=getComputedStyle(f()),n=parseFloat(t.fontSize),r=parseFloat(t.maxHeight)||7.5*n;return(parseFloat(t.height)||0)>r&&(c().text.overflowed(!0),!0)};A(S([r,l],(()=>{const e=c().thread,t=e.collapsed();void 0!==t?e.setCollapsed(t):s&&r()&&e.setCollapsed(l())})));const g=()=>i().pk,m=()=>Se(g()),y=()=>n().find((e=>e.pk===g())),b=()=>sl(g()),v=fo(b());let k;A((async()=>{var e;v((null==(e=y())?void 0:e.i)||b())}));const C=()=>(e=>{const t=new Date,n=Math.floor((t.getTime()-e)/1e3);if(n<60)return"now";if(n<3600){const e=Math.floor(n/60);return`${e} minute${1===e?"":"s"} ago`}if(n<=86400){const e=Math.floor(n/3600);return`${e} hour${1===e?"":"s"} ago`}if(n<=604800){const e=Math.floor(n/86400);return`${e} day${1===e?"":"s"} ago`}if(n>604800){const n=new Date(e);return"on "+n.toLocaleDateString("en-us",{day:"numeric",month:"long"})+(n.getFullYear()===t.getFullYear()?"":" "+n.getFullYear())}return""})(1e3*i().ts),[_,B]=w();A((()=>{B(C()),k=setInterval((()=>{B(C())}),6e4)}));const z=()=>i().a===go.anchor.value&&i().am,D=()=>i().k===Me?"highlight":z()?"mention":"comment";F((()=>{clearInterval(k)}));const I=()=>i().id,M=()=>i().ro||go.version||go.rootEventIds[0];return U=Nl(),H=U.firstChild,V=H.firstChild,K=V.firstChild.firstChild,G=K.firstChild,J=K.nextSibling.firstChild.firstChild,Y=J.nextSibling.firstChild,te=Y.firstChild,ne=te.firstChild,re=V.nextSibling,oe=re.nextSibling,ie=H.nextSibling,se=ie.firstChild,G.addEventListener("error",(()=>v(b()))),ee(J,(()=>{var e;return(null==(e=y())?void 0:e.n)||ol(m())})),ee(te,D,ne),ee(te,_,null),ee(H,(O=E((()=>!(i().parent||!i().ro||go.rootEventIds.includes(i().ro)))),()=>{return O()&&(e=ql(),t=e.firstChild,n=t.firstChild,r=n.firstChild.nextSibling,o=r.nextSibling.nextSibling,ee(t,du,n),ee(n,D,r),x((()=>Q(o,"href",go.urlPrefixes.note+Fe(i().ro)))),e);var e,t,n,r,o}),re),ee(H,(T=E((()=>!(i().parent||i().ro))),()=>{return T()&&(e=Ul(),t=e.firstChild,n=t.firstChild,(r=n.firstChild.nextSibling).nextSibling,ee(t,du,n),ee(n,D,r),e);var e,t,n,r}),re),ee(H,(P=E((()=>!(i().parent||!i().ro||!go.rootEventIds.includes(i().ro)||!go.version||go.version===i().ro))),()=>{return P()&&(e=Hl(),t=e.firstChild,n=t.firstChild,(r=n.firstChild.nextSibling).nextSibling,ee(t,du,n),ee(n,D,r),e);var e,t,n,r}),re),X(d,re),ee(H,(R=E((()=>!!p())),()=>{return R()&&(e=Vl(),t=e.firstChild,e.$$click=()=>po(c().text.collapsed),ee(t,(()=>c().text.collapsed()?"Read more":"Show less")),e);var e,t}),oe),ee(oe,W(kl,{eventId:I,rootEventId:M,voteCounts:h,get votes(){return e.votes}}),null),ee(oe,(L=E((()=>!!u())),()=>{return L()&&((e=Wl()).$$click=()=>(async()=>{const e=await hl();if(!e)return;const t=e;if(t&&(!go.onRemove||(await go.onRemove({content:c().text.value()})).accepted)){const e=i().id;await da({kind:5,created_at:Vs(),content:"",pubkey:t.pk,tags:[["e",e],["k","1"]]},t)&&Za("events",[e])}})(),ee(e,uu),e);var e}),null),ee(oe,($=E((()=>!(!mo.active||!(mo.active&&go.moderators.has(mo.active.pk)||go.showReportButton.has(i().id))||u()||go.moderators.has(i().pk)))),()=>{return $()&&((e=Kl()).$$click=()=>(async()=>{const e=await hl();if(!e)return;const t=e;if(!t)return;const n=go.onReport?await go.onReport({}):{accepted:!0,list:"event",type:"other",reason:""};if(!n.accepted)return;const r=i().id,o="event"===n.list?["e",r]:["p",i().pk],s=await da({kind:De,created_at:Vs(),content:n.reason||"",pubkey:t.pk,tags:[[...o,n.type||"other"]]},t),a=await ta.queryProfileEvent({kinds:[Oe],authors:[t.pk]}),l=a?a.tags.filter((e=>e.length>=2&&["e","p"].includes(e[0]))):[],u=void 0!==l.find((e=>JSON.stringify(e)===JSON.stringify(o)))||await da({kind:Oe,created_at:Vs(),content:n.reason||"",pubkey:t.pk,tags:[...l,o]},t);(s||u)&&Za("events",[r])})(),ee(e,cu),e);var e}),null),ee(oe,W(Z,{get when(){return!go.disableFeatures.includes("reply")},get children(){var e=jl(),t=e.firstChild;return e.$$click=()=>{go.userStartedReadingComments=!0,po(c().reply.isOpen)},ee(e,su,t),ee(t,(()=>c().reply.isOpen()?"Cancel":"Reply")),e}}),null),ee(H,(j=E((()=>!!c().reply.isOpen())),()=>j()&&W(Rl,{get comment(){return c().reply.text},get replyTo(){return i().id},onDone:()=>{const e=c();e.thread.setCollapsed(!1),e.reply.isOpen(!1)}})),null),ee(se,(N=E((()=>a()>0)),()=>{return N()&&(t=Zl(),n=t.firstChild,r=n.firstChild,o=n.nextSibling,i=o.firstChild,t.$$click=()=>{go.userStartedReadingComments=!0,c().thread.trigger()},ee(r,(e=E((()=>!0===c().thread.collapsed())),()=>e()?hu():fu())),ee(o,a,i),ee(o,(()=>a()>1?"ies":"y"),null),x((()=>t.classList.toggle("selected",!(!0!==c().thread.collapsed())))),t);var e,t,n,r,o,i})),ee(ie,(q=E((()=>!c().thread.collapsed())),()=>q()&&W(ou,{topNestedEvents:()=>i().children,get articles(){return e.articles},get votes(){return e.votes}})),null),x((e=>{var t=v(),n=go.urlPrefixes.npub+m(),r=go.urlPrefixes.note+Fe(i().id),o=!(!p()||!c().text.collapsed()),s=!(i().k!=Me),a=c().text.value();return t!==e.e&&Q(G,"src",e.e=t),n!==e.t&&Q(J,"href",e.t=n),r!==e.a&&Q(Y,"href",e.a=r),o!==e.o&&re.classList.toggle("ztr-comment-text-fade",e.o=o),s!==e.i&&re.classList.toggle("highlight",e.i=s),a!==e.n&&(re.innerHTML=e.n=a),e}),{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),U;var O,T,P,R,L,$,j,N,q,U,H,V,K,G,J,Y,te,ne,re,oe,ie,se}})),a;var a},iu=()=>Gl(),su=()=>{return Q(e=Jl(),"width",il),Q(e,"height",il),e;var e},au=()=>{return Q(e=Yl(),"width",il),Q(e,"height",il),e;var e},lu=()=>{return Q(e=Ql(),"width",il),Q(e,"height",il),e;var e},uu=()=>Xl(),cu=()=>eu(),hu=()=>tu(),fu=()=>nu(),du=()=>{return Q(e=ru(),"height",il),e;var e};Y(["click"]);const{bech32:pu,hex:gu,utf8:mu}=Ae,yu={bech32:"bc",pubKeyHash:0,scriptHash:5,validWitnessVersions:[0]},bu={bech32:"tb",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},vu={bech32:"tbs",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},wu={bech32:"bcrt",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},ku={bech32:"sb",pubKeyHash:63,scriptHash:123,validWitnessVersions:[0]},xu=["option_data_loss_protect","initial_routing_sync","option_upfront_shutdown_script","gossip_queries","var_onion_optin","gossip_queries_ex","option_static_remotekey","payment_secret","basic_mpp","option_support_large_channel"],Au={m:BigInt(1e3),u:BigInt(1e6),n:BigInt(1e9),p:BigInt(1e12)},Eu=BigInt("2100000000000000000"),Cu=BigInt(1e11),_u={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27},Bu={};for(let $u=0,ju=Object.keys(_u);$u<ju.length;$u++){const e=ju[$u],t=_u[ju[$u]].toString();Bu[t]=e}const Su={1:e=>gu.encode(pu.fromWordsUnsafe(e)),16:e=>gu.encode(pu.fromWordsUnsafe(e)),13:e=>mu.encode(pu.fromWordsUnsafe(e)),19:e=>gu.encode(pu.fromWordsUnsafe(e)),23:e=>gu.encode(pu.fromWordsUnsafe(e)),27:e=>gu.encode(pu.fromWordsUnsafe(e)),6:zu,24:zu,3:function(e){const t=[];let n,r,o,i,s,a=pu.fromWordsUnsafe(e);for(;a.length>0;)n=gu.encode(a.slice(0,33)),r=gu.encode(a.slice(33,41)),o=parseInt(gu.encode(a.slice(41,45)),16),i=parseInt(gu.encode(a.slice(45,49)),16),s=parseInt(gu.encode(a.slice(49,51)),16),a=a.slice(51),t.push({pubkey:n,short_channel_id:r,fee_base_msat:o,fee_proportional_millionths:i,cltv_expiry_delta:s});return t},5:function(e){const t=e.slice().reverse().map((e=>[!!(1&e),!!(2&e),!!(4&e),!!(8&e),!!(16&e)])).reduce(((e,t)=>e.concat(t)),[]);for(;t.length<2*xu.length;)t.push(!1);const n={};xu.forEach(((e,r)=>{let o;o=t[2*r]?"required":t[2*r+1]?"supported":"unsupported",n[e]=o}));const r=t.slice(2*xu.length);return n.extra_bits={start_bit:2*xu.length,bits:r,has_required:r.reduce(((e,t,n)=>n%2!=0?e||!1:e||t),!1)},n}};function Fu(e){return t=>({tagCode:parseInt(e),words:pu.encode("unknown",t,Number.MAX_SAFE_INTEGER)})}function zu(e){return e.reverse().reduce(((e,t,n)=>e+t*Math.pow(32,n)),0)}function Du(e,t){let n,r;if(e.slice(-1).match(/^[munp]$/))n=e.slice(-1),r=e.slice(0,-1);else{if(e.slice(-1).match(/^[^munp0-9]$/))throw new Error("Not a valid multiplier for the amount");r=e}if(!r.match(/^\d+$/))throw new Error("Not a valid human readable amount");const o=BigInt(r),i=n?o*Cu/Au[n]:o*Cu;if("p"===n&&o%BigInt(10)!==BigInt(0)||i>Eu)throw new Error("Amount is outside of valid range");return t?i.toString():i}var Iu={decode:function(e,t){if("string"!=typeof e)throw new Error("Lightning Payment Request must be string");if("ln"!==e.slice(0,2).toLowerCase())throw new Error("Not a proper lightning payment request");const n=[],r=pu.decode(e,Number.MAX_SAFE_INTEGER);e=e.toLowerCase();const o=r.prefix;let i=r.words,s=e.slice(o.length+1),a=i.slice(-104);i=i.slice(0,-104);let l=o.match(/^ln(\S+?)(\d*)([a-zA-Z]?)$/);if(l&&!l[2]&&(l=o.match(/^ln(\S+)$/)),!l)throw new Error("Not a proper lightning payment request");n.push({name:"lightning_network",letters:"ln"});const u=l[1];let c;if(t){if(void 0===t.bech32||void 0===t.pubKeyHash||void 0===t.scriptHash||!Array.isArray(t.validWitnessVersions))throw new Error("Invalid network");c=t}else switch(u){case yu.bech32:c=yu;break;case bu.bech32:c=bu;break;case vu.bech32:c=vu;break;case wu.bech32:c=wu;break;case ku.bech32:c=ku}if(!c||c.bech32!==u)throw new Error("Unknown coin bech32 prefix");n.push({name:"coin_network",letters:u,value:c});const h=l[2];let f;if(h){f=Du(h+l[3],!0),n.push({name:"amount",letters:l[2]+l[3],value:f})}else f=null;n.push({name:"separator",letters:"1"});const d=zu(i.slice(0,7));let p,g,m,y;for(i=i.slice(7),n.push({name:"timestamp",letters:s.slice(0,7),value:d}),s=s.slice(7);i.length>0;){const e=i[0].toString();p=Bu[e]||"unknown_tag",g=Su[e]||Fu(e),i=i.slice(1),m=zu(i.slice(0,2)),i=i.slice(2),y=i.slice(0,m),i=i.slice(m),n.push({name:p,tag:s[0],letters:s.slice(0,3+m),value:g(y)}),s=s.slice(3+m)}n.push({name:"signature",letters:s.slice(0,104),value:gu.encode(pu.fromWordsUnsafe(a))}),s=s.slice(104),n.push({name:"checksum",letters:s});let b={paymentRequest:e,sections:n,get expiry(){let e=n.find((e=>"expiry"===e.name));if(e)return v("timestamp")+e.value},get route_hints(){return n.filter((e=>"route_hint"===e.name)).map((e=>e.value))}};for(let w in _u)"route_hint"!==w&&Object.defineProperty(b,w,{get:()=>v(w)});return b;function v(e){let t=n.find((t=>t.name===e));return t?t.value:void 0}},hrpToMillisat:Du},Mu=J("<div id=ztr-root><style>"),Ou=J("<div id=ztr-content>"),Tu=J("<h1>Error!"),Pu=J("<div class=ztr-comment-text><pre></pre><p>Only properly formed NIP-19 naddr, note and nevent encoded entities and URLs are supported."),Ru=J("<h2 id=ztr-title>");const Lu=e=>{const t=()=>go.ready(),n=()=>+e.minReadPow;var r;k((()=>{go.anchor=(()=>{const t=e.anchor.trim();try{if(t.startsWith("http")){const n=!e.legacyUrl;return{type:"http",value:ul(t,n)}}const n=_e(t);switch(n.type){case"nevent":return{type:"note",value:n.data.id};case"note":return{type:"note",value:n.data};case"naddr":const e=n.data;return{type:"naddr",value:`${e.kind}:${e.pubkey}:${e.identifier}`}}}catch(n){return console.error(n),{type:"error",value:`Malformed anchor: ${t}`}}})(),(e.author||"").startsWith("npub")&&(go.externalAuthor=_e(e.author).data),go.disableFeatures=e.disable.split(",").map((e=>e.trim())).filter(bo),go.urlPrefixes=((e="")=>{const t={naddr:"https://nostr.at/",npub:"https://nostr.at/",nprofile:"https://nostr.at/",nevent:"https://nostr.at/",note:"https://nostr.at/",tag:"https://snort.social/t/",picture:""};for(const n of e.split(",")){const[e,r]=n.split(":");t[e]=r?`https://${r}`:""}return t})(e.urls),go.replyPlaceholder=e.replyPlaceholder,go.maxCommentLength=+e.maxCommentLength||1/0,go.minReadPow=n(),go.maxWritePow=+e.maxWritePow,go.writePowDifficulty=Math.max(go.writePowDifficulty,n()),go.community=e.community,(e=>{const t=e.trim();t&&(wo(t)?go.language=t:console.error(`[zapthreads] Unknown ISO-639-1 language ${t}, ignoring`))})(e.language);const t=e.client.trim();t&&(go.client=t)})),r=async()=>{mo.active||(await(async()=>{Zs(0);const e=await Ha("sessions",1,{index:"autoLogin"});if(!e)return;const t=await Zs(1e3);if(!t)return void console.log("[zapthreads] nip-07 is probably removed");const n=await t.getPublicKey();if(n!==e.pk)return console.log("[zapthreads] unknown user, disabling auto-login"),void Ka("sessions",{...e,autoLogin:0});go.onLogin&&!(await go.onLogin({knownUser:!0}))||(mo.active={pk:n,signEvent:async e=>await t.signEvent(e)},go.subscribed(e.subscriber))})(),await ta.updateRelays(e.relays))},A((()=>B(r)));const o=()=>go.anchor,i=()=>go.readRelays,s=()=>e.version;go.profiles=Na((()=>["profiles"]));const a=()=>go.disableFeatures.includes("watch");k(S([o],(()=>{go.version=s()}))),k(S([o,i,t],(async()=>{if(!t()||go.rootEventIds.length>0||"error"===o().type)return;let n,r;switch(o().type){case"http":r=await Ua("events",o().value,{index:"r"}),go.rootEventIds=Ws(r).map((e=>e.id));n={"#r":e.legacyUrl?[o().value]:[o().value,`${o().value}/`],kinds:[1,8812]};break;case"note":const t=await Ha("events",IDBKeyRange.only(o().value));return go.rootEventIds=[o().value],void(t&&(go.anchorAuthor=t.pk));case"naddr":const[i,s,a]=o().value.split(":");r=(await Ua("events",a,{index:"d"})).filter((e=>e.pk===s)),r.length>0&&(go.rootEventIds=Ws(r).map((e=>e.id)),go.anchorAuthor=r[0].pk),n={authors:[s],kinds:[parseInt(i)],"#d":[a]};break;default:throw"error"}const s=i();if(0===s.length)return;const a=(await ta.querySync(s,{...n})).map(Ta);for(const e of a)"http"==o().type?(1==e.k&&e.c.includes("↴")||8812==e.k)&&Ka("events",e):Ka("events",e);switch(o().type){case"http":case"naddr":const e=[...r,...a],t=Ws([...e]).map((e=>e.id));(t.length>0&&t[0])!==go.rootEventIds[0]&&(go.rootEventIds=t);break;case"note":go.rootEventIds=a.map((e=>e.id))}a.length>0&&(go.anchorAuthor=a[0].pk)})));const l=()=>go.rootEventIds;k(S([l,s],(()=>{switch(o().type){case"http":case"note":return void((go.filter["#e"]??[]).toString()!==l().toString()&&(go.filter={"#e":l()}));case"naddr":const e=go.filter["#a"]&&go.filter["#a"][0];return o().value!==e&&(go.filter={"#a":[o().value]}),void(go.version=s()||l()[0])}}),{defer:!0}));const u=E((()=>go.filter),{defer:!0});let c;A(S([u,i],(async()=>{const e=u(),t=i(),n=o();p(),C();const r=go.profiles();if(0===Object.entries(e).length||0===t.length)return;const s=await(async()=>Math.max(await _a(),await Aa(),await Ea()))();null==c||c.close(),c=null,F((()=>{console.log("[zapthreads] unsubscribing and cleaning up",n.value),null==c||c.close(),c=null})),console.log(`[zapthreads] subscribing to ${n.value} on`,[...t]);const l=!go.anchorAuthor&&"note"===o().type,h=l?[{ids:[o().value],kinds:Ys,limit:1}]:[],f=go.disableFeatures.includes("votes")&&go.disableFeatures.includes("likes"),d=go.disableFeatures.includes("zaps"),g=Qs.filter((e=>{let t=!0;return f&&t&&(t=7!==e),d&&t&&(t=e!==Ie),t})),m=new Set,y={};let b=new Set;go.requestedProfileUpdate.clear(),c=await ta.subscribeManyMap(Object.fromEntries(t.map((t=>[t,[...h,{...e,kinds:g}]]))),{onevent(e){(async()=>{if(Ys.includes(e.kind)){const t=Ta(e);l&&!go.anchorAuthor&&e.id===o().value&&(console.log(`[zapthreads] anchor author is ${e.pubkey}`),go.anchorAuthor=e.pubkey),Ka("events",t),b.add(e.pubkey)}else if(7===e.kind){m.add(e.id);const t=((e,t)=>{ao(e);const n=e.tags.filter((e=>e.length>1&&"e"===e[0])),r=n.filter((e=>e.length>2)),o=r.filter((e=>"reply"===e[3])).concat(r.filter((e=>"root"===e[3]))).map((e=>e[1])).concat(n.length>0&&n[0].length>1&&[n[0][1]]||[])[0],i=e.tags.find((e=>e.length>2&&"nonce"===e[0])),s=i&&+i[2]||0;return{id:e.id??"",noteId:o,pk:e.pubkey,content:e.content,ts:e.created_at,pow:s,a:t}})(e,n.value);0!==Da(t)&&Ka("reactions",t)}else if(e.kind===Ie){const t=e.tags.find((e=>"bolt11"===e[0]));t&&t[1]&&(y[e.id]=t[1])}})()},oneoseOnRelay(e){Xa(b,t,r),b.clear()},oneose(){(async()=>{const e=await Ha("aggregates",IDBKeyRange.only([n.value,7]))??{eid:n.value,ids:[],k:7};e.ids=[...new Set([...e.ids,...m])],Ka("aggregates",e);const t=await Ha("aggregates",IDBKeyRange.only([n.value,Ie]))??{eid:n.value,ids:[],k:Ie,sum:0};t.sum=Object.entries(y).reduce(((e,n)=>{if(t.ids.includes(n[0]))return e;const r=Iu.decode(n[1]).sections.find((e=>"amount"===e.name));return e+Number(r.value)/1e3}),t.sum??0),t.ids=[...new Set([...t.ids,...Object.keys(y)])],Ka("aggregates",t)})(),Ga((async()=>{if(await ta.estimateWriteRelayLatencies(),await ka(s),await ba(),await ta.updateRelayInfos(),a()){null==c||c.close();const e=new Set(go.writeRelays);ta.close(t.filter((t=>!e.has(t))))}console.log("[zapthreads] oneose has finished")}))}})}),{defer:!0}));const h=Na((()=>["events",30023,{index:"k"}])),f=E((()=>{if(go.disableFeatures.includes("hideContent")&&"naddr"===o().type){const[e,t,n]=o().value.split(":"),r=h().find((e=>e.d===n&&e.pk===t));if(r){const e=`# ${r.tl}\n ${r.c}`;return nl({...r,c:e},go)}}})),d=E((()=>{switch(o().type){case"http":case"note":return Na((()=>["events",go.rootEventIds,{index:"ro"}]));case"naddr":return Na((()=>["events",o().value,{index:"a"}]));default:return()=>[]}})),p=()=>d()(),g=E((()=>{if(go.rootEventIds&&go.rootEventIds.length){const e=p();return fl(e).filter((e=>!(e.k===Me&&0===e.children.length)))}return[]})),m=()=>{const e=go.userStartedReadingComments,t=g().filter((t=>{var n;return!e||(null==(n=mo.active)?void 0:n.pk)==t.pk||go.topRootEventIds.has(t.id)}));return t.forEach((e=>go.topRootEventIds.add(e.id))),t},y=()=>g().filter((e=>!go.topRootEventIds.has(e.id))),b=()=>g().reduce(((e,t)=>e+al(t)),g().length),v=()=>g().filter((e=>!e.parent)).length,C=Na((()=>["reactions",o().value,{index:"a"}])),_=E((()=>C().filter((e=>0!==Da(e)))));let z;const D=function(e,t){const n=new WeakMap,r=new IntersectionObserver(((e,t)=>{var r;for(const o of e)null==(r=n.get(o.target))||r(o,t)}),e);function o(e){r.unobserve(e),n.delete(e)}function i(e,t){!function(e,t){t.observe(e)}(e,r),n.set(e,t)}F((()=>r.disconnect()));const s=t?(e,n)=>{const r="function"!=typeof(o=t)||o.length?o:o();var o;return t=>n(r(t,{visible:B(e)}))}:(e,t)=>e=>t(e.isIntersecting);return t=>{const[n,r]=w((null==e?void 0:e.initialValue)??!1),a=s(n,r);let l;return t instanceof Element?i(t,a):A((()=>{const e=t();e!==l&&(l&&o(l),e&&i(e,a),l=e)})),F((()=>l&&o(l))),n}}({threshold:0})((()=>z));return A(S([D,v],(()=>{!go.userStartedReadingComments&&D()&&v()>0&&(go.userObservedComments=!0,setTimeout((()=>{go.userStartedReadingComments=!0}),3e3))}))),F((()=>{clearTimeout(undefined)})),T=Mu(),P=T.firstChild,"function"==typeof z?X(z,T):z=T,ee(P,'#ztr-content,\n#ztr-content img {\n  max-width: 100%;\n}\n\n#ztr-root {\n  display: flex;\n  flex-direction: column;\n  font-family: var(--ztr-font);\n  font-size: var(--ztr-font-size);\n  color: var(--ztr-text-color);\n  border: 1px solid transparent;\n  word-wrap: break-word;\n  /* removes margin collapse */\n  margin-top: 0;\n  line-height: 1.2em;\n}\n\n#ztr-subtitle {\n  font-size: 1.2em;\n  color: #666;\n}\n\na {\n  color: var(--ztr-link-color);\n  text-decoration: none;\n}\n\n/* Comment */\n\n.ztr-comment {\n  position: relative;\n  margin: 0;\n  padding: 0;\n  padding-top: 2.5em;\n}\n\n.ztr-comment-body {\n  /*padding: 1em;*/\n  /*padding-bottom: 2em;*/\n  /*padding-bottom: 0.5em;*/\n}\n\n.ztr-comment:first-child {\n  padding-top: 0;\n  border-top-left-radius: 0.3em;\n  border-top-right-radius: 0.3em;\n}\n\n.ztr-comment:last-child {\n  border-bottom-left-radius: 0.3em;\n  border-bottom-right-radius: 0.3em;\n}\n\n.ztr-comment-info-wrapper {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.ztr-comment-info {\n  display: flex;\n  align-items: center;\n}\n\n.ztr-comment-info-picture {\n  width: 3.5em;\n}\n\nul.ztr-comment-info-items {\n  display: flex;\n  align-items: center;\n  list-style: none;\n  margin: 0;\n  padding: 0;\n  font-size: 0.9em;\n}\n\nul.ztr-comment-info-items li {\n  display: inline-block;\n  cursor: default;\n  padding-right: 0.5em;\n}\n\nul.ztr-comment-info-items li a {\n  font-weight: 600;\n}\n\nul.ztr-comment-info-items li a small {\n  /* color: rgba(0,0,0,0.5); */\n}\n\n.ztr-comment-info-author a {\n  font-size: 1.2em;\n  padding-right: 0.2em;\n}\n\n.ztr-comment-info-author a:hover {\n  text-decoration: underline;\n}\n\n.ztr-comment-info-dots {\n  cursor: pointer;\n}\n\n.ztr-comment-info-separator {\n  width: 0.5em;\n}\n\n.ztr-comment-info-picture img {\n  width: 2em;\n  height: 2em;\n  border-radius: 50%;\n  padding: 0.5em;\n  position: relative;\n  display: block;\n  object-fit: cover;\n}\n\n.ztr-comment-text,\n#ztr-content {\n  margin-bottom: 0.75em;\n  padding: 0 0.8em 0 3.5em;\n  line-height: 1.5em;\n  line-break: loose;\n  word-break: break-word;\n  overflow: hidden;\n  max-width: 37em;\n  min-width: 12em;\n}\n\n.ztr-comment-text-fade {\n  position: relative;\n  max-height: 6em;\n}\n.ztr-comment-text-fade::after {\n  content: "";\n  text-align: right;\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(150deg, rgba(255, 255, 255, 0) 70%, rgba(255, 255, 255, 1));\n  pointer-events: none;\n  cursor: text;\n}\n\n.ztr-comment-text p {\n  margin: 0 0 1.2em 0;\n}\n\n.ztr-comment-text code {\n  font-size: 1.1em;\n  margin: 0 0.2em;\n}\n\n.ztr-comment-text pre,\n.ztr-info-pane pre {\n  white-space: pre-wrap;\n  white-space: -moz-pre-wrap;\n  word-wrap: break-word;\n}\n\n.ztr-comment-text a {\n  color: var(--ztr-action-color, #96609c);\n}\n\n.ztr-comment-text a:hover {\n  color: var(--ztr-action-hover-color);\n  text-decoration: underline;\n}\n\n.ztr-comment-text img {\n  max-width: 100%;\n}\n\n.ztr-comment-text .warning {\n  margin-top: 0em;\n  font-size: 0.8em;\n  display: flex;\n  align-items: center;\n}\n\n.ztr-comment-text .warning svg {\n  height: 1.2em;\n  fill: #e4984d;\n  padding-right: 0.7em;\n}\n\n.ztr-comment-replies {\n  margin-left: 3em;\n}\n\n.ztr-comment-replies-info-actions {\n  /*min-height: 2.5em;\n  align-items: center;*/\n  padding-bottom: 0.5em;\n  margin-left: 0.22em; /* wat */\n}\n\n.ztr-comment-replies-info-items {\n  display: flex;\n  list-style: none;\n  font-size: 0.9em;\n  font-weight: 600;\n  color: #6d6d6d;\n  cursor: pointer;\n  width: 10em;\n  li {\n    padding: 1em;\n    padding-left: 1.3em;\n    margin: -0.6em;\n    margin-left: -1em;\n  }\n}\n\n.ztr-comment-replies-info-items.selected {\n  color: var(--ztr-action-color, #96609c);\n  svg {\n    fill: var(--ztr-action-color, #96609c);\n  }\n}\n\n.ztr-comment-replies-info-items:hover svg {\n  fill: white;\n}\n\n.ztr-comment-replies-info-items:hover li {\n  color: white;\n}\n\nul.ztr-comment-replies-info-items {\n  border-radius: 1.4rem;\n  min-height: 3em;\n  align-items: center;\n  padding: 0;\n  justify-content: center;\n  width: 9em;\n}\n\nul.ztr-comment-replies-info-items:hover {\n  background: var(--ztr-action-color, #96609c);\n  color: white;\n}\n\n.highlight p {\n  background: #F6AD55;\n  color: #2B2B2B;\n  display: inline;\n  padding: 0.2em;\n}\n\n/* Styling the reply to comment form */\n\n.ztr-comment-expand {\n  display: flex;\n  position: relative;\n  max-width: fit-content;\n  padding-top: 0.8em;\n  padding-bottom: 0.5em;\n  padding-left: 1.1em;\n  padding-right: 1em;\n  margin-left: 2.4em;\n  margin-top: -1em;\n  margin-bottom: 0.5em;\n  font-weight: 600;\n  cursor: pointer;\n  color: #2B2B2B;\n}\n\n.ztr-comment-expand:hover span {\n  color: var(--ztr-action-color, #96609c);\n}\n\nul.ztr-comment-actions {\n  display: flex;\n  align-items: center;\n  list-style: none;\n  margin: 0;\n  padding: 0 0 0 2.625em;\n  font-weight: 600;\n  user-select: none;\n}\n\nul.ztr-comment-actions {\n  margin-top: -1em;\n}\n\nul.ztr-comment-actions li {\n  display: inline-flex;\n  align-items: center;\n  text-align: center;\n  padding: 1em;\n  margin: -0.125em;\n  cursor: pointer;\n}\n\nli.ztr-comment-action-upvote {\n  margin-left: 0.5em;\n  margin-right: 0.5em;\n  span {\n    margin-left: 0.075em;\n    font-size: 0.85em;\n  }\n}\n\ndiv.ztr-comment-new li.ztr-comment-action-upvote {\n  margin-left: 1.2em;\n}\n\nli.ztr-comment-action-downvote {\n  margin-left: 0.5em;\n  margin-right: 0.5em;\n  span {\n    margin-left: 0.075em;\n    font-size: 0.85em;\n  }\n}\n\nli.ztr-comment-action-reply {\n  margin-left: 0.7em;\n  margin-right: 0.7em;\n}\n\nli.ztr-comment-action-zap {\n  margin-left: 0.7em;\n  margin-right: 0.7em;\n}\n\nli.ztr-comment-action-like {\n  margin-left: 0.7em;\n  margin-right: 0.7em;\n}\n\n.ztr-comment-action-zap:hover svg {\n  fill: #e4984d;\n}\n\n.ztr-comment-action-zap:hover span {\n  color: #e4984d;\n}\n\n.ztr-comment-action-like:hover svg {\n  fill: #e35428;\n}\n\n.ztr-comment-action-like:hover span {\n  color: #e35428;\n}\n\n.ztr-comment-action-upvote:hover svg {\n  fill: var(--ztr-action-color, #96609c);\n}\n\n.ztr-comment-action-upvote:hover span {\n  color: var(--ztr-action-color, #96609c);\n}\n\n.ztr-comment-action-upvote.selected {\n  svg {\n    fill: var(--ztr-action-color, #96609c);\n  }\n}\n\n.ztr-comment-action-downvote:hover svg {\n  fill: var(--ztr-action-color, #96609c);\n}\n\n.ztr-comment-action-downvote:hover span {\n  color: var(--ztr-action-color, #96609c);\n}\n\n.ztr-comment-action-downvote.selected {\n  svg {\n    fill: var(--ztr-action-color, #96609c);\n  }\n}\n\n.ztr-comment-action-remove:hover svg {\n  fill: var(--ztr-action-color, #96609c);\n}\n\n.ztr-comment-action-report:hover svg {\n  fill: var(--ztr-action-color, #96609c);\n}\n\nli.ztr-comment-action-votes {\n  justify-content: center;\n  span {\n    margin-left: -1.25em;\n    margin-right: -1.25em;\n    font-size: 0.7em;\n  }\n}\n\n.ztr-reply-form {\n  padding: 0 0.5em 0 3.5em;\n}\n\n.ztr-reply-form textarea {\n  font-family: var(--ztr-font);\n  font-size: 1.1em;\n  line-height: 1.4;\n  color: #2B2B2B;\n  background-color: #FDFDFD;\n  border: 1px solid #BBB;\n  outline: none;\n  width: calc(100% - 1.5em);\n  min-width: 12em;\n  padding: 0.7em;\n  margin: 0.5em 0;\n  height: 4em;\n  border-radius: 0.2em;\n  min-height: 4em;\n  resize: vertical;\n}\n\n.ztr-reply-form textarea.too-long {\n  border: 2px solid rgb(202, 23, 23);\n}\n\n.ztr-reply-form:disabled {\n  opacity: 65%;\n  user-select: none;\n}\n\n.ztr-reply-controls {\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n}\n\n.ztr-reply-controls span {\n  font-weight: bold;\n  font-size: 0.85em;\n  margin-right: 1em;\n  user-select: none;\n  cursor: default;\n}\n\n.ztr-reply-error {\n  color: rgb(202, 23, 23);\n}\n\n.ztr-reply-controls button {\n  font-family: var(--ztr-font);\n  appearance: none;\n  padding: 0.5em 1.4em;\n  min-width: 8em;\n  min-height: 3em;\n  border-radius: 1.4rem;\n  font-size: 0.95em;\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.ztr-reply-controls button:hover {\n  color: white;\n  background: var(--ztr-action-color, #96609c);\n}\n\n.ztr-reply-login-button {\n  color: var(--ztr-action-color, #96609c);\n  background-color: white;\n  border: 2px solid var(--ztr-action-color, #96609c);\n}\n\n.ztr-reply-login-button svg {\n  fill: var(--ztr-action-color, #96609c);\n  width: 2em;\n  height: 2em;\n}\n\n.ztr-reply-login-button:hover svg {\n  fill: white;\n}\n\n.ztr-reply-button {\n  color: var(--ztr-text-color);\n  display: flex;\n  align-items: center;\n  border: 2px solid transparent;\n}\n\n.ztr-info-pane {\n  padding: 0 0.5em 1em 3.5em;\n}\n\n.ztr-info-pane pre {\n  font-size: 0.8em;\n}\n\n.ztr-spinner {\n  width: 1.2em;\n  height: 1.2em;\n  padding: 0.9em;\n  animation: rotate 4s linear infinite;\n}\n\n.ztr-reply-button:disabled {\n  opacity: 65%;\n  pointer-events: none;\n  cursor: pointer;\n  user-select: none;\n}\n\n.ztr-spinner .path {\n  stroke: var(--ztr-text-color, #2B2B2B);\n  stroke-linecap: round;\n  animation: dash 1.5s ease-in-out infinite;\n}\n\n.ztr-comment-subscribe-button {\n  font-family: var(--ztr-font);\n  appearance: none;\n  padding: 0.5em 1.4em;\n  width: 9em;\n  min-height: 3em;\n  border-radius: 1.4rem;\n  font-size: 0.5em;\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  margin-top: 1em;\n  margin-bottom: 1em;\n\n  color: var(--ztr-icon-color, #6d6d6d);\n  background-color: white;\n  border: 3px solid var(--ztr-icon-color, #6d6d6d);\n}\n\n.ztr-comment-subscribe-button:hover, .ztr-comment-subscribe-button.selected {\n  color: white;\n  background-color: var(--ztr-action-color, #96609c);\n  border: 3px solid var(--ztr-action-color, #96609c);\n}\n\n.ztr-comment-subscribe-button.selected:hover {\n  color: var(--ztr-action-color, #96609c);\n  background-color: white;\n  border: 3px solid var(--ztr-action-color, #96609c);\n}\n\n@keyframes rotate {\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes dash {\n  0% {\n    stroke-dasharray: 1, 150;\n    stroke-dashoffset: 0;\n  }\n\n  50% {\n    stroke-dasharray: 90, 150;\n    stroke-dashoffset: -35;\n  }\n\n  100% {\n    stroke-dasharray: 90, 150;\n    stroke-dashoffset: -124;\n  }\n}\n\n/* new */\n\n.ztr-comment-new .ztr-reply-form {\n  margin: 0;\n  padding: 0;\n}\n\n.ztr-comment-new .ztr-comment-body {\n  padding: 0;\n}\n\n.ztr-comment-new .ztr-comment-actions {\n  font-size: 2em;\n  padding: 0;\n  justify-content: center;\n  span {\n    font-size: 0.5em;\n  }\n  li.ztr-comment-action-votes {\n    padding-left: 0.6em;\n    padding-right: 0.6em;\n  }\n}\n\n.ztr-spinner .path {\n  stroke: var(--ztr-text-color, #DEDEDE);\n}\n\n.ztr-comment,\n.ztr-reply-button {\n  background-color: var(--ztr-background-color, rgba(255, 255, 255, 0.06));\n}\n\nsvg {\n  width: 1.1em;\n  height: 1.1em;\n  fill: var(--ztr-icon-color, #6d6d6d);\n}\n\nul.ztr-comment-actions li span {\n  padding: 0.25em;\n  color: var(--ztr-icon-color, #6d6d6d);\n}\n\n.ztr-comment-action-reply:hover svg {\n  fill: var(--ztr-action-color, #96609c);\n}\n\n.ztr-comment-action-reply:hover span {\n  color: var(--ztr-action-color, #96609c);\n}\n'),ee(T,(I=E((()=>!!f())),()=>{return I()&&(e=Ou(),x((()=>e.innerHTML=f())),e);var e}),null),ee(T,(M=E((()=>"error"===o().type)),()=>{return M()&&[Tu(),(e=Pu(),ee(e.firstChild,(()=>o().value)),e)];var e}),null),ee(T,(O=E((()=>"error"!==o().type)),()=>{return O()&&[E((()=>E((()=>!go.disableFeatures.includes("reply")))()&&W(Ll,{votes:_}))),(t=Ru(),ee(t,(e=E((()=>b()>0)),()=>e()&&`${b()} comment${1==b()?"":"s"}`)),t),W(ou,{topNestedEvents:m,bottomNestedEvents:y,articles:h,votes:_,firstLevelComments:v})];var e,t}),null),T;var I,M,O,T,P};return function(e,t,n){2===arguments.length&&(n=t,t={}),fe(e,t)(de(n))}("zap-threads",{anchor:"",community:"",version:"",relays:"",author:"",disable:"",urls:"","reply-placeholder":"","legacy-url":"",language:"",client:"","max-comment-length":"","min-read-pow":"","max-write-pow":""},(e=>W(Lu,{get anchor(){return e.anchor??""},get version(){return e.version??""},get relays(){return e.relays??""},get author(){return e.author??""},get community(){return e.community??""},get disable(){return e.disable??""},get urls(){return e.urls??""},get replyPlaceholder(){return e["reply-placeholder"]??""},get legacyUrl(){return e["legacy-url"]??""},get language(){return e.language??""},get client(){return e.client??""},get maxCommentLength(){return e["max-comment-length"]??""},get minReadPow(){return e["min-read-pow"]??""},get maxWritePow(){return e["max-write-pow"]??""}}))),Lu.onLogin=function(e){return go.onLogin=e,Lu},Lu.onEvent=function(e){return go.onEvent=e,Lu},Lu.onPublish=function(e){return go.onPublish=e,Lu},Lu.onRemove=function(e){return go.onRemove=e,Lu},Lu.onReport=function(e){return go.onReport=e,Lu},Lu.setAdditionalTags=function(e){go.additionalTags=e},Lu.start=()=>go.ready(!0),Lu}();
